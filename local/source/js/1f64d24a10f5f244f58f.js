/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ({

/***/ "./source/js/es6/script.js":
/*!*********************************!*\
  !*** ./source/js/es6/script.js ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("if (window.jQuery) {\r\n\t$(function ($) {\r\n\t\ttoggleFade()\r\n\t\ttoggleDropdown()\r\n\t\ttoggleDropdownHover()\r\n\t\ttoggleAccordion()\r\n\t\ttoggleAccordionOnlyAdaptive()\r\n\t\ttoggleAccordionGroup()\r\n\t\tcollapsibleMenu()\r\n\t\tinitCarousel()\r\n\t\ttoggleTabs()\r\n\t\ttoggleTabsNative()\r\n\t\tlazyLoad($(document))\r\n\t\tclippedText()\r\n\t\ttoggleSelect()\r\n\t\ttoggleSelectHover()\r\n\t\ttoggleClassBlock()\r\n\t\tsetQuantity()\r\n\t\tscrollTop()\r\n\t\tshowElemAfterScroll($('.js-scroll-top'), 300)\r\n\t\ttoggleOverlay()\r\n\t\ttoggleClassPage()\r\n\t\tlockScroll()\r\n\t\tfixedBlockWhenScrolling()\r\n\t\tshowBlockIfScrollingUp()\r\n\t\tdelayHoverMenu()\r\n\t\tinitMapsDelayScroll()\r\n\t\tinitTooltip()\r\n\t\tuploadPhotos()\r\n\t\tremoveItem()\r\n\t\tuploadFiles()\r\n\t\tanimateScroll('.js-animate-scroll', 'animated')\r\n\t\tinternationalPhone()\r\n\t\tinitBannerMenu()\r\n\t\tsortableBlocks()\r\n\t\tflexMenu()\r\n\t\tanimateDigits()\r\n\t\ttableWithColumns()\r\n\t\tajaxLoad()\r\n\t\tmaskInputs()\r\n\t\tinitInputWriter()\r\n\t\tprogressBar()\r\n\t\tinitRange()\r\n\t\ttoggleVideo()\r\n\t\ttooltipPosition()\r\n\t\tmenuWithScroll()\r\n\t\tinitPopups()\r\n\t\tinitInputAutocompleteMulti()\r\n\t\tinitInputAutocomplete()\r\n\t\ttoggleRadioClass()\r\n\t\ttoggleSelectBlock()\r\n\t\ttoggleSelectFilter()\r\n\t\ttoggleCheckboxBlock()\r\n\t\tresizebleBlocks()\r\n\t\ttoggleRadioBlock()\r\n\t\tselectWithFilter()\r\n\t\tclickButtonRipple()\r\n\t\ttoggleDisabledBtn()\r\n\t\ttoggleAccordionNative()\r\n\t\ttoggleAccordionGroupNative()\r\n\t\tinputFile()\r\n\t\thamburgerMenu()\r\n\t\tvalidateForm()\r\n\t\tfilterItems()\r\n\r\n\t\tconsole.log(formatFileSize('99999999999999999'))\r\n\r\n\t\t$(document).off('click.closeAll').on('click.closeAll', function () {\r\n\t\t\t// console.log('close all')\r\n\t\t\t// toggleOverlay.closeAllOverlay()\r\n\t\t\t// toggleDropdown.closeAllDropdown()\r\n\t\t\t// toggleDropdownHover.closeAllDropdownHover()\r\n\t\t\t// toggleSelect.closeAllSelect()\r\n\t\t\t// toggleSelectHover.closeAllSelectHover()\r\n\t\t\t// toggleClassBlock.closeAllClassBlocks()\r\n\t\t\t// toggleFade.closeAllFade()\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// сворачивать в выпадашку пункты меню, если не влезают\r\nfunction flexMenu() {\r\n\tif ($.fn.flexMenu) {\r\n\t\t$('.js-flex-menu').each(function () {\r\n\t\t\t$(this).flexMenu({\r\n\t\t\t\tlinkText: 'Еще',\r\n\t\t\t\tlinkTitle: 'Показать еще',\r\n\t\t\t\tlinkTextAll: 'Меню',\r\n\t\t\t\tlinkTitleAll: 'Показать меню',\r\n\t\t\t\tcutoff: 1,\r\n\t\t\t\tshouldApply: function () {\r\n\t\t\t\t\treturn $(window).width() > 1024\r\n\t\t\t\t},\r\n\t\t\t\tshowOnHover: false,\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n}\r\n\r\n// переключение оверлея\r\nfunction toggleOverlay() {\r\n\tvar allOverlay = $('.js-overlay')\r\n\tvar body = $('body')\r\n\r\n\tallOverlay.each(function () {\r\n\t\tvar parent = $(this)\r\n\r\n\t\tparent.find('.js-overlay__toggler').off('click.toggleOverlay').on('click.toggleOverlay', function (event) {\r\n\t\t\tevent.preventDefault()\r\n\t\t\tevent.stopPropagation()\r\n\r\n\t\t\tif (parent.hasClass('active-overlay')) {\r\n\t\t\t\tparent.removeClass('active-overlay')\r\n\t\t\t\tbody.removeClass('active-overlay')\r\n\t\t\t} else {\r\n\t\t\t\tparent.addClass('active-overlay')\r\n\t\t\t\tbody.addClass('active-overlay')\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\r\n\ttoggleOverlay.closeAllOverlay = function () {\r\n\t\tallOverlay.removeClass('active-overlay')\r\n\t\tbody.removeClass('active-overlay')\r\n\t}\r\n}\r\n\r\n// переключение скрытого блока по кнопке\r\nfunction toggleFade() {\r\n\tvar allParents = $('.js-fade')\r\n\tvar allContents = allParents.find('.js-fade__content')\r\n\r\n\tallParents.each(function () {\r\n\t\tvar parent = $(this)\r\n\t\tvar content = parent.find('.js-fade__content')\r\n\r\n\t\t// блокировка всплытия из контента\r\n\t\tcontent.click(function (event) {\r\n\t\t\tevent.stopPropagation()\r\n\t\t})\r\n\r\n\t\t// клик по переключателю состояния\r\n\t\tparent.find('.js-fade__toggler').off('click.toggleFade').on('click.toggleFade', function (event) {\r\n\t\t\tevent.preventDefault()\r\n\t\t\tevent.stopPropagation()\r\n\r\n\t\t\t// закрыть остальные блоки Dropdown\r\n\t\t\tallParents.not(parent).removeClass('open-fade')\r\n\t\t\tallContents.not(content).fadeOut(300)\r\n\r\n\t\t\t// переключение состояния\r\n\t\t\tif (!parent.hasClass('open-fade')) {\r\n\t\t\t\topenDropdown()\r\n\t\t\t} else {\r\n\t\t\t\tcloseDropdown()\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t// открыть\r\n\t\tfunction openDropdown() {\r\n\t\t\tparent.addClass('open-fade')\r\n\t\t\tcontent.fadeIn(300)\r\n\t\t}\r\n\r\n\t\t// закрыть\r\n\t\tfunction closeDropdown() {\r\n\t\t\tparent.removeClass('open-fade')\r\n\t\t\tcontent.fadeOut(300)\r\n\t\t}\r\n\t})\r\n\r\n\t// закрытие всех выпадашек\r\n\ttoggleFade.closeAllFade = function () {\r\n\t\tallParents.removeClass('open-fade')\r\n\t\tallContents.fadeOut(300)\r\n\t}\r\n}\r\n\r\n// переключение скрытого блока по кнопке\r\nfunction toggleDropdown() {\r\n\tvar allParents = $('.js-dropdown')\r\n\tvar allContents = allParents.find('.js-dropdown__content')\r\n\r\n\tallParents.each(function () {\r\n\t\tvar parent = $(this)\r\n\t\tvar content = parent.find('.js-dropdown__content')\r\n\r\n\t\t// инициализации и закрытие при загрузке страницы\r\n\t\tcontent.slideUp(0).click(function (event) {\r\n\t\t\tevent.stopPropagation()\r\n\t\t})\r\n\t\tparent.addClass('init-dropdown')\r\n\r\n\t\t// клик по переключателю состояния\r\n\t\tparent.find('.js-dropdown__toggler').off('click.toggleDropdown').on('click.toggleDropdown', function (event) {\r\n\t\t\tevent.preventDefault()\r\n\t\t\tevent.stopPropagation()\r\n\r\n\t\t\t// закрыть остальные блоки Dropdown\r\n\t\t\tallParents.not(parent).removeClass('open-dropdown')\r\n\t\t\tallContents.not(content).slideUp(300)\r\n\r\n\t\t\t// переключение состояния\r\n\t\t\tif (!parent.hasClass('open-dropdown')) {\r\n\t\t\t\topenDropdown()\r\n\t\t\t} else {\r\n\t\t\t\tcloseDropdown()\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t// открыть\r\n\t\tfunction openDropdown() {\r\n\t\t\tparent.addClass('open-dropdown')\r\n\t\t\tcontent.slideDown(300)\r\n\t\t}\r\n\r\n\t\t// закрыть\r\n\t\tfunction closeDropdown() {\r\n\t\t\tparent.removeClass('open-dropdown')\r\n\t\t\tcontent.slideUp(300)\r\n\t\t}\r\n\t})\r\n\r\n\t// закрытие всех выпадашек\r\n\ttoggleDropdown.closeAllDropdown = function () {\r\n\t\tallParents.removeClass('open-dropdown')\r\n\t\tallContents.slideUp(300)\r\n\t}\r\n}\r\n\r\n// переключение скрытого блока по наведению с задержкой\r\nfunction toggleDropdownHover() {\r\n\tvar allParents = $('.js-dropdown--hover')\r\n\tvar allContents = allParents.find('.js-dropdown__content')\r\n\tvar win = $(window)\r\n\tvar adaptiveDevice = win.width() <= 1024\r\n\r\n\tallParents.each(function (ind) {\r\n\t\tvar parent = $(this)\r\n\t\tvar content = parent.find('.js-dropdown__content')\r\n\t\tvar toggler = parent.find('.js-dropdown__toggler')\r\n\t\tvar timeout = null;\r\n\r\n\t\t// инициализации и закрытие при загрузке страницы\r\n\t\tcontent.slideUp(0).click(function (event) {\r\n\t\t\tevent.stopPropagation()\r\n\t\t})\r\n\t\tparent.addClass('init-dropdown')\r\n\r\n\t\t// переключение метода открытия для адаптива и десктопа\r\n\t\tfunction toggleDropdownHover() {\r\n\t\t\tadaptiveDevice = win.width() <= 1024\r\n\r\n\t\t\tif (adaptiveDevice) {\r\n\t\t\t\t// открытие по клику\r\n\t\t\t\ttoggler.off('click.toggleDropdownHover').on('click.toggleDropdownHover', function (event) {\r\n\t\t\t\t\tevent.preventDefault()\r\n\t\t\t\t\tevent.stopPropagation()\r\n\r\n\t\t\t\t\tif (!parent.hasClass('open-dropdown')) {\r\n\t\t\t\t\t\topenDropdown()\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcloseDropdown()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\t// снятие ненужных обработчиков\r\n\t\t\t\tparent.off('mouseover.toggleDropdownHover')\r\n\t\t\t\tparent.off('mouseleave.toggleDropdownHover')\r\n\t\t\t} else {\r\n\t\t\t\t// обработка события прихода курсора на элемент\r\n\t\t\t\tparent.off('mouseover.toggleDropdownHover').on('mouseover.toggleDropdownHover', function (event) {\r\n\t\t\t\t\tevent.preventDefault()\r\n\t\t\t\t\tevent.stopPropagation()\r\n\r\n\t\t\t\t\t// переключение состояния\r\n\t\t\t\t\tclearTimeout(timeout);\r\n\t\t\t\t\ttimeout = setTimeout(openDropdown, 150);\r\n\t\t\t\t})\r\n\r\n\t\t\t\t// обработка события ухода курсора с элемента\r\n\t\t\t\tparent.off('mouseleave.toggleDropdownHover').on('mouseleave.toggleDropdownHover', function (event) {\r\n\t\t\t\t\tevent.preventDefault()\r\n\t\t\t\t\tevent.stopPropagation()\r\n\r\n\t\t\t\t\t// переключение состояния\r\n\t\t\t\t\tclearTimeout(timeout);\r\n\t\t\t\t\ttimeout = setTimeout(closeDropdown, 500);\r\n\t\t\t\t})\r\n\r\n\t\t\t\t// снятие ненужных обработчиков\r\n\t\t\t\ttoggler.off('click.toggleDropdownHover')\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// открыть\r\n\t\tfunction openDropdown() {\r\n\t\t\tparent.addClass('open-dropdown')\r\n\t\t\tcontent.slideDown(300)\r\n\t\t\twin.trigger('resize.setTooltipPositions');\r\n\t\t}\r\n\r\n\t\t// закрыть\r\n\t\tfunction closeDropdown() {\r\n\t\t\tparent.removeClass('open-dropdown')\r\n\t\t\tcontent.slideUp(300)\r\n\t\t}\r\n\r\n\t\twin.off('resize.toggleDropdownHover' + ind).on('resize.toggleDropdownHover' + ind, function () {\r\n\t\t\tclearTimeout(timeout);\r\n\t\t\ttimeout = setTimeout(toggleDropdownHover, 300);\r\n\t\t})\r\n\r\n\t\twin.trigger('resize.toggleDropdownHover' + ind);\r\n\t})\r\n\r\n\ttoggleDropdownHover.closeAllDropdownHover = function () {\r\n\t\tif (adaptiveDevice) {\r\n\t\t\tallParents.removeClass('open-dropdown')\r\n\t\t\tallContents.slideUp(300)\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// одноуровневые выпадающие селекты\r\nfunction toggleSelect() {\r\n\tvar allParents = $('.js-select')\r\n\tvar allContents = allParents.find('.js-select__content')\r\n\r\n\tallParents.each(function (index) {\r\n\t\tvar parent = $(this)\r\n\t\tvar toggler = parent.find('.js-select__toggler')\r\n\t\tvar content = parent.find('.js-select__content')\r\n\t\tvar listItems = parent.find('.js-select__item')\r\n\t\tvar input = parent.find('.js-select__value')\r\n\r\n\t\t// инициализации и закрытие селекта при загрузке страницы\r\n\t\tcontent.fadeOut(0)\r\n\t\tparent.addClass('init-select')\r\n\r\n\t\t// открытие по клику\r\n\t\ttoggler.off('click.toggleSelect').on('click.toggleSelect', function (event) {\r\n\t\t\tevent.stopPropagation()\r\n\t\t\t// селект заблокирован при наличии класса\r\n\t\t\tif (toggler.hasClass('disabled')) return\r\n\r\n\t\t\tif (!parent.hasClass('open-select')) {\r\n\t\t\t\topenSelect()\r\n\t\t\t} else {\r\n\t\t\t\tcloseSelect()\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t// клик для выбора елемента option\r\n\t\tlistItems.off('click.setSelectOption').on('click.setSelectOption', function (event) {\r\n\t\t\tevent.stopPropagation()\r\n\t\t\tvar item = $(this)\r\n\t\t\tvar itemValue = item.attr('data-value')\r\n\r\n\t\t\tcloseSelect()\r\n\t\t\tif (itemValue === 'reset') {\r\n\t\t\t\tlistItems.removeClass('selected')\r\n\t\t\t\ttoggler.removeClass('selected').html(toggler.data('reset'))\r\n\t\t\t\tparent.attr('data-value', '')\r\n\t\t\t} else {\r\n\t\t\t\tlistItems.removeClass('selected')\r\n\t\t\t\titem.addClass('selected')\r\n\t\t\t\ttoggler.addClass('selected').html(item.html())\r\n\t\t\t\tparent.attr('data-value', itemValue)\r\n\t\t\t}\r\n\r\n\t\t\t// триггер события и установка выбранного значения на скрытом поле\r\n\t\t\tinput.val(item.attr('data-value')).trigger('change')\r\n\t\t})\r\n\r\n\t\t// переключение значения кастомного селекта по состоянию селекта\r\n\t\tinput.off('change.setSelectOption').on('change.setSelectOption', function () {\r\n\t\t\tactivateItem()\r\n\t\t})\r\n\r\n\t\t// переключение значения кастомного селекта\r\n\t\tfunction activateItem() {\r\n\t\t\tvar item = listItems.filter(function () {\r\n\t\t\t\treturn $(this).data('value') == input.val()\r\n\t\t\t})\r\n\t\t\tvar itemValue = item.attr('data-value')\r\n\r\n\t\t\tlistItems.removeClass('selected')\r\n\t\t\titem.addClass('selected')\r\n\t\t\ttoggler.addClass('selected').html(item.html())\r\n\t\t\tparent.attr('data-value', itemValue)\r\n\t\t}\r\n\r\n\t\tactivateItem()\r\n\r\n\t\t// открытие селекта\r\n\t\tfunction openSelect() {\r\n\t\t\tcontent.fadeIn(300)\r\n\t\t\tparent.addClass('open-select')\r\n\t\t}\r\n\r\n\t\t// закрытие селекта\r\n\t\tfunction closeSelect() {\r\n\t\t\tcontent.fadeOut(300)\r\n\t\t\tparent.removeClass('open-select')\r\n\t\t}\r\n\r\n\t\t$(document).off('click.toggleSelect' + index).on('click.toggleSelect' + index, function (e) {\r\n\t\t\tif (!$(e.target).closest('.js-select').length) {\r\n\t\t\t\tcloseSelect()\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\r\n\t// закрыть все селекты\r\n\ttoggleSelect.closeAllSelect = function () {\r\n\t\tallParents.removeClass('open-select')\r\n\t\tallContents.fadeOut(300)\r\n\t}\r\n}\r\n\r\n// одноуровневые выпадающие селекты по наведению курсора\r\nfunction toggleSelectHover() {\r\n\tvar allParents = $('.js-select--hover')\r\n\tvar allContents = allParents.find('.js-select__content')\r\n\tvar win = $(window)\r\n\tvar adaptiveDevice = win.width() <= 1024\r\n\r\n\tallParents.each(function (ind) {\r\n\t\tvar parent = $(this)\r\n\t\tvar toggler = parent.find('.js-select__toggler')\r\n\t\tvar content = parent.find('.js-select__content')\r\n\t\tvar listItems = parent.find('.js-select__item')\r\n\t\tvar input = parent.find('.js-select__value')\r\n\t\tvar timeout = null;\r\n\r\n\t\t// инициализации и закрытие селекта при загрузке страницы\r\n\t\tcontent.fadeOut(0)\r\n\t\tparent.addClass('init-select')\r\n\r\n\t\t// переключение метода открытия для адаптива и десктопа\r\n\t\tfunction toggleSelectHover() {\r\n\t\t\tadaptiveDevice = win.width() <= 1024\r\n\r\n\t\t\tif (adaptiveDevice) {\r\n\t\t\t\t// открытие по клику\r\n\t\t\t\ttoggler.off('click.toggleSelect').on('click.toggleSelect', function (event) {\r\n\t\t\t\t\tevent.stopPropagation()\r\n\t\t\t\t\t// селект заблокирован при наличии класса\r\n\t\t\t\t\tif (toggler.hasClass('disabled')) return\r\n\r\n\t\t\t\t\tif (!parent.hasClass('open-select')) {\r\n\t\t\t\t\t\topenSelect()\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcloseSelect()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\t// снятие ненужных обработчиков\r\n\t\t\t\tparent.off('mouseover.toggleSelect')\r\n\t\t\t\tparent.off('mouseleave.toggleSelect')\r\n\t\t\t} else {\r\n\t\t\t\t// обработка события прихода курсора на элемент\r\n\t\t\t\tparent.off('mouseover.toggleSelect').on('mouseover.toggleSelect', function (event) {\r\n\t\t\t\t\tevent.preventDefault()\r\n\t\t\t\t\tevent.stopPropagation()\r\n\r\n\t\t\t\t\t// селект заблокирован при наличии класса\r\n\t\t\t\t\tif (toggler.hasClass('disabled')) return\r\n\r\n\t\t\t\t\t// переключение состояния\r\n\t\t\t\t\tclearTimeout(timeout);\r\n\t\t\t\t\ttimeout = setTimeout(openSelect, 150);\r\n\t\t\t\t})\r\n\r\n\t\t\t\t// обработка события ухода курсора с элемента\r\n\t\t\t\tparent.off('mouseleave.toggleSelect').on('mouseleave.toggleSelect', function (event) {\r\n\t\t\t\t\tevent.preventDefault()\r\n\t\t\t\t\tevent.stopPropagation()\r\n\r\n\t\t\t\t\t// переключение состояния\r\n\t\t\t\t\tclearTimeout(timeout);\r\n\t\t\t\t\ttimeout = setTimeout(closeSelect, 500);\r\n\t\t\t\t})\r\n\r\n\t\t\t\t// снятие ненужных обработчиков\r\n\t\t\t\ttoggler.off('click.toggleSelect')\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// клик для выбора елемента option\r\n\t\tlistItems.off('click.setSelectOption').on('click.setSelectOption', function (event) {\r\n\t\t\tevent.stopPropagation()\r\n\t\t\tvar item = $(this)\r\n\t\t\tvar itemValue = item.attr('data-value')\r\n\r\n\t\t\tcloseSelect()\r\n\r\n\t\t\tif (itemValue === 'reset') {\r\n\t\t\t\tlistItems.removeClass('selected')\r\n\t\t\t\ttoggler.removeClass('selected').html(toggler.data('reset'))\r\n\t\t\t\tparent.attr('data-value', '')\r\n\t\t\t} else {\r\n\t\t\t\tlistItems.removeClass('selected')\r\n\t\t\t\titem.addClass('selected')\r\n\t\t\t\ttoggler.addClass('selected').html(item.html())\r\n\t\t\t\tparent.attr('data-value', itemValue)\r\n\t\t\t}\r\n\r\n\t\t\t// триггер события и установка выбранного значения на скрытом поле\r\n\t\t\tinput.val(item.attr('data-value')).trigger('change')\r\n\t\t})\r\n\r\n\t\t// переключение значения кастомного селекта по состоянию селекта\r\n\t\tinput.off('change.setSelectOption').on('change.setSelectOption', function () {\r\n\t\t\tactivateItem()\r\n\t\t})\r\n\r\n\t\t// переключение значения кастомного селекта\r\n\t\tfunction activateItem() {\r\n\t\t\tvar item = listItems.filter(function () {\r\n\t\t\t\treturn $(this).data('value') == input.val()\r\n\t\t\t})\r\n\t\t\tvar itemValue = item.attr('data-value')\r\n\r\n\t\t\tlistItems.removeClass('selected')\r\n\t\t\titem.addClass('selected')\r\n\t\t\ttoggler.addClass('selected').html(item.html())\r\n\t\t\tparent.attr('data-value', itemValue)\r\n\t\t}\r\n\r\n\t\tactivateItem()\r\n\r\n\t\t// открытие селекта\r\n\t\tfunction openSelect() {\r\n\t\t\tcontent.fadeIn(300)\r\n\t\t\tparent.addClass('open-select')\r\n\t\t}\r\n\r\n\t\t// закрытие селекта\r\n\t\tfunction closeSelect() {\r\n\t\t\tcontent.fadeOut(300)\r\n\t\t\tparent.removeClass('open-select')\r\n\t\t}\r\n\r\n\t\twin.off('resize.toggleSelectHover' + ind).on('resize.toggleSelectHover' + ind, function () {\r\n\t\t\tclearTimeout(timeout);\r\n\t\t\ttimeout = setTimeout(toggleSelectHover, 300);\r\n\t\t}).trigger('resize.toggleSelectHover' + ind);\r\n\r\n\t\t$(document).off('click.toggleSelectHover' + ind).on('click.toggleSelectHover' + ind, function (e) {\r\n\t\t\tif (!$(e.target).closest('.js-select--hover').length) {\r\n\t\t\t\tcloseSelect()\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\r\n\t// закрыть все селекты\r\n\ttoggleSelectHover.closeAllSelectHover = function () {\r\n\t\tif (adaptiveDevice) {\r\n\t\t\tallContents.fadeOut(300)\r\n\t\t\tallParents.removeClass('open-select')\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// переключение видимости блоков по значению селекта\r\nfunction toggleSelectBlock() {\r\n\t$('.js-select-block').each(function () {\r\n\t\tvar parent = $(this)\r\n\t\tvar select = parent.find('.js-select-block__select')\r\n\t\tvar items = parent.find('.js-select-block__item')\r\n\r\n\t\tselect.off('change.toggleSelectBlock')\r\n\t\t\t.on('change.toggleSelectBlock', toggleSelectBlock)\r\n\t\t\t.triggerHandler('change.toggleSelectBlock')\r\n\r\n\t\t// перебор элементов привязанных к селекту и переключение их видимости при совпадении атрибута value\r\n\t\tfunction toggleSelectBlock() {\r\n\t\t\tvar selectValue = select.val()\r\n\r\n\t\t\titems.each(function () {\r\n\t\t\t\tvar item = $(this)\r\n\r\n\t\t\t\tif (item.data('value') == selectValue) {\r\n\t\t\t\t\titem.show()\r\n\t\t\t\t} else {\r\n\t\t\t\t\titem.hide()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t})\r\n}\r\n\r\n// одноуровневые выпадающие селекты с фильтром\r\nfunction toggleSelectFilter() {\r\n\tvar allParents = $('.js-select--filter')\r\n\tvar allContents = allParents.find('.js-select__content')\r\n\r\n\tallParents.each(function (index) {\r\n\t\tvar parent = $(this)\r\n\t\tvar toggler = parent.find('.js-select__toggler')\r\n\t\tvar content = parent.find('.js-select__content')\r\n\t\tvar listItems = parent.find('.js-select__item')\r\n\t\tvar input = parent.find('.js-select__value')\r\n\t\tvar filter = parent.find('.js-select__filter')\r\n\r\n\t\t// инициализации и закрытие селекта при загрузке страницы\r\n\t\tcontent.fadeOut(0)\r\n\t\tparent.addClass('init-select')\r\n\r\n\t\tparent.off('click.toggleSelect').on('click.toggleSelect', function (event) {\r\n\t\t\tevent.stopPropagation()\r\n\t\t})\r\n\r\n\t\t// открытие по клику\r\n\t\ttoggler.off('click.toggleSelect').on('click.toggleSelect', function (event) {\r\n\t\t\t// селект заблокирован при наличии класса\r\n\t\t\tif (toggler.hasClass('disabled')) return\r\n\r\n\t\t\tif (!parent.hasClass('open-select')) {\r\n\t\t\t\topenSelect()\r\n\t\t\t} else {\r\n\t\t\t\tcloseSelect()\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t// фильтрация опций селекта\r\n\t\tfilter.off('input.toggleSelect').on('input.toggleSelect', function (event) {\r\n\t\t\tlistItems.each(function () {\r\n\t\t\t\tvar item = $(this)\r\n\r\n\t\t\t\tif (~item.text().toLowerCase().indexOf(filter.val().toLowerCase())) {\r\n\t\t\t\t\titem.show()\r\n\t\t\t\t} else {\r\n\t\t\t\t\titem.hide()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n\r\n\t\t// клик для выбора елемента option\r\n\t\tlistItems.off('click.setSelectOption').on('click.setSelectOption', function (event) {\r\n\t\t\tevent.stopPropagation()\r\n\t\t\tvar item = $(this)\r\n\t\t\tvar itemValue = item.attr('data-value')\r\n\r\n\t\t\tcloseSelect()\r\n\t\t\tif (itemValue === 'reset') {\r\n\t\t\t\tlistItems.removeClass('selected')\r\n\t\t\t\ttoggler.removeClass('selected').html(toggler.data('reset'))\r\n\t\t\t\tparent.attr('data-value', '')\r\n\t\t\t} else {\r\n\t\t\t\tlistItems.removeClass('selected')\r\n\t\t\t\titem.addClass('selected')\r\n\t\t\t\ttoggler.addClass('selected').html(item.html())\r\n\t\t\t\tparent.attr('data-value', itemValue)\r\n\t\t\t}\r\n\r\n\t\t\t// триггер события и установка выбранного значения на скрытом поле\r\n\t\t\tinput.val(item.attr('data-value')).trigger('change')\r\n\t\t})\r\n\r\n\t\t// переключение значения кастомного селекта по состоянию селекта\r\n\t\tinput.off('change.setSelectOption').on('change.setSelectOption', function () {\r\n\t\t\tactivateItem()\r\n\t\t})\r\n\r\n\t\t// переключение значения кастомного селекта\r\n\t\tfunction activateItem() {\r\n\t\t\tvar item = listItems.filter(function () {\r\n\t\t\t\treturn $(this).data('value') == input.val()\r\n\t\t\t})\r\n\t\t\tvar itemValue = item.attr('data-value')\r\n\r\n\t\t\tlistItems.removeClass('selected')\r\n\t\t\titem.addClass('selected')\r\n\t\t\ttoggler.addClass('selected').html(item.html())\r\n\t\t\tparent.attr('data-value', itemValue)\r\n\t\t}\r\n\r\n\t\tactivateItem()\r\n\r\n\t\t// открытие селекта\r\n\t\tfunction openSelect() {\r\n\t\t\tcontent.fadeIn(300)\r\n\t\t\tparent.addClass('open-select')\r\n\t\t\tfilter.focus()\r\n\t\t}\r\n\r\n\t\t// закрытие селекта\r\n\t\tfunction closeSelect() {\r\n\t\t\tcontent.fadeOut(300)\r\n\t\t\tparent.removeClass('open-select')\r\n\t\t}\r\n\r\n\t\t$(document).off('click.toggleSelectFilter' + index).on('click.toggleSelectFilter' + index, function (e) {\r\n\t\t\tif (!$(e.target).closest('.js-select--filter').length) {\r\n\t\t\t\tcloseSelect()\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\r\n\t// закрыть все селекты\r\n\ttoggleSelect.closeAllSelect = function () {\r\n\t\tallParents.removeClass('open-select')\r\n\t\tallContents.fadeOut(300)\r\n\t}\r\n}\r\n\r\n// селект с полем фильтром\r\nfunction selectWithFilter() {\r\n\tif ($.fn.ikSelect) {\r\n\t\t$('.js-select-w-filter').each(function () {\r\n\t\t\t$(this).ikSelect({\r\n\t\t\t\t// customClass: 'intro-select1',\r\n\t\t\t\tddFullWidth: false,\r\n\t\t\t\tfilter: true\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n}\r\n\r\n// поле для ввода количества с кнопками -/+\r\nfunction setQuantity() {\r\n\t$('.js-quantity').each(function () {\r\n\t\tvar parent = $(this)\r\n\t\tvar input = parent.find('.js-quantity__input')\r\n\t\tvar maxValue = parseFloat(input.data('maxValue'))\r\n\t\tvar minValue = parseFloat(input.data('minValue'))\r\n\t\tvar units = input.data('units')\r\n\t\tvar timeout = null\r\n\r\n\t\t// обработка кликов по кнопке\r\n\t\tparent.find('.js-quantity__btn').off('click.toggleQuantity').on('click.toggleQuantity', function () {\r\n\t\t\tvar step = parseFloat($(this).attr('data-step'))\r\n\t\t\tvar nextValue = parseFloat(input.val()) + step\r\n\r\n\t\t\t// если не выходит за интервал значений поля, то переключаем значение поля на заданный в атрибуте кнопок шаг\r\n\t\t\tif (nextValue <= maxValue && nextValue >= minValue) {\r\n\r\n\t\t\t\t// добавляем единицы измерения, если они заданы\r\n\t\t\t\tinput.val((units.length) ? nextValue + units : nextValue)\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t// обработка ввода в поле\r\n\t\tinput.off('keyup.toggleQuantity').on('keyup.toggleQuantity', function () {\r\n\t\t\tvar newValue = parseFloat(input.val())\r\n\r\n\t\t\t// если выходит за интервал значений поля, то меняем значение поля на корректное\r\n\t\t\tclearTimeout(timeout)\r\n\t\t\ttimeout = setTimeout(function () {\r\n\t\t\t\tif (newValue > maxValue) {\r\n\t\t\t\t\t// добавляем единицы измерения, если они заданы\r\n\t\t\t\t\tinput.val((units.length) ? maxValue + units : maxValue)\r\n\t\t\t\t}\r\n\t\t\t\tif (newValue < minValue) {\r\n\t\t\t\t\t// добавляем единицы измерения, если они заданы\r\n\t\t\t\t\tinput.val((units.length) ? minValue + units : minValue)\r\n\t\t\t\t}\r\n\t\t\t}, 1000)\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// переключение класса по клику\r\nfunction toggleClassBlock() {\r\n\tvar allParents = $('.js-class')\r\n\r\n\tallParents.each(function () {\r\n\t\tvar parent = $(this)\r\n\t\t// кастомный класс для переключения либо дефолтный\r\n\t\tvar activeClass = parent.data('class') || 'active-class'\r\n\r\n\t\tparent.find('.js-class__toggler').off('click.toggleClass').on('click.toggleClass', function (event) {\r\n\t\t\tevent.stopPropagation()\r\n\t\t\tevent.preventDefault()\r\n\r\n\t\t\tif (!parent.hasClass(activeClass)) {\r\n\t\t\t\tparent.addClass(activeClass)\r\n\t\t\t} else {\r\n\t\t\t\tparent.removeClass(activeClass)\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\r\n\t// закрыть все блоки\r\n\ttoggleClassBlock.closeAllClassBlocks = function () {\r\n\t\tallParents.removeClass('active-class')\r\n\t}\r\n}\r\n\r\n// переключение контента по табам\r\nfunction toggleTabs() {\r\n\t$('.js-tabs').each(function () {\r\n\t\tvar parent = $(this)\r\n\t\tvar togglers = parent.find('.js-tabs__toggler')\r\n\t\tvar tabs = parent.find('.js-tabs__tab')\r\n\r\n\t\t// инициализация и закрытие всех табов при загрузке, кроме того что с классом active-tab\r\n\t\ttabs.not('.active-tab').fadeOut(0)\r\n\t\tparent.addClass('init-tabs')\r\n\r\n\t\ttogglers.each(function (index) {\r\n\t\t\tvar toggler = $(this)\r\n\r\n\t\t\t// обработка переключения таба\r\n\t\t\ttoggler.off('click.toggleTabs').on('click.toggleTabs', function (event) {\r\n\t\t\t\tevent.preventDefault()\r\n\t\t\t\t// индекс нажатого таба\r\n\t\t\t\tvar indexTab = toggler.addClass('active-tab').data('tabsItem')\r\n\r\n\t\t\t\ttogglers.not(toggler).removeClass('active-tab')\r\n\r\n\t\t\t\ttabs.each(function () {\r\n\t\t\t\t\tvar tab = $(this)\r\n\r\n\t\t\t\t\t// открытие таба при совпадении с индексом переключателя\r\n\t\t\t\t\tif (tab.data('tabsItem') != indexTab) {\r\n\t\t\t\t\t\ttab.fadeOut(0).removeClass('active-tab')\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttab.fadeIn(300).addClass('active-tab')\r\n\r\n\t\t\t\t\t\t// инициализация lazyload картинок внутри таба\r\n\t\t\t\t\t\tlazyLoad(tab)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// переключение контента по табам нативный\r\nfunction toggleTabsNative() {\r\n\tvar parentsAll = document.querySelectorAll('.js-tabs--native');\r\n\r\n\t// вернет список без исключеного элемента\r\n\tfunction not($list, $element) {\r\n\t\tvar list = Array.from($list);\r\n\t\tvar index = list.indexOf($element);\r\n\t\tif (!index) {\r\n\t\t\treturn list.slice(++index)\r\n\t\t} else {\r\n\t\t\treturn list.slice(0, index).concat(list.slice(++index))\r\n\t\t}\r\n\t}\r\n\r\n\tArray.from(parentsAll).forEach(function (parent) {\r\n\t\tvar togglers = parent.querySelectorAll('.js-tabs__toggler')\r\n\t\tvar tabs = parent.querySelectorAll('.js-tabs__tab')\r\n\r\n\t\t// инициализация и закрытие всех табов при загрузке, кроме того что с классом active-tab\r\n\t\tArray.from(tabs).forEach(function (tab) {\r\n\t\t\ttab.classList.add('init-tabs')\r\n\t\t\tif (!tab.classList.contains('active-tab')) {\r\n\t\t\t\ttab.hidden = true;\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tArray.from(togglers).forEach(function (toggler) {\r\n\t\t\t// обработка переключения таба\r\n\t\t\ttoggler.addEventListener('click', function (e) {\r\n\t\t\t\te.preventDefault()\r\n\r\n\t\t\t\t// индекс нажатого таба\r\n\t\t\t\tvar indexTab = toggler.getAttribute('data-tabs-item')\r\n\r\n\t\t\t\t// активация переключателя при совпадении с индексом переключателя\r\n\t\t\t\tArray.from(togglers).forEach(function (togglerItem) {\r\n\t\t\t\t\ttogglerItem.classList.remove('active-tab')\r\n\t\t\t\t})\r\n\t\t\t\ttoggler.classList.add('active-tab')\r\n\r\n\t\t\t\t// открытие таба при совпадении с индексом переключателя\r\n\t\t\t\tArray.from(tabs).forEach(function (tab) {\r\n\t\t\t\t\tif (tab.getAttribute('data-tabs-item') === indexTab) {\r\n\t\t\t\t\t\ttab.classList.add('active-tab')\r\n\t\t\t\t\t\ttab.hidden = false;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttab.classList.remove('active-tab')\r\n\t\t\t\t\t\ttab.hidden = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// accordion\r\nfunction toggleAccordion() {\r\n\t$('.js-accordion').each(function () {\r\n\t\tvar parent = $(this)\r\n\t\tvar content = parent.find('.js-accordion__content')\r\n\r\n\t\t// закрытие всех аккордионов кроме тех что с классом open-accordion\r\n\t\tif (!parent.hasClass('open-accordion')) content.slideUp(0)\r\n\t\tparent.addClass('init-accordion')\r\n\r\n\t\t// переключение состояния аккордиона по клику\r\n\t\tparent.find('.js-accordion__toggler').off('click.toggleAccordion').on('click.toggleAccordion', function (event) {\r\n\t\t\tevent.stopPropagation()\r\n\t\t\tevent.preventDefault()\r\n\t\t\tparent.toggleClass('open-accordion')\r\n\t\t\tcontent.slideToggle(200)\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// accordion only adaptive\r\nfunction toggleAccordionOnlyAdaptive() {\r\n\tvar timeout = null\r\n\tvar win = $(window)\r\n\r\n\t// accordion только для адаптива\r\n\tfunction toggleAccordionOnlyAdaptive() {\r\n\t\tvar allParents = $('.js-accordion--adaptive')\r\n\r\n\t\tallParents.each(function () {\r\n\t\t\tvar parent = $(this)\r\n\t\t\tvar maxWidth = parseInt(parent.data('maxWidth'))\r\n\t\t\tvar content = parent.find('.js-accordion__content')\r\n\t\t\tvar toggler = parent.find('.js-accordion__toggler')\r\n\r\n\t\t\tif (win.width() <= maxWidth) {\r\n\t\t\t\t// инициализация и закрытие всех аккордионов кроме тех что с классом open-accordion\r\n\t\t\t\tif (!parent.hasClass('open-accordion')) content.slideUp(0)\r\n\t\t\t\tparent.addClass('init-accordion')\r\n\t\t\t\tparent.removeClass('destroy-accordion')\r\n\r\n\t\t\t\ttoggler.off('click.toggleAccordion').on('click.toggleAccordion', function (event) {\r\n\t\t\t\t\tevent.stopPropagation()\r\n\t\t\t\t\tevent.preventDefault()\r\n\r\n\t\t\t\t\tparent.toggleClass('open-accordion')\r\n\t\t\t\t\tcontent.slideToggle(300)\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\t// accordion destroy\r\n\t\t\t\tparent.addClass('destroy-accordion')\r\n\t\t\t\tcontent.slideDown(0)\r\n\r\n\t\t\t\ttoggler.off('click.toggleAccordion')\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\twin.off('resize.toggleAccordionOnlyAdaptive').on('resize.toggleAccordionOnlyAdaptive', function () {\r\n\t\tclearTimeout(timeout);\r\n\t\ttimeout = setTimeout(toggleAccordionOnlyAdaptive, 300);\r\n\t})\r\n\r\n\twin.trigger('resize.toggleAccordionOnlyAdaptive');\r\n}\r\n\r\n// accordion group\r\nfunction toggleAccordionGroup() {\r\n\t$('.js-accordion--group').each(function () {\r\n\t\tvar allAccordions = $(this).find('.js-accordion__item')\r\n\t\tvar allContents = allAccordions.find('.js-accordion__content')\r\n\r\n\t\tallAccordions.each(function () {\r\n\t\t\tvar accordion = $(this)\r\n\t\t\tvar content = accordion.find('.js-accordion__content')\r\n\r\n\t\t\t// инициализация и закрытие всех аккордионов кроме тех что с классом open-accordion\r\n\t\t\tif (!accordion.hasClass('open-accordion')) content.slideUp(0)\r\n\t\t\taccordion.addClass('init-accordion')\r\n\r\n\t\t\t// переключение состояния аккордиона по клику\r\n\t\t\taccordion.find('.js-accordion__toggler').off('click.toggleAccordion').on('click.toggleAccordion', function (event) {\r\n\t\t\t\tevent.stopPropagation()\r\n\t\t\t\tevent.preventDefault()\r\n\r\n\t\t\t\tcloseOtherAccordions()\r\n\r\n\t\t\t\t// переключение состояния аккордиона\r\n\t\t\t\taccordion.toggleClass('open-accordion')\r\n\t\t\t\tcontent.slideToggle(300)\r\n\t\t\t})\r\n\r\n\t\t\t// закрытие остальных аккардионов в группе\r\n\t\t\tfunction closeOtherAccordions() {\r\n\t\t\t\tallAccordions.not(accordion).removeClass('open-accordion')\r\n\t\t\t\tallContents.not(content).slideUp(300)\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// сворачивание лишних пунктов меню в аккордион с кнопкой \"еще\"\r\nfunction collapsibleMenu() {\r\n\t$('.js-collapsible').each(function () {\r\n\t\tvar parent = $(this)\r\n\t\tvar items = parent.find('.js-collapsible__item')\r\n\t\tvar quantity = parent.data('collapsible')\r\n\r\n\t\t// если елементов больше разрешенных и родитель не имеет класса инициализации свернуть лишние элементы в аккордион\r\n\t\tif (items.length > quantity && !parent.hasClass('init-collapsible')) {\r\n\t\t\tparent.addClass('init-collapsible')\r\n\r\n\t\t\t// добавление разметки для аккордионов\r\n\t\t\tvar accordion = $('<div class=\"js-accordion\"><div class=\"collapsible-menu__toggler  js-accordion__toggler\">Еще ' + (items.length - quantity) + '</div></div>')\r\n\t\t\tvar accordionContent = $('<div class=\"js-accordion__content\"></div>')\r\n\r\n\t\t\t// пробегаем по всем элементам перенося лишние в аккордион\r\n\t\t\titems.each(function (index) {\r\n\t\t\t\tif (index + 1 > quantity) {\r\n\t\t\t\t\taccordionContent.append($(this))\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\t// вставляем и инициализируем итоговый аккордион в родитель\r\n\t\t\taccordion.append(accordionContent)\r\n\t\t\tparent.append(accordion)\r\n\t\t\ttoggleAccordion()\r\n\t\t}\r\n\t})\r\n}\r\n\r\n// инициализация карусели (Swiper)\r\nfunction initCarousel() {\r\n\tif (window.Swiper) {\r\n\t\tvar win = $(window)\r\n\t\tvar doc = $(document)\r\n\t\tvar timeout = null\r\n\r\n\t\t// получать расстояние до видимости блока при скролле страницы\r\n\t\tfunction getVisibleElemOnScroll(elemJQ, reserveHeight) {\r\n\t\t\tif (elemJQ.length > 0) {\r\n\t\t\t\treturn elemJQ.offset().top - (doc.scrollTop() + win.height() + reserveHeight) < 0\r\n\t\t\t}\r\n\t\t\treturn false\r\n\t\t}\r\n\r\n\t\t// инициализация слайдера если он в зоне видимости или приближается к ней (ближе 500рх) и до сих пор не инициализирован\r\n\t\tfunction initSwiper(elemJQ, optionSwiper) {\r\n\t\t\tvar instanceSwiper = null\r\n\r\n\t\t\tif (window.IntersectionObserver) {\r\n\t\t\t\tvar observer = new IntersectionObserver(function (entries, observer) {\r\n\t\t\t\t\tentries.forEach(function (entry) {\r\n\t\t\t\t\t\tconsole.log('eeeeeeeeee', entry.isIntersecting)\r\n\t\t\t\t\t\tif (entry.isIntersecting) {\r\n\t\t\t\t\t\t\tinstanceSwiper = new Swiper(entry.target, optionSwiper)\r\n\t\t\t\t\t\t\tobserver.unobserve(entry.target)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\tconsole.log('ooooooooooooo', observer)\r\n\t\t\t\t}, {root: null, rootMargin: '500px', threshold: 0})\r\n\t\t\t\tobserver.observe(elemJQ[0])\r\n\t\t\t} else {\r\n\t\t\t\tif (!elemJQ.hasClass('swiper-container-initialized') && getVisibleElemOnScroll(elemJQ, 500)) {\r\n\t\t\t\t\tinstanceSwiper = new Swiper(elemJQ[0], optionSwiper)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn instanceSwiper\r\n\t\t}\r\n\r\n\t\t// добаления класса если ширины всех слайдов не достаточно для скролла\r\n\t\tfunction toggleClassSwiper(parent, widthAllItems) {\r\n\t\t\tif (parent.width() > widthAllItems) {\r\n\t\t\t\tparent.addClass('swiper-empty')\r\n\t\t\t} else {\r\n\t\t\t\tparent.removeClass('swiper-empty')\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// ******************************************************************************\r\n\t\tvar optionSwiper = {\r\n\t\t\tslidesPerView: 5,\r\n\t\t\t// slidesPerView: 'auto',\r\n\t\t\tspaceBetween: 5,\r\n\r\n\t\t\t// infinity scroll\r\n\t\t\tloop: true,\r\n\t\t\tloopedSlides: 5,\r\n\t\t\tloopAdditionalSlides: 5,\r\n\r\n\t\t\t// если слайдов не хватает для скролла - центровать те что есть, не совместим с бесконечным скролом\r\n\t\t\twatchOverflow: true,\r\n\t\t\tcenterInsufficientSlides: true,\r\n\r\n\t\t\t// если родительский контейнер не виден (display none)\r\n\t\t\tobserver: true,\r\n\t\t\tobserveParents: true,\r\n\r\n\t\t\twatchSlidesProgress: true,\r\n\t\t\t// слайды, которые находятся в области просмотра, будут иметь дополнительный видимый класс\r\n\t\t\twatchSlidesVisibility: true,\r\n\r\n\t\t\t// lazy load images\r\n\t\t\tlazy: {\r\n\t\t\t\tloadPrevNext: true,\r\n\t\t\t\tloadOnTransitionStart: true,\r\n\t\t\t},\r\n\r\n\t\t\t// инертность свайпа слайдов\r\n\t\t\tfreeMode: true,\r\n\t\t\tfreeModeSticky: true,\r\n\r\n\t\t\t// Responsive breakpoints\r\n\t\t\tbreakpoints: {\r\n\t\t\t\t420: {\r\n\t\t\t\t\tslidesPerView: 1,\r\n\t\t\t\t},\r\n\t\t\t\t580: {\r\n\t\t\t\t\tslidesPerView: 2,\r\n\t\t\t\t},\r\n\t\t\t\t740: {\r\n\t\t\t\t\tslidesPerView: 3,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\r\n\t\t\tnavigation: {\r\n\t\t\t\tnextEl: '.swiper-button-next',\r\n\t\t\t\tprevEl: '.swiper-button-prev',\r\n\t\t\t},\r\n\t\t\tpagination: {\r\n\t\t\t\tel: '.swiper-pagination',\r\n\t\t\t\ttype: 'bullets',\r\n\t\t\t\tclickable: true,\r\n\t\t\t\tdynamicBullets: true,\r\n\t\t\t\tdynamicMainBullets: 4,\r\n\t\t\t},\r\n\r\n\t\t\ton: {\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\t// добаления класса если ширины всех слайдов не достаточно для скролла\r\n\t\t\t\t\tvar parent = $(this.$el)\r\n\t\t\t\t\tvar widthAllItems = this.slidesSizesGrid.reduce(function (sum, curr) {\r\n\t\t\t\t\t\treturn sum + curr\r\n\t\t\t\t\t})\r\n\t\t\t\t\ttoggleClassSwiper(parent, widthAllItems)\r\n\t\t\t\t},\r\n\r\n\t\t\t\tbeforeDestroy: function () {\r\n\t\t\t\t\t// удаление стилей оставшихся от слайдера\r\n\t\t\t\t\tvar wrapper = $(this.$wrapperEl)\r\n\t\t\t\t\tvar slides = wrapper.find('.swiper-slide')\r\n\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\twrapper.removeAttr('style')\r\n\t\t\t\t\t\tslides.removeAttr('style')\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t},\r\n\r\n\t\t\t\tresize: function () {\r\n\t\t\t\t\tvar parent = $(this.$el)\r\n\r\n\t\t\t\t\t// добаления класса если ширины всех слайдов не достаточно для скролла\r\n\t\t\t\t\tvar widthAllItems = this.slidesSizesGrid.reduce(function (sum, curr) {\r\n\t\t\t\t\t\treturn sum + curr\r\n\t\t\t\t\t})\r\n\t\t\t\t\ttoggleClassSwiper(parent, widthAllItems)\r\n\t\t\t\t},\r\n\r\n\t\t\t\tslidePrevTransitionEnd: function () {\r\n\t\t\t\t\t// добаления класса когда слайдер дошел до конца\r\n\t\t\t\t\t$(this.$el).removeClass('swiper-end')\r\n\t\t\t\t},\r\n\r\n\t\t\t\treachEnd: function () {\r\n\t\t\t\t\t// удаление класса когда возврат на спредыдущий слайд\r\n\t\t\t\t\t$(this.$el).addClass('swiper-end')\r\n\t\t\t\t},\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// mySwiper.update ();\r\n\t\t// Вы должны вызывать его после того, как добавляете / удаляете слайды вручную, или после того, как вы скрываете / показываете его, или делаете любые пользовательские модификации DOM с помощью Swiper\r\n\t\t// Этот метод также включает в себя подзвон следующих методов, которые вы можете использовать отдельно:\r\n\t\t// \tmySwiper.updateSize () - пересчитать размер контейнера swiper\r\n\t\t// mySwiper.updateSlides () - пересчитать количество слайдов и их смещения. Полезно после добавления / удаления слайдов с помощью JavaScript\r\n\t\t// mySwiper.updateProgress () - пересчитать прогресс swiper\r\n\t\t// mySwiper.updateSlidesClasses () - обновлять активные / предыдущие / следующие классы на слайдах и маркерах\r\n\r\n\t\t// одиночная карусель\r\n\t\tfunction initSingleSwiper() {\r\n\t\t\tinitSwiper($('.js-carousel--1'), optionSwiper)\r\n\t\t}\r\n\r\n\t\t// win.off('scroll.initSingleSwiper').on('scroll.initSingleSwiper', initSingleSwiper)\r\n\t\t// win.trigger('scroll.initSingleSwiper')\r\n\r\n\t\t// карусель только для адаптива\r\n\t\tvar swiper_3 = {}\r\n\r\n\t\tfunction initOnlyAdaptiveSwipers() {\r\n\t\t\tif (win.width() <= 1024) {\r\n\t\t\t\tif (!'$el' in swiper_3) {\r\n\t\t\t\t\tswiper_3 = initSwiper($('.js-carousel--3'), optionSwiper)\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (swiper_3.destroy) swiper_3.destroy(true, true)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// win.off('resize.initOnlyAdaptiveSwipers').on('resize.initOnlyAdaptiveSwipers', function () {\r\n\t\t// \tclearTimeout(timeout)\r\n\t\t// \ttimeout = setTimeout(initOnlyAdaptiveSwipers, 300)\r\n\t\t// })\r\n\t\t// win.off('scroll.initOnlyAdaptiveSwipers').on('scroll.initOnlyAdaptiveSwipers', initOnlyAdaptiveSwipers)\r\n\t\t// win.trigger('scroll.initOnlyAdaptiveSwipers')\r\n\r\n\t\t// *******************************************************************************\r\n\r\n\t\t// повторяющаяся карусель\r\n\t\t$('.js-carousel--2').each(function (ind) {\r\n\t\t\tvar carouselElemJQ = $(this)\r\n\r\n\t\t\tif (window.IntersectionObserver) {\r\n\t\t\t\tinitSwiper(carouselElemJQ, optionSwiper)\r\n\t\t\t} else {\r\n\t\t\t\tfunction initSwiper_2() {\r\n\t\t\t\t\tinitSwiper(carouselElemJQ, optionSwiper)\r\n\t\t\t\t}\r\n\r\n\t\t\t\twin.off('scroll.initSwiper_2_' + ind).on('scroll.initSwiper_2_' + ind, initSwiper_2)\r\n\t\t\t\twin.trigger('scroll.initSwiper_2_' + ind)\r\n\t\t\t}\r\n\t\t})\r\n\r\n\r\n\t\t// инициализация слайдера\r\n\t\tvar mySwiper = new Swiper('.js-slider', {\r\n\t\t\teffect: 'cube',\r\n\t\t\tspeed: 800,\r\n\r\n\t\t\t// infinity scroll\r\n\t\t\tloop: true,\r\n\t\t\ta11y: false,\r\n\r\n\t\t\tautoplay: {\r\n\t\t\t\tdelay: 5000,\r\n\t\t\t\tdisableOnInteraction: false,\r\n\t\t\t},\r\n\r\n\t\t\tpagination: {\r\n\t\t\t\tel: '.swiper-pagination',\r\n\t\t\t\ttype: 'bullets',\r\n\t\t\t\tclickable: true,\r\n\t\t\t},\r\n\r\n\t\t\ton: {\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\tsetTimeout(initAutoplay, 10, this)\r\n\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\tmySwiper.on('slideChangeTransitionStart', function () {\r\n\t\t\t\t\t\t\tinitAutoplay(this)\r\n\t\t\t\t\t\t}, 20);\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// реализация анимации буллетов при переключении сладов\r\n\t\tfunction initAutoplay(_this) {\r\n\t\t\tvar parent = $(_this.el)\r\n\t\t\tvar autoplayTimeCurrentSlide = parseInt(_this.$wrapperEl.find('.swiper-slide-active').attr('data-swiper-autoplay')) + 700\r\n\t\t\tvar dots = parent.find('.swiper-pagination-bullet')\r\n\t\t\tvar activeDot = parent.find('.swiper-pagination-bullet-active')\r\n\t\t\tvar allSvg = dots.find('svg')\r\n\r\n\t\t\t// защита от повторного запуска инициализации\r\n\t\t\tif (!initAutoplay.init) {\r\n\t\t\t\t// вставка свг в дотсы пагинации\r\n\t\t\t\tdots.html(`<svg class=\"svg-circle\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 120 120\">\r\n                    <circle cx=\"60\" cy=\"60\" r=\"50\"></circle>\r\n                 </svg>`)\r\n\r\n\t\t\t\t// остановка автоплэя и анимации дотсов при ховере на слайдер\r\n\t\t\t\tparent.off('mouseenter.stopAutoPlay mousemove.stopAutoPlay').on('mouseenter.stopAutoPlay mousemove.stopAutoPlay', function () {\r\n\t\t\t\t\t_this.autoplay.stop();\r\n\t\t\t\t\tdots.find('svg').removeClass('animate').css({transitionDuration: ''})\r\n\t\t\t\t})\r\n\t\t\t\t// запуск автоплэя и анимации дотсов при потере ховера на слайдере\r\n\t\t\t\tparent.off('mouseleave.startAutoPlay').on('mouseleave.startAutoPlay', function () {\r\n\t\t\t\t\t_this.autoplay.start();\r\n\t\t\t\t\tparent.find('.swiper-pagination-bullet-active').find('svg').addClass('animate').css({transitionDuration: autoplayTimeCurrentSlide + 'ms'})\r\n\t\t\t\t})\r\n\r\n\t\t\t\tinitAutoplay.init = true\r\n\t\t\t}\r\n\r\n\t\t\t// остановка анимации дотса\r\n\t\t\tallSvg.removeClass('animate').css({transitionDuration: ''})\r\n\r\n\t\t\t// запуск анимации дотса\r\n\t\t\tactiveDot.find('svg').addClass('animate').css({transitionDuration: autoplayTimeCurrentSlide + 'ms'})\r\n\t\t}\r\n\r\n\t\t// ******************************************************************************\r\n\t\t// карусель с навигацией\r\n\t\t// var navCarousel = initSwiper($('.js-carousel-w-nav--navigation'), {\r\n\t\t// \tdirection: 'vertical',\r\n\t\t// \tslidesPerView: 4,\r\n\t\t// \tspaceBetween: 10,\r\n\t\t//\r\n\t\t// \t// если слайдов не хватает для скролла - центровать те что есть, не совместим с бесконечным скролом\r\n\t\t// \twatchOverflow: true,\r\n\t\t// \tcenterInsufficientSlides: true,\r\n\t\t//\r\n\t\t// \t// lazy load images\r\n\t\t// \twatchSlidesProgress: true,\r\n\t\t// \twatchSlidesVisibility: true,\r\n\t\t// \tlazy: {\r\n\t\t// \t\tloadPrevNext: true,\r\n\t\t// \t\tloadOnTransitionStart: true,\r\n\t\t// \t},\r\n\t\t//\r\n\t\t// \t// Responsive breakpoints\r\n\t\t// \tbreakpoints: {\r\n\t\t// \t\t310: {\r\n\t\t// \t\t\tslidesPerView: 3,\r\n\t\t// \t\t\tdirection: 'horizontal',\r\n\t\t// \t\t},\r\n\t\t// \t\t600: {\r\n\t\t// \t\t\tslidesPerView: 4,\r\n\t\t// \t\t},\r\n\t\t// \t},\r\n\t\t// })\r\n\t\t// initSwiper($('.js-carousel-w-nav--main'), {\r\n\t\t// \teffect: 'fade',\r\n\t\t// \t// lazy load images\r\n\t\t// \tlazy: {\r\n\t\t// \t\tloadPrevNext: true,\r\n\t\t// \t\tloadOnTransitionStart: true,\r\n\t\t// \t},\r\n\t\t//\r\n\t\t// \tthumbs: {\r\n\t\t// \t\tswiper: navCarousel\r\n\t\t// \t},\r\n\t\t//\r\n\t\t// \tnavigation: {\r\n\t\t// \t\tnextEl: '.js-swiper-w-nav-button-next',\r\n\t\t// \t\tprevEl: '.js-swiper-w-nav-button-prev',\r\n\t\t// \t},\r\n\t\t// })\r\n\t}\r\n}\r\n\r\n// сворачивание больших текстов по кнопке\r\nfunction clippedText() {\r\n\tvar win = $(window)\r\n\r\n\t$('.js-clipped').each(function (ind) {\r\n\t\tvar parent = $(this)\r\n\t\tvar content = parent.find('.js-clipped__content')\r\n\t\tvar toggler = parent.find('.js-clipped__toggler')\r\n\t\tvar timeout = null;\r\n\t\tvar textInit = content.html()\r\n\t\t// высота текста из атрибута или дефолтная, которую стоит сворачивать\r\n\t\tvar clippedHeight = parent.data('clippedHeight') || 100\r\n\t\t// колличество символов для показа сокращенной версии\r\n\t\tvar clippedSymbols = parent.data('clippedSymbols')\r\n\r\n\t\tfunction clippedText() {\r\n\t\t\t// сбросс высоты контента\r\n\t\t\tparent.removeClass('init-clipped')\r\n\t\t\tcontent.css({maxHeight: ''})\r\n\r\n\t\t\t// если указано ограничение сокращенной версии по символам то высоту берем по их размеру высоты\r\n\t\t\tif (clippedSymbols) {\r\n\t\t\t\tcontent.text(content.text().substr(0, clippedSymbols))\r\n\t\t\t\tclippedHeight = content.outerHeight()\r\n\t\t\t\tcontent.html(textInit)\r\n\t\t\t}\r\n\r\n\t\t\t// изначальная высота блока с текстом\r\n\t\t\tvar initialHeightContent = content.outerHeight()\r\n\r\n\t\t\t// инициализация плагина, если длинна текста больше допустимой\r\n\t\t\tif (initialHeightContent > clippedHeight) {\r\n\t\t\t\tparent.addClass('init-clipped')\r\n\t\t\t\tclose()\r\n\r\n\t\t\t\t// переключение сворачивания контента\r\n\t\t\t\ttoggler.off('click.clippedText').on('click.clippedText', function () {\r\n\t\t\t\t\tif (parent.hasClass('open-clipped')) {\r\n\t\t\t\t\t\tclose()\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tparent.addClass('open-clipped')\r\n\t\t\t\t\t\tcontent.css({maxHeight: initialHeightContent})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\ttoggler.off('click.clippedText')\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// закрыть выпадашку\r\n\t\tfunction close() {\r\n\t\t\tparent.removeClass('open-clipped')\r\n\t\t\tcontent.css({maxHeight: clippedHeight})\r\n\t\t}\r\n\r\n\t\twin.off('resize.clippedText' + ind).on('resize.clippedText' + ind, function () {\r\n\t\t\tclearTimeout(timeout);\r\n\t\t\ttimeout = setTimeout(clippedText, 300);\r\n\t\t})\r\n\r\n\t\twin.trigger('resize.clippedText' + ind);\r\n\t})\r\n}\r\n\r\n// подскролл страницы в начала по клику на кнопку\r\nfunction scrollTop() {\r\n\t$('.js-scroll-top').off('click.scrollTop').on('click.scrollTop', function () {\r\n\t\t$([document.documentElement, document.body]).animate({scrollTop: 0}, 400)\r\n\t})\r\n}\r\n\r\n// фиксация блока при скролле страницы\r\nfunction fixedBlockWhenScrolling() {\r\n\t$('.js-fixed').each(function (index) {\r\n\t\tvar block = $(this)\r\n\t\tvar blockHeight = block.outerHeight()\r\n\t\tvar blockStart = block.offset().top\r\n\t\tvar doc = $(document)\r\n\r\n\t\tfunction fixedBlockWhenScrolling() {\r\n\t\t\tvar docScroll = doc.scrollTop()\r\n\r\n\t\t\t// фиксация блока\r\n\t\t\tif (blockStart <= docScroll) {\r\n\t\t\t\tdoc.addClass('active-fixed')\r\n\t\t\t\tblock.addClass('active-fixed').css('padding-top', blockHeight)\r\n\t\t\t} else if (blockStart > docScroll) {\r\n\t\t\t\t// отмена фиксации блока\r\n\t\t\t\tdoc.removeClass('active-fixed')\r\n\t\t\t\tblock.removeClass('active-fixed').css('padding-top', 0)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// инициализаци с индексом на случай множественных блоков для фиксации\r\n\t\tdoc.off('scroll.fixedBlockWhenScrolling' + index)\r\n\t\t\t.on('scroll.fixedBlockWhenScrolling' + index, function () {\r\n\t\t\t\tif (requestAnimationFrame) requestAnimationFrame(fixedBlockWhenScrolling)\r\n\t\t\t\telse fixedBlockWhenScrolling();\r\n\t\t\t})\r\n\t\t\t.trigger('scroll.fixedBlockWhenScrolling' + index);\r\n\t})\r\n}\r\n\r\n// показ зафиксированного блока при скролле страницы вверх\r\nfunction showBlockIfScrollingUp() {\r\n\t$('.js-fixed--up').each(function (index) {\r\n\t\tvar block = $(this)\r\n\t\tvar blockHeight = block.outerHeight()\r\n\t\tvar blockStart = block.offset().top\r\n\t\tvar blockEnd = blockStart + blockHeight\r\n\t\tvar doc = $(document)\r\n\t\tvar oldDocScroll = 0\r\n\t\tvar newDocScroll = 0\r\n\r\n\t\tfunction showBlockIfScrollingUp() {\r\n\t\t\tnewDocScroll = doc.scrollTop()\r\n\r\n\t\t\t// показ блока если сделан скролл страницы наверх\r\n\t\t\tif (blockEnd < newDocScroll && oldDocScroll > newDocScroll) {\r\n\t\t\t\tblock.addClass('active-fixed').css('padding-top', blockHeight)\r\n\t\t\t} else if (blockStart >= newDocScroll || oldDocScroll < newDocScroll) {\r\n\t\t\t\t// скрытие блока\r\n\t\t\t\tblock.removeClass('active-fixed').css('padding-top', 0)\r\n\t\t\t}\r\n\r\n\t\t\toldDocScroll = doc.scrollTop()\r\n\t\t}\r\n\r\n\t\t// инициализаци с индексом на случай множественных блоков для фиксации\r\n\t\tdoc.off('scroll.showBlockIfScrollingUp' + index)\r\n\t\t\t.on('scroll.showBlockIfScrollingUp' + index, function () {\r\n\t\t\t\tif (requestAnimationFrame) requestAnimationFrame(showBlockIfScrollingUp)\r\n\t\t\t\telse showBlockIfScrollingUp();\r\n\t\t\t})\r\n\t\t\t.trigger('scroll.showBlockIfScrollingUp' + index);\r\n\t})\r\n}\r\n\r\n// меню с ховером и задержкой\r\nfunction delayHoverMenu() {\r\n\tvar allParents = $('.js-hover-menu')\r\n\tvar win = $(window)\r\n\tvar timeout = null;\r\n\r\n\tfunction delayHoverMenu() {\r\n\t\tvar adaptiveDevice = win.width() < 1024\r\n\t\tallParents.each(function () {\r\n\t\t\tvar parent = $(this)\r\n\t\t\tvar items = parent.find('.js-hover-menu__item')\r\n\r\n\t\t\tif (!adaptiveDevice) {\r\n\t\t\t\t// текущее положение курсора\r\n\t\t\t\tvar nCurPosX;\r\n\t\t\t\tparent.mousemove(function (event) {\r\n\t\t\t\t\treturn nCurPosX = event.clientX\r\n\t\t\t\t})\r\n\r\n\t\t\t\titems.each(function () {\r\n\t\t\t\t\tvar curItem = $(this)\r\n\r\n\t\t\t\t\t// обработка прихода курсора на пункта меню\r\n\t\t\t\t\tcurItem.off('mouseover.showInnerMenu').on('mouseover.showInnerMenu', function () {\r\n\t\t\t\t\t\tcurItem.addClass('hover');\r\n\r\n\t\t\t\t\t\t/* делаем задержку чтобы при случайном наведении на пункт подменю не показывалось */\r\n\t\t\t\t\t\tsetTimeout(function () {\r\n\r\n\t\t\t\t\t\t\t/* если по истечению задержки мы все еще на том же пункт меню, значит показываем подменю */\r\n\t\t\t\t\t\t\tif (curItem.hasClass('hover')) {\r\n\t\t\t\t\t\t\t\tcurItem.addClass('active')\r\n\r\n\t\t\t\t\t\t\t\t// инициализация картинок во внутреннем блоке\r\n\t\t\t\t\t\t\t\tlazyLoad(curItem)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, 300);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// обработка ухода курсора с пункта меню\r\n\t\t\t\t\tcurItem.off('mouseout.hideInnerMenu').on('mouseout.hideInnerMenu', function () {\r\n\t\t\t\t\t\tvar nPosXStart = nCurPosX\r\n\t\t\t\t\t\tcurItem.removeClass('hover');\r\n\r\n\t\t\t\t\t\t/* делаем небольшую задержку чтобы определить направление движение курсора */\r\n\t\t\t\t\t\tsetTimeout(function () {\r\n\r\n\t\t\t\t\t\t\t// если в сторону подменю, значит делаем большую задержку для возможности движения по диагонали\r\n\t\t\t\t\t\t\tif (nCurPosX - nPosXStart > 0) {\r\n\t\t\t\t\t\t\t\tsetTimeout(function () {\r\n\r\n\t\t\t\t\t\t\t\t\t/* если по истечению задержки курсор находится на подменю или текущем пункте меню тогда не прячем подменю */\r\n\t\t\t\t\t\t\t\t\tif (!curItem.hasClass('hover')) {\r\n\t\t\t\t\t\t\t\t\t\tdeactivateItem()\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}, 300);\r\n\t\t\t\t\t\t\t} else if (!curItem.hasClass('hover')) {\r\n\r\n\t\t\t\t\t\t\t\t// если нет и мы ушли с текущего пункта меню, моментально скрываем подменю\r\n\t\t\t\t\t\t\t\tdeactivateItem()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, 10);\r\n\r\n\t\t\t\t\t\t// деактивируем пункт меню\r\n\t\t\t\t\t\tfunction deactivateItem() {\r\n\t\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\t\tcurItem.removeClass('active');\r\n\t\t\t\t\t\t\t}, 300)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\t// удаляем обработчики hover с пунктов меню\r\n\t\t\t\titems.off('mouseover.showInnerMenu')\r\n\t\t\t\titems.off('mouseout.hideInnerMenu')\r\n\t\t\t\titems.removeClass('hover active')\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\twin.off('resize.delayHoverMenu').on('resize.delayHoverMenu', function () {\r\n\t\tclearTimeout(timeout);\r\n\t\ttimeout = setTimeout(delayHoverMenu, 300);\r\n\t})\r\n\r\n\twin.trigger('resize.delayHoverMenu');\r\n}\r\n\r\n// отложенная инициализация яндекс карт по скроллу\r\nfunction initMapsDelayScroll() {\r\n\tvar win = $(window)\r\n\tvar maps = $('.js-map')\r\n\t// для защиты от повторной инициализации\r\n\tvar checkInitedMaps = false\r\n\r\n\tif (maps.length) {\r\n\t\tfunction initMaps() {\r\n\t\t\t// инициализируем если карта еще не инициализировалась\r\n\t\t\tif (!checkInitedMaps) {\r\n\t\t\t\tloadDelayScript('https://api-maps.yandex.ru/2.1.73/?apikey=1e018326-a5eb-49f1-9128-253da1c29e6d&lang=ru_RU&onLoad=initMaps')\r\n\t\t\t\tcheckInitedMaps = true\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// запус инициализации если карта в зоне видимости или приближается к ней\r\n\t\twin.off('scroll.initMapsScroll').on('scroll.initMapsScroll', function () {\r\n\t\t\tif (getVisibleElemOnScroll(maps, 500)) initMaps()\r\n\t\t})\r\n\t\twin.trigger('scroll.initMapsScroll')\r\n\t}\r\n}\r\n\r\n// инициализация всех яндекс карт на сайте\r\nfunction initMaps() {\r\n\tymaps.ready(function () {\r\n\t\t// одиночная метка с контеном\r\n\t\t$('#ymaps-single').each(function () {\r\n\t\t\tvar mapItem = $(this)\r\n\t\t\tvar placemarkCoordinates = mapItem.data('coordinates').split(', ')\r\n\t\t\tvar placemarkTitle = mapItem.data('title') || ''\r\n\t\t\tvar zoom = mapItem.data('zoom') || 8\r\n\r\n\t\t\tvar mapObject = new ymaps.Map(mapItem[0], {\r\n\t\t\t\tcenter: placemarkCoordinates,\r\n\t\t\t\tcontrols: ['geolocationControl', 'fullscreenControl'],\r\n\t\t\t\tzoom: zoom,\r\n\t\t\t}, {\r\n\t\t\t\tsearchControlProvider: 'yandex#search'\r\n\t\t\t})\r\n\r\n\t\t\t// Создание метки.\r\n\t\t\tvar locationPoint = new ymaps.Placemark(placemarkCoordinates, {\r\n\t\t\t\t// balloonContentBody: 'Эдуард',\r\n\t\t\t\t// balloonContentFooter: 'г. Душанбе, ул. Айни',\r\n\t\t\t\thintContent: placemarkTitle,\r\n\t\t\t\tballoonContent: placemarkTitle,\r\n\t\t\t}, {  // Опции.\r\n\t\t\t\tpreset: 'islands#circleDotIcon',\r\n\t\t\t})\r\n\t\t\tmapObject.geoObjects.add(locationPoint)\r\n\t\t})\r\n\r\n\t\t// множество меток из атрибута\r\n\t\t$('#ymaps-multi-attr').each(function () {\r\n\t\t\tvar mapItem = $(this)\r\n\t\t\tvar points = mapItem.data('points');\r\n\r\n\t\t\tvar mapObject = new ymaps.Map(mapItem[0], {\r\n\t\t\t\tcenter: ['38.563013', '68.810380'],\r\n\t\t\t\tcontrols: ['geolocationControl', 'fullscreenControl'],\r\n\t\t\t\tzoom: 15,\r\n\t\t\t}, {\r\n\t\t\t\tsearchControlProvider: 'yandex#search'\r\n\t\t\t})\r\n\r\n\t\t\tpoints.forEach(function (point) {\r\n\t\t\t\tvar placemarkCoordinates = point.coords.split(', ');\r\n\t\t\t\tvar placemarkTitle = point.title || '';\r\n\r\n\t\t\t\t// Создание метки.\r\n\t\t\t\tvar locationPoint = new ymaps.Placemark(placemarkCoordinates, {\r\n\t\t\t\t\t// balloonContentBody: 'Эдуард',\r\n\t\t\t\t\t// balloonContentFooter: 'г. Душанбе, ул. Айни',\r\n\t\t\t\t\thintContent: placemarkTitle,\r\n\t\t\t\t\tballoonContent: placemarkTitle,\r\n\t\t\t\t}, {  // Опции.\r\n\t\t\t\t\tpreset: 'islands#circleDotIcon',\r\n\t\t\t\t})\r\n\t\t\t\tmapObject.geoObjects.add(locationPoint)\r\n\t\t\t})\r\n\r\n\t\t\t// устанавливаем нужный центр и зум карты, чтобы было видно все метки и задаем нужный отступ меток от края карты\r\n\t\t\tmapObject.setBounds(mapObject.geoObjects.getBounds(), {checkZoomRange: true, zoomMargin: 50})\r\n\t\t\t\t.then(function () {\r\n\t\t\t\t\t//после установки проверяем зум и не даем выйти за рамки нужного\r\n\t\t\t\t\tif (mapObject.getZoom() > 15) mapObject.setZoom(15);\r\n\t\t\t\t});\r\n\t\t})\r\n\r\n\t\t// множество дефолтных меток\r\n\t\t$('#ymaps-multi-default').each(function () {\r\n\t\t\tvar mapItem = $(this)\r\n\t\t\t// путь к JSON файлу с данными для карты\r\n\t\t\tvar pathJsonMulti = mapItem.data('json-path')\r\n\r\n\t\t\tvar mapObject = new ymaps.Map(mapItem[0], {\r\n\t\t\t\tcenter: [125.79, 17.64],\r\n\t\t\t\tcontrols: ['geolocationControl', 'fullscreenControl'],\r\n\t\t\t\tzoom: 1,\r\n\t\t\t}, {\r\n\t\t\t\tsearchControlProvider: 'yandex#search'\r\n\t\t\t})\r\n\t\t\tvar objectManager = new ymaps.ObjectManager({\r\n\t\t\t\t// Чтобы метки начали кластеризоваться, выставляем опцию.\r\n\t\t\t\tclusterize: true,\r\n\t\t\t\t// ObjectManager принимает те же опции, что и кластеризатор.\r\n\t\t\t\tgridSize: 32,\r\n\t\t\t\tclusterDisableClickZoom: true\r\n\t\t\t})\r\n\r\n\t\t\t// Чтобы задать опции одиночным объектам и кластерам,\r\n\t\t\t// обратимся к дочерним коллекциям ObjectManager.\r\n\t\t\tobjectManager.objects.options.set('preset', 'islands#blueDotIcon');\r\n\t\t\tobjectManager.clusters.options.set('preset', 'islands#blueClusterIcons');\r\n\r\n\t\t\t// Загружаем GeoJSON файл с описанием объектов.\r\n\t\t\t$.getJSON(pathJsonMulti)\r\n\t\t\t\t.done(function (response) {\r\n\t\t\t\t\t// Добавляем описание объектов в формате JSON в менеджер объектов.\r\n\t\t\t\t\tobjectManager.add(response);\r\n\t\t\t\t\t// Добавляем объекты на карту.\r\n\t\t\t\t\tmapObject.geoObjects.add(objectManager);\r\n\r\n\t\t\t\t\t// устанавливаем нужный центр и зум карты, чтобы было видно все метки и задаем нужный отступ меток от края карты\r\n\t\t\t\t\tmapObject.setBounds(mapObject.geoObjects.getBounds(), {checkZoomRange: true, zoomMargin: 50})\r\n\t\t\t\t\t\t.then(function () {\r\n\t\t\t\t\t\t\t//после установки проверяем зум и не даем выйти за рамки нужного\r\n\t\t\t\t\t\t\tif (mapObject.getZoom() > 15) mapObject.setZoom(15);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\t.fail(function (response) {\r\n\t\t\t\t\tconsole.warn('offer: ajax load failed', response)\r\n\t\t\t\t})\r\n\t\t})\r\n\r\n\t\t// множество кастомизированных меток\r\n\t\t$('#ymaps-multi-custom').each(function () {\r\n\t\t\tvar mapItem = $(this)\r\n\t\t\t// путь к JSON файлу с данными для карты\r\n\t\t\tvar pathJsonMultiCustom = mapItem.data('json-path')\r\n\r\n\t\t\tvar mapObject = new ymaps.Map(mapItem[0], {\r\n\t\t\t\tcenter: [50.79, 37.64],\r\n\t\t\t\tcontrols: ['zoomControl', 'geolocationControl'],\r\n\t\t\t\tzoom: 18,\r\n\t\t\t}, {\r\n\t\t\t\tsearchControlProvider: 'yandex#search'\r\n\t\t\t})\r\n\t\t\tvar objectManager = new ymaps.ObjectManager({\r\n\t\t\t\t// Чтобы метки начали кластеризоваться, выставляем опцию.\r\n\t\t\t\tclusterize: true,\r\n\t\t\t\t// ObjectManager принимает те же опции, что и кластеризатор.\r\n\t\t\t\tgridSize: 32,\r\n\t\t\t\tclusterDisableClickZoom: true,\r\n\t\t\t})\r\n\r\n\t\t\t// Добавим элемент управления FullscreenControl на карту, чтобы управлять им снаружи карты\r\n\t\t\tvar fullscreenControl = new ymaps.control.FullscreenControl();\r\n\t\t\tmapObject.controls.add(fullscreenControl);\r\n\r\n\t\t\t// переведем карту в «полноэкранный режим» по внешнему переключателю\r\n\t\t\t$('.js-map-fullscreen').click(function () {\r\n\t\t\t\tfullscreenControl.enterFullscreen();\r\n\t\t\t})\r\n\r\n\t\t\t// стилизация меток на карте\r\n\t\t\tobjectManager.objects.options.set('iconLayout', 'default#image');\r\n\t\t\tobjectManager.objects.options.set('iconImageHref', 'img/location--blue.svg');\r\n\t\t\tobjectManager.objects.options.set('iconImageSize', [34, 42]);\r\n\t\t\tobjectManager.objects.options.set('iconImageOffset', [-17, -42]);\r\n\t\t\t// objectManager.objects.options.set('openBalloonOnClick', false);\r\n\t\t\t// objectManager.objects.options.set('hideIconOnBalloonOpen', false);\r\n\r\n\t\t\t// контент для метки кластера\r\n\t\t\tvar MyIconContentLayout = ymaps.templateLayoutFactory.createClass(\r\n\t\t\t\t'<div style=\"color: #ffffff; font-weight: bold; font-size: 17px;\">{{ properties.geoObjects.length }}</div>'\r\n\t\t\t);\r\n\t\t\t// стилизация метки кластера\r\n\t\t\tobjectManager.clusters.options.set({\r\n\t\t\t\tclusterIcons: [{\r\n\t\t\t\t\thref: 'img/map-cluster.svg',\r\n\t\t\t\t\tcolor: '#fff',\r\n\t\t\t\t\tsize: [45, 45],\r\n\t\t\t\t\toffset: [-22, -22],\r\n\t\t\t\t}],\r\n\t\t\t\tclusterIconContentLayout: MyIconContentLayout,\r\n\t\t\t\t// высота балуна кластера\r\n\t\t\t\tballoonContentLayoutHeight: 360,\r\n\t\t\t});\r\n\r\n\t\t\t// обработка события открытия баллуна метки\r\n\t\t\tobjectManager.objects.events.add(['balloonopen', 'redraw'], function (e, a) {\r\n\t\t\t});\r\n\r\n\t\t\t// обработка события открытия баллуна кластера\r\n\t\t\tobjectManager.clusters.events.add(['balloonopen', 'redraw'], function (e) {\r\n\t\t\t});\r\n\r\n\t\t\t// обработка события клика по метке на карте\r\n\t\t\tobjectManager.objects.events.add('click', function (e) {\r\n\t\t\t\tvar pmId = e.get('objectId');\r\n\t\t\t\tvar placemark = objectManager.objects.getById(pmId);\r\n\r\n\t\t\t\t// установка новой метки активной и сброс предыдущей\r\n\t\t\t\tsetCurrenMark(pmId)\r\n\t\t\t\tresetPrevMark(pmId)\r\n\r\n\t\t\t\t// получение данных из метки карты\r\n\t\t\t\tconsole.log(placemark.properties.balloonContent)\r\n\t\t\t});\r\n\r\n\t\t\t// переменная для хранения ID предыдущей кликнутой метки\r\n\t\t\tvar prevMarkId = ''\r\n\r\n\t\t\t// сброс метки карты на не выбранную\r\n\t\t\tfunction resetPrevMark(prevId) {\r\n\t\t\t\t// если предыдущая метка уже задана\r\n\t\t\t\tif (typeof prevMarkId == 'number') {\r\n\t\t\t\t\tvar prevMarker = objectManager.objects.getById(prevMarkId)\r\n\r\n\t\t\t\t\t// путь к иконке метки карты (пустой или полной)\r\n\t\t\t\t\tvar icon = 'img/icon__map--empty.svg'\r\n\t\t\t\t\tif (prevMarker.properties.balloonContent) {\r\n\t\t\t\t\t\ticon = 'img/icon__map--full.svg'\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// сброс параметров метки на не выбранную\r\n\t\t\t\t\tobjectManager.objects.setObjectOptions(prevMarkId, {\r\n\t\t\t\t\t\ticonImageSize: [46, 77],\r\n\t\t\t\t\t\ticonImageOffset: [-23, -65],\r\n\t\t\t\t\t\ticonImageHref: icon,\r\n\t\t\t\t\t});\r\n\t\t\t\t\tprevMarkId = prevId\r\n\t\t\t\t} else {\r\n\t\t\t\t\tprevMarkId = prevId\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// установка красной метки на выбранную метку карты\r\n\t\t\tfunction setCurrenMark(markId) {\r\n\t\t\t\t// установка параметров\r\n\t\t\t\tobjectManager.objects.setObjectOptions(markId, {\r\n\t\t\t\t\ticonImageSize: [68, 94],\r\n\t\t\t\t\ticonImageOffset: [-34, -85],\r\n\t\t\t\t\ticonImageHref: 'img/icon__map--mark.svg',\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// удалить все метки на карте\r\n\t\t\t// mapObject.geoObjects.removeAll();\r\n\r\n\t\t\t// Загружаем GeoJSON файл с описанием объектов.\r\n\t\t\t$.getJSON(pathJsonMultiCustom)\r\n\t\t\t\t.done(function (response) {\r\n\t\t\t\t\t// Добавляем описание объектов в формате JSON в менеджер объектов.\r\n\t\t\t\t\tobjectManager.add(response);\r\n\t\t\t\t\t// Добавляем объекты на карту.\r\n\t\t\t\t\tmapObject.geoObjects.add(objectManager);\r\n\r\n\t\t\t\t\t// устанавливаем нужный центр и зум карты, чтобы было видно все метки и задаем нужный отступ меток от края карты\r\n\t\t\t\t\tmapObject.setBounds(mapObject.geoObjects.getBounds(), {checkZoomRange: true, zoomMargin: 50})\r\n\t\t\t\t\t\t.then(function () {\r\n\t\t\t\t\t\t\t//после установки проверяем зум и не даем выйти за рамки нужного\r\n\t\t\t\t\t\t\tif (mapObject.getZoom() > 15) mapObject.setZoom(15);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\t.fail(function (response) {\r\n\t\t\t\t\tconsole.warn('offer: ajax load failed', response)\r\n\t\t\t\t})\r\n\t\t})\r\n\r\n\t\t// карта с перетаскиваемой меткой и полем для ввода и вывода адреса\r\n\t\t$('#ymaps-with-input').each(function () {\r\n\t\t\tvar mapItem = $(this)\r\n\t\t\tvar mapObject = new ymaps.Map(mapItem[0], {\r\n\t\t\t\tcenter: [38.563013, 68.810380],\r\n\t\t\t\tcontrols: ['geolocationControl', 'fullscreenControl', 'zoomControl'],\r\n\t\t\t\tzoom: 17,\r\n\t\t\t}, {\r\n\t\t\t\tsearchControlProvider: 'yandex#search'\r\n\t\t\t})\r\n\r\n\t\t\t// Создание метки.\r\n\t\t\tvar myPlacemark = new ymaps.Placemark(mapObject.getCenter(), {\r\n\t\t\t\t// iconCaption: 'поиск...'\r\n\t\t\t}, {\r\n\t\t\t\ticonLayout: 'default#image',\r\n\t\t\t\ticonImageHref: 'img/location.svg',\r\n\t\t\t\ticonImageSize: [62, 87],\r\n\t\t\t\ticonImageOffset: [-31, -87],\r\n\t\t\t\tdraggable: true,\r\n\t\t\t});\r\n\t\t\tmapObject.geoObjects.add(myPlacemark);\r\n\r\n\t\t\t// Слушаем событие окончания перетаскивания на метке.\r\n\t\t\tmyPlacemark.events.add('dragend', function () {\r\n\t\t\t\tgetAddress(myPlacemark.geometry.getCoordinates());\r\n\t\t\t});\r\n\r\n\t\t\t// Слушаем клик на карте.\r\n\t\t\tmapObject.events.add('click', function (e) {\r\n\t\t\t\tvar coords = e.get('coords');\r\n\r\n\t\t\t\t// передвигаем метку.\r\n\t\t\t\tmyPlacemark.geometry.setCoordinates(coords);\r\n\t\t\t\tgetAddress(coords);\r\n\t\t\t});\r\n\r\n\t\t\t// поля ввода и вывода адреса\r\n\t\t\tlet locationInput = $('#location-input')\r\n\t\t\t// сообщение об ошибке\r\n\t\t\tvar notice = $('#notice')\r\n\r\n\t\t\t// Определяем адрес по координатам (обратное геокодирование).\r\n\t\t\tfunction getAddress(coords) {\r\n\t\t\t\tymaps.geocode(coords).then(function (res) {\r\n\t\t\t\t\tvar firstGeoObject = res.geoObjects.get(0);\r\n\t\t\t\t\t// вставляем адресс в поле вывода адреса\r\n\t\t\t\t\tlocationInput.attr('value', firstGeoObject.getAddressLine()).val(firstGeoObject.getAddressLine())\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Подключаем поисковые подсказки к полю ввода.\r\n\t\t\tvar suggestView = new ymaps.SuggestView('location-input')\r\n\r\n\t\t\t// При клике по кнопке запускаем верификацию введёных данных.\r\n\t\t\t$('#btn-search').on('click.searchLocation', function (e) {\r\n\t\t\t\tgeocode();\r\n\t\t\t});\r\n\r\n\t\t\tfunction geocode() {\r\n\t\t\t\t// Забираем запрос из поля ввода.\r\n\t\t\t\tvar request = locationInput.val();\r\n\t\t\t\t// Геокодируем введённые данные.\r\n\t\t\t\tymaps.geocode(request).then(function (res) {\r\n\t\t\t\t\tvar obj = res.geoObjects.get(0),\r\n\t\t\t\t\t\terror;\r\n\r\n\t\t\t\t\t// Об оценке точности ответа геокодера\r\n\t\t\t\t\tif (obj) {\r\n\t\t\t\t\t\tswitch (obj.properties.get('metaDataProperty.GeocoderMetaData.precision')) {\r\n\t\t\t\t\t\t\tcase 'exact':\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'number':\r\n\t\t\t\t\t\t\tcase 'near':\r\n\t\t\t\t\t\t\tcase 'range':\r\n\t\t\t\t\t\t\t\terror = 'Неточный адрес, уточните номер дома';\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'street':\r\n\t\t\t\t\t\t\t\terror = 'Неполный адрес, уточните номер дома';\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'other':\r\n\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\terror = 'Неточный адрес, требуется уточнение';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\terror = 'Адрес не найден';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Если геокодер возвращает пустой массив или неточный результат, то показываем ошибку.\r\n\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\tshowError(error);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tshowResult(obj);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, function (e) {\r\n\t\t\t\t\tconsole.log(e)\r\n\t\t\t\t})\r\n\r\n\t\t\t\tfunction showResult(obj) {\r\n\t\t\t\t\t// Удаляем сообщение об ошибке, если найденный адрес совпадает с поисковым запросом.\r\n\t\t\t\t\tnotice.css('display', 'none');\r\n\r\n\t\t\t\t\tvar mapItem = $('#ymaps-with-input')\r\n\t\t\t\t\tvar bounds = obj.properties.get('boundedBy')\r\n\t\t\t\t\t// Рассчитываем видимую область для текущего положения пользователя.\r\n\t\t\t\t\tvar mapState = ymaps.util.bounds.getCenterAndZoom(\r\n\t\t\t\t\t\tbounds,\r\n\t\t\t\t\t\t[mapItem.width(), mapItem.height()]\r\n\t\t\t\t\t)\r\n\t\t\t\t\t// Убираем контролы с карты.\r\n\t\t\t\t\tmapState.controls = [];\r\n\t\t\t\t\t// Передвигаем метку по найденным координатам\r\n\t\t\t\t\tsetPlacemarkCoords(mapState);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction showError(message) {\r\n\t\t\t\t\tnotice.text(message).css('display', 'block');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction setPlacemarkCoords(state) {\r\n\t\t\t\t\t// выставляем новый центр карты и меняем позицию метки в соответствии с найденным адресом.\r\n\t\t\t\t\tmapObject.setCenter(state.center, state.zoom + 2);\r\n\t\t\t\t\tmyPlacemark.geometry.setCoordinates(state.center);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t// карта с получением страны и города при загрузке и по клику на карте\r\n\t\t$('#ymaps-country-city').each(function () {\r\n\t\t\tvar mapItem = $(this)\r\n\t\t\tvar geolocation = ymaps.geolocation;\r\n\t\t\tvar myPlacemark = null\r\n\t\t\tvar geoCountry = null\r\n\t\t\tvar geoCity = null\r\n\t\t\tvar countryOutput = $('#get-country')\r\n\t\t\tvar cityOutput = $('#get-city')\r\n\r\n\t\t\tvar mapObject = new ymaps.Map(mapItem[0], {\r\n\t\t\t\tcenter: [55.76, 37.64],\r\n\t\t\t\tzoom: 10\r\n\t\t\t}, {\r\n\t\t\t\tsearchControlProvider: 'yandex#search'\r\n\t\t\t});\r\n\r\n\t\t\tgeolocation.get({\r\n\t\t\t\tprovider: 'auto',\r\n\t\t\t\tautoReverseGeocode: true,\r\n\t\t\t\t// Карта автоматически отцентрируется по положению пользователя.\r\n\t\t\t\tmapStateAutoApply: true\r\n\t\t\t}).then(function (result) {\r\n\t\t\t\tmyPlacemark = result.geoObjects.get(0)\r\n\t\t\t\tgeoCountry = myPlacemark.getCountry()\r\n\t\t\t\tgeoCity = myPlacemark.getLocalities()[0]\r\n\r\n\t\t\t\t// вставляем адресс в поле вывода адреса\r\n\t\t\t\tsetCityValue()\r\n\t\t\t\tsetCountryValue()\r\n\r\n\t\t\t\tmapObject.geoObjects.add(result.geoObjects)\r\n\r\n\t\t\t\t// клик по карте\r\n\t\t\t\tmapObject.events.add('click', function (e) {\r\n\t\t\t\t\tvar coords = e.get('coords');\r\n\r\n\t\t\t\t\t// передвигаем метку.\r\n\t\t\t\t\tmyPlacemark.geometry.setCoordinates(coords);\r\n\t\t\t\t\tgetAddress(coords);\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t\t.catch(function (error) {\r\n\t\t\t\t\tconsole.log('map api error', error)\r\n\t\t\t\t})\r\n\r\n\t\t\t// Определяем адрес по координатам (обратное геокодирование).\r\n\t\t\tfunction getAddress(coords) {\r\n\t\t\t\tymaps.geocode(coords).then(function (res) {\r\n\t\t\t\t\tvar firstGeoObject = res.geoObjects.get(0);\r\n\t\t\t\t\tgeoCountry = firstGeoObject.getCountry()\r\n\t\t\t\t\tgeoCity = firstGeoObject.getLocalities()[0]\r\n\r\n\t\t\t\t\t// вставляем адресс в поле вывода адреса\r\n\t\t\t\t\tsetCityValue()\r\n\t\t\t\t\tsetCountryValue()\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// установка значения страны\r\n\t\t\tfunction setCountryValue() {\r\n\t\t\t\tcountryOutput.val(geoCountry)\r\n\t\t\t}\r\n\r\n\t\t\t// установка значения города\r\n\t\t\tfunction setCityValue() {\r\n\t\t\t\tcityOutput.val(geoCity)\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t// карта с получением страны и города при загрузке и по клику на карте\r\n\t\t$('#ymaps-near-point').each(function () {\r\n\t\t\tvar mapItem = $(this)\r\n\t\t\tvar geolocation = ymaps.geolocation;\r\n\t\t\tvar loadedPlacemarks = null\r\n\t\t\tvar userPosition = null\r\n\t\t\t// путь к JSON файлу с данными для карты\r\n\t\t\tvar pathJsonMulti = mapItem.data('json-path')\r\n\r\n\t\t\tvar mapObject = new ymaps.Map(mapItem[0], {\r\n\t\t\t\tcenter: [55.73, 37.75],\r\n\t\t\t\tzoom: 12\r\n\t\t\t}, {\r\n\t\t\t\tsearchControlProvider: 'yandex#search'\r\n\t\t\t});\r\n\r\n\t\t\t// Загружаем GeoJSON файл с описанием объектов.\r\n\t\t\t$.getJSON(pathJsonMulti)\r\n\t\t\t\t.done(function (response) {\r\n\t\t\t\t\t// Добавляем описание объектов в формате JSON в геообъекты с помощью ymaps.geoQuery и Добавляем объекты на карту.\r\n\t\t\t\t\tloadedPlacemarks = ymaps.geoQuery(response).addToMap(mapObject);\r\n\r\n\t\t\t\t\t// устанавливаем нужный центр и зум карты, чтобы было видно все метки и задаем нужный отступ меток от края карты\r\n\t\t\t\t\tmapObject.setBounds(mapObject.geoObjects.getBounds(), {checkZoomRange: true, zoomMargin: 50})\r\n\t\t\t\t\t\t.then(function () {\r\n\t\t\t\t\t\t\t//после установки проверяем зум и не даем выйти за рамки нужного\r\n\t\t\t\t\t\t\tif (mapObject.getZoom() > 15) mapObject.setZoom(15);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\t.fail(function (response) {\r\n\t\t\t\t\tconsole.warn('map: ajax load failed', response)\r\n\t\t\t\t})\r\n\r\n\t\t\tgeolocation.get({\r\n\t\t\t\tprovider: 'auto',\r\n\t\t\t\tautoReverseGeocode: true,\r\n\t\t\t\t// Карта автоматически отцентрируется по положению пользователя.\r\n\t\t\t\tmapStateAutoApply: true\r\n\t\t\t}).then(function (result) {\r\n\t\t\t\t// центруем карту на положении пользователя\r\n\t\t\t\t// mapObject.setCenter(result.geoObjects.position)\r\n\r\n\t\t\t\t// С помощью обратного геокодирования найдем местоположение пользователя по его координатам\r\n\t\t\t\tuserPosition = ymaps.geoQuery(ymaps.geocode(result.geoObjects.position, {kind: 'locality'}))\r\n\t\t\t\t\t// Нужно дождаться ответа от сервера и только потом обрабатывать полученные результаты.\r\n\t\t\t\t\t.then(function (res) {\r\n\t\t\t\t\t\t// findClosestObjects(userPosition.get(0))\r\n\t\t\t\t\t\t// клик по карте\r\n\t\t\t\t\t\tmapObject.events.add('click', function (event) {\r\n\t\t\t\t\t\t\tfindClosestObjects(event.get('coords'))\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t\t.catch(function (error) {\r\n\t\t\t\t\tconsole.log('map api error', error)\r\n\t\t\t\t})\r\n\r\n\t\t\t// поиск ближайшей метки к указанной точке и обработка\r\n\t\t\tfunction findClosestObjects(coords) {\r\n\t\t\t\tvar nearPoint = loadedPlacemarks.getClosestTo(coords)\r\n\r\n\t\t\t\tnearPoint.balloon.open();\r\n\t\t\t\t// установка центра карты на ближайшей метке\r\n\t\t\t\tmapObject.setCenter(nearPoint.geometry.getCoordinates())\r\n\t\t\t}\r\n\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// инициализация tooltip\r\nfunction initTooltip() {\r\n\tif ($.fn.tooltipster) {\r\n\t\t$('.js-tooltip').tooltipster({\r\n\t\t\t// «top», «bottom», «left», «right». Это также может быть массив ['top', 'bottom', 'right', 'left']\r\n\t\t\tside: ['left', 'bottom'],\r\n\t\t\t// trigger: 'click',\r\n\t\t\t// возможность взаимодействовать с содержимим всплывашки\r\n\t\t\tinteractive: true,\r\n\t\t\ttheme: 'tooltipster-shadow',\r\n\t\t\t// отступ от переключателя\r\n\t\t\tdistance: 10,\r\n\t\t\t// минимальный отступ от выступающего треугольника от края\r\n\t\t\tminIntersection: 10,\r\n\t\t\tminWidth: 200,\r\n\t\t\tmaxWidth: 300,\r\n\t\t\t// Перемещает всплывающую подсказку, если она выходит из области просмотра, когда пользователь прокручивает страницу, чтобы она оставалась видимой как можно дольше.\r\n\t\t\trepositionOnScroll: true,\r\n\t\t\tzIndex: 10,\r\n\t\t\t//  \t'fade', 'grow', 'swing', 'slide', 'fall'\r\n\t\t\t// animation: 'fall',\r\n\t\t});\r\n\t}\r\n}\r\n\r\n// баннер-меню с переключающимися фонами, заголовками и кнопками\r\nfunction initBannerMenu() {\r\n\t$('.js-banner-menu').each(function () {\r\n\t\tvar parent = $(this)\r\n\t\tvar defaultBackground = parent.attr('data-bg-src')\r\n\t\tvar defaultTitle = parent.attr('data-title')\r\n\t\tvar backgroundBlock = parent.find('.js-banner-menu__bg')\r\n\t\tvar title = parent.find('.js-banner-menu__title')\r\n\t\tvar togglerReset = parent.find('.js-banner-menu__reset')\r\n\t\tvar togglers = parent.find('.js-banner-menu__toggler')\r\n\t\tvar togglersClick = parent.find('.js-banner-menu__clicker')\r\n\t\tvar buttons = parent.find('.js-banner-menu__buttons')\r\n\t\tvar timeout = null\r\n\r\n\t\t// init\r\n\t\tparent.prop('currentBg', defaultBackground)\r\n\r\n\t\t// toggler reset click\r\n\t\ttogglerReset.off('click.toggleBannerMenu').on('click.toggleBannerMenu', function (event) {\r\n\t\t\tevent.preventDefault()\r\n\r\n\t\t\ttoggleButtons($(this).attr('data-buttons-id'))\r\n\t\t\tsetDefault()\r\n\r\n\t\t\ttogglers.off('mouseout.toggleBannerMenu').on('mouseout.toggleBannerMenu', setDefault)\r\n\t\t})\r\n\r\n\t\t// toggler click\r\n\t\ttogglersClick.off('click.toggleBannerMenu').on('click.toggleBannerMenu', function (event) {\r\n\t\t\tevent.preventDefault()\r\n\t\t\tvar toggler = $(this)\r\n\r\n\t\t\ttoggleButtons(toggler.attr('data-buttons-id'))\r\n\t\t\tsetCurrent(event)\r\n\r\n\t\t\tparent.addClass('second-level')\r\n\t\t\ttoggler.off('mouseout.toggleBannerMenu', setDefault)\r\n\t\t})\r\n\r\n\t\t// toggler mouse in\r\n\t\ttogglers.off('mouseover.toggleBannerMenu').on('mouseover.toggleBannerMenu', setCurrent)\r\n\r\n\t\t// toggler mouse out\r\n\t\ttogglers.off('mouseout.toggleBannerMenu').on('mouseout.toggleBannerMenu', setDefault)\r\n\r\n\t\t// toggle buttons\r\n\t\tfunction toggleButtons(id) {\r\n\t\t\tbuttons.each(function () {\r\n\t\t\t\tvar currentButtons = $(this)\r\n\r\n\t\t\t\tif (currentButtons.attr('data-id') == id) {\r\n\t\t\t\t\tcurrentButtons.addClass('active')\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcurrentButtons.removeClass('active')\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\t// set background image for parent\r\n\t\tfunction setBg(imageSrc) {\r\n\t\t\tif (parent.prop('currentBg') != imageSrc) {\r\n\t\t\t\tparent.prop('currentBg', imageSrc)\r\n\r\n\t\t\t\tif (backgroundBlock.eq(0).hasClass('active-bg')) {\r\n\t\t\t\t\tbackgroundBlock.eq(1).css('background-image', 'url(\"' + imageSrc + '\")')\r\n\t\t\t\t\tbackgroundBlock.eq(1).addClass('active-bg')\r\n\t\t\t\t\tbackgroundBlock.eq(0).removeClass('active-bg')\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbackgroundBlock.eq(0).css('background-image', 'url(\"' + imageSrc + '\")')\r\n\t\t\t\t\tbackgroundBlock.eq(0).addClass('active-bg')\r\n\t\t\t\t\tbackgroundBlock.eq(1).removeClass('active-bg')\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// set title for parent\r\n\t\tfunction setTitle(titleText) {\r\n\t\t\ttitle.text(titleText)\r\n\t\t}\r\n\r\n\t\t// set current bg and title\r\n\t\tfunction setCurrent(event) {\r\n\t\t\tvar toggler = $(event.target)\r\n\t\t\tvar togglerBackground = toggler.attr('data-bg-src')\r\n\t\t\tvar togglerTitle = toggler.attr('data-title')\r\n\r\n\t\t\tclearTimeout(timeout)\r\n\t\t\tsetBg(togglerBackground)\r\n\t\t\tsetTitle(togglerTitle)\r\n\t\t}\r\n\r\n\t\t// set default bg and title\r\n\t\tfunction setDefault() {\r\n\t\t\ttimeout = setTimeout(function () {\r\n\t\t\t\tsetBg(defaultBackground)\r\n\t\t\t\tsetTitle(defaultTitle)\r\n\t\t\t\tparent.removeClass('second-level')\r\n\t\t\t}, 400)\r\n\t\t}\r\n\t})\r\n}\r\n\r\n// загрузка фотографий на мобильном при создании объявления\r\nfunction uploadPhotos() {\r\n\t$('.js-upload-photos').each(function () {\r\n\t\tvar parent = $(this)\r\n\t\tvar buttons = parent.find('.js-upload-photos__btn')\r\n\t\t// контейнер для добавленных полей фото\r\n\t\tvar containerForPhotos = parent.find('.js-upload-photos__files')\r\n\t\tvar maxCountPhotos = parseInt(containerForPhotos.data('maxCountPhotos')) || 5\r\n\r\n\t\t// добавляем поле для фото из камеры но не больше 8 штук\r\n\t\tbuttons.each(function () {\r\n\t\t\tvar btn = $(this)\r\n\t\t\tvar typeBtn = btn.attr('data-type')\r\n\t\t\tvar inputForPhoto = null\r\n\r\n\t\t\t// тип поля для выбора фото (камера или галерея)\r\n\t\t\tif (typeBtn == 'camera') {\r\n\t\t\t\tinputForPhoto = $('<input class=\"js-upload-photos__input\" type=\"file\" accept=\"image/*\" capture=\"camera\">')\r\n\t\t\t} else if (typeBtn == 'gallery') {\r\n\t\t\t\tinputForPhoto = $('<input class=\"js-upload-photos__input\" type=\"file\">')\r\n\t\t\t}\r\n\r\n\t\t\t// добавление фоток если возможно\r\n\t\t\tbtn.off('click.getPhotoCamera').on('click.getPhotoCamera', function () {\r\n\t\t\t\tif (!buttons.hasClass('disabled')) {\r\n\t\t\t\t\taddPhoto(containerForPhotos, inputForPhoto)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n\r\n\t\t// перекление блокировки кнопок выбора фото\r\n\t\tcontainerForPhotos.off('refreshItemsCount').on('refreshItemsCount', function () {\r\n\t\t\tvar photoItems = containerForPhotos.find('.js-upload-photos__item')\r\n\r\n\t\t\t// если выбрано максимальное количество фоток заданное в атрибуте контейнере\r\n\t\t\tif (photoItems.length >= maxCountPhotos) {\r\n\t\t\t\t// навесить блокировку\r\n\t\t\t\tbuttons.addClass('disabled')\r\n\r\n\t\t\t\tphotoItems.on('removeItem', function () {\r\n\t\t\t\t\tbuttons.removeClass('disabled')\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\t// снять блокировку\r\n\t\t\t\tbuttons.removeClass('disabled')\r\n\r\n\t\t\t\tphotoItems.off('removeItem')\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\r\n\t// выбрать фото и вставить в контейнер\r\n\tfunction addPhoto(container, input) {\r\n\t\tvar label = $('<div>').addClass('upload-photos__file js-upload-photos__item js-remove')\r\n\t\tvar span = $('<span>')\r\n\t\tvar close = $('<i>').addClass('icon-close js-remove__btn')\r\n\r\n\t\t// отслеживание события выбора фото и его вставка в контейнер\r\n\t\tinput.off('change.getPhotoCamera').on('change.getPhotoCamera', function (event) {\r\n\t\t\tspan.text(event.target.files[0].name)\r\n\t\t\tlabel.append(input).append(span).append(close)\r\n\t\t\tcontainer.append(label).trigger('refreshItemsCount')\r\n\t\t})\r\n\r\n\t\t// инициируем клик по созданному полю для фото\r\n\t\tinput.click()\r\n\t}\r\n}\r\n\r\n// выбор и зброс файлов для загрузки на десктопе\r\nfunction uploadFiles() {\r\n\t$('.js-upload-files').each(function () {\r\n\t\tvar parent = $(this)\r\n\t\tvar input = parent.find('.js-upload-files__input')\r\n\t\tvar nameFile = parent.find('.js-upload-files__name')\r\n\r\n\t\t// отслеживание события выбора файла и вставка его имени\r\n\t\tinput.off('change.uploadFiles').on('change.uploadFiles', function (event) {\r\n\t\t\tnameFile.text(event.target.files[0].name)\r\n\t\t\tparent.addClass('selected-file')\r\n\t\t})\r\n\r\n\t\t// сброс выбранного файла\r\n\t\tparent.find('.js-upload-files__delete').off('click.uploadFileReset').on('click.uploadFileReset', function (event) {\r\n\t\t\tparent.removeClass('selected-file')\r\n\t\t\tinput.val('')\r\n\t\t\tnameFile.text('')\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// анимация появления блоков при прокрутке\r\nfunction animateScroll(blockSelector, cssClass) {\r\n\t$('body').addClass('script-on')\r\n\tvar sections = $(blockSelector)\r\n\tvar win = $(window)\r\n\r\n\tfunction setAnimateClass() {\r\n\t\tsections.each(function () {\r\n\t\t\tvar _this = $(this)\r\n\t\t\tif (_this.offset().top < win.height() + win.scrollTop() - 50) {\r\n\t\t\t\t_this.addClass(cssClass)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\twin.off('scroll.animateScroll').on('scroll.animateScroll', setAnimateClass).trigger('scroll.animateScroll')\r\n}\r\n\r\n// поле номера с селектом кода страны\r\nfunction internationalPhone() {\r\n\tvar countryMaskArr = {\r\n\t\tru: '+7 (999) 999-99-99',\r\n\t\tby: '+375 (99) 999-99-99',\r\n\t\tkz: '+7 (999) 999-99-99',\r\n\t\tua: '+380 (99) 999-99-99'\r\n\t}\r\n\r\n\t$('.js-international-phone').each(function () {\r\n\t\tvar telInput = $(this)\r\n\t\tvar label = telInput.closest('label')\r\n\r\n\t\tvar iti = window.intlTelInput(telInput[0], {\r\n\t\t\tinitialCountry: 'auto',\r\n\t\t\tgeoIpLookup: function (callback) {\r\n\t\t\t\t$.get('http://ip-api.com/json/', function (resp) {\r\n\t\t\t\t\tvar countryCode = (resp && resp.countryCode) ? resp.countryCode : '';\r\n\t\t\t\t\tcallback(countryCode);\r\n\t\t\t\t}, 'jsonp')\r\n\t\t\t},\r\n\t\t\tnationalMode: false,\r\n\t\t\tonlyCountries: ['ru', 'by', 'kz', 'ua'],\r\n\t\t\tutilsScript: telInput.data('utilPath')\r\n\t\t});\r\n\r\n\t\ttelInput.on('countrychange', function () {\r\n\t\t\tvar countryKey = iti.getSelectedCountryData().iso2\r\n\r\n\t\t\tif (countryKey) {\r\n\t\t\t\ttelInput.blur()\r\n\t\t\t\ttelInput.val('')\r\n\t\t\t\ttelInput.mask(countryMaskArr[countryKey])\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\ttelInput.off('focus.intlTelInput').on('focus.intlTelInput', function () {\r\n\t\t\tlabel.addClass('focus')\r\n\t\t})\r\n\t\ttelInput.off('blur.intlTelInput').on('blur.intlTelInput', function () {\r\n\t\t\tlabel.removeClass('focus')\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// перетаскивание блоков\r\nfunction sortableBlocks() {\r\n\tif (window.Sortable) {\r\n\t\t$('.js-sortable').each(function () {\r\n\t\t\tvar parent = $(this)\r\n\r\n\t\t\tnew Sortable(parent[0], {\r\n\t\t\t\tanimation: 150,\r\n\t\t\t\t// класс добавляемый при перетаскивании\r\n\t\t\t\tghostClass: 'active-drag',\r\n\t\t\t\t// элемент для перетескавания блока (опционально)\r\n\t\t\t\thandle: '.js-sortable__toggler',\r\n\t\t\t});\r\n\t\t})\r\n\t}\r\n}\r\n\r\n// анимация чисел\r\nfunction animateDigits() {\r\n\tif ($.fn.spincrement) {\r\n\t\tvar win = $(window)\r\n\r\n\t\twin.off('scroll.animateDigits').on('scroll.animateDigits', animateDigits)\r\n\t\twin.trigger('scroll.animateDigits')\r\n\r\n\t\tfunction animateDigits() {\r\n\t\t\t$('.js-animate-digits').each(function () {\r\n\t\t\t\tvar _this = $(this)\r\n\r\n\t\t\t\tif (_this.offset().top < win.height() + win.scrollTop() - 50 && !_this.hasClass('animated')) {\r\n\t\t\t\t\t// защита от повторной анимации\r\n\t\t\t\t\t_this.addClass('animated')\r\n\r\n\t\t\t\t\t// фиксация ширины во время анимации\r\n\t\t\t\t\tvar width = _this.outerWidth()\r\n\t\t\t\t\t_this.css({display: 'inline-block', width: width, whiteSpace: 'nowrap'})\r\n\r\n\t\t\t\t\t// инициализация анимации\r\n\t\t\t\t\t_this.spincrement({\r\n\t\t\t\t\t\tthousandSeparator: ' ',\r\n\t\t\t\t\t\tduration: 2000,\r\n\t\t\t\t\t\tto: parseInt(_this.text().replace(/\\s/, '')),\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\t// сбросс ширины\r\n\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t_this.removeAttr('style')\r\n\t\t\t\t\t}, 3000)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// таблица на дивах с html структурой колонок\r\nfunction tableWithColumns() {\r\n\t$('.js-table').each(function () {\r\n\t\tvar columns = $(this).find('.js-table__column')\r\n\t\tvar cellsHeight = []\r\n\t\tvar timeout = null\r\n\r\n\t\t// расчет высоты ячеек\r\n\t\tfunction calcHeightCels() {\r\n\t\t\t// сброс массива максимальный высот ячеек в ряде\r\n\t\t\tcellsHeight.length = 0\r\n\r\n\t\t\t// получение высот ячеек и запись максимальный в массив\r\n\t\t\tcolumns.each(function () {\r\n\t\t\t\t$(this).find('.js-table__cell').each(function (index) {\r\n\t\t\t\t\tvar height = $(this).removeAttr('style').outerHeight()\r\n\t\t\t\t\tif (!cellsHeight[index] || cellsHeight[index] < height) {\r\n\t\t\t\t\t\tcellsHeight[index] = height\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\t\t\t// установка максимальных высот ячеек из массива\r\n\t\t\tcolumns.each(function () {\r\n\t\t\t\t$(this).find('.js-table__cell').each(function (index) {\r\n\t\t\t\t\t$(this).css({minHeight: cellsHeight[index]})\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\t$(window).off('resize.calcHeightCels').on('resize.calcHeightCels', function () {\r\n\t\t\tclearTimeout(timeout)\r\n\t\t\ttimeout = setTimeout(calcHeightCels, 300)\r\n\t\t}).trigger('resize.calcHeightCels')\r\n\t})\r\n}\r\n\r\n// аякс подгрузка разметки в блок\r\nfunction ajaxLoad() {\r\n\tvar body = $('body')\r\n\t$('.js-ajax-load').each(function () {\r\n\t\tvar parent = $(this)\r\n\t\tvar url = parent.data('ajaxUrl')\r\n\t\tvar content = parent.find('.js-ajax-load__content')\r\n\t\tvar preloader = $('<div>').addClass('icon-preloader')\r\n\r\n\t\tparent.find('.js-ajax-load__toggler').off('click.ajaxLoad').on('click.ajaxLoad', function (event) {\r\n\t\t\tevent.preventDefault()\r\n\t\t\tbody.append(preloader)\r\n\t\t\t$.get(url)\r\n\t\t\t\t.done(function (response) {\r\n\t\t\t\t\tcontent.append(response)\r\n\t\t\t\t\tparent.addClass('loaded')\r\n\t\t\t\t\tpreloader.remove()\r\n\t\t\t\t})\r\n\t\t\t\t.fail(function (response) {\r\n\t\t\t\t\tpreloader.remove()\r\n\t\t\t\t\tconsole.warn('offer: ajax load failed', response)\r\n\t\t\t\t})\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// инициализация печатного placeholder у поля\r\nfunction initInputWriter() {\r\n\tif (window.Typewriter) {\r\n\t\t$('.js-writer').each(function () {\r\n\t\t\tconst field = $(this)\r\n\t\t\tconst input = field.find('.js-writer__input')\r\n\r\n\t\t\t// переключение видимости анимации ввода текста\r\n\t\t\tinput.off('focus.writer').on('focus.writer', function () {\r\n\t\t\t\tfield.removeClass('show-writer')\r\n\t\t\t})\r\n\t\t\tinput.off('blur.writer').on('blur.writer', function () {\r\n\t\t\t\tif (!$(this).val().length) field.addClass('show-writer')\r\n\t\t\t})\r\n\r\n\t\t\t// инициализация анимации ввода текста\r\n\t\t\tconst _this = field.find('.js-writer__text')\r\n\t\t\tnew Typewriter(_this[0], {\r\n\t\t\t\tstrings: [_this.data('writer')],\r\n\t\t\t\tautoStart: true,\r\n\t\t\t\tloop: true,\r\n\t\t\t});\r\n\t\t})\r\n\t}\r\n}\r\n\r\n// переключение по кнопке класса корневого html страницы\r\nfunction toggleClassPage() {\r\n\t$('.js-toggle-class-page').each(function () {\r\n\t\tvar _this = $(this)\r\n\t\tvar html = $('html')\r\n\r\n\t\t_this.off('click.toggleClassPage').on('click.toggleClassPage', function (e) {\r\n\t\t\te.preventDefault()\r\n\t\t\thtml.toggleClass(_this.data('class'))\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// прогресс бар\r\nfunction progressBar() {\r\n\t$('.js-progress').each(function () {\r\n\t\tvar _this = $(this)\r\n\t\tvar points = _this.find('.js-progress__point')\r\n\t\tvar timeout = null\r\n\r\n\t\tfunction setBarWidth() {\r\n\t\t\tvar start = points.first().position().left\r\n\t\t\tvar end = points.last().position().left\r\n\t\t\t_this.find('.js-progress__bar').width(end - start)\r\n\t\t}\r\n\r\n\t\t$(window).off('resize.setBarWidth').on('resize.setBarWidth', function () {\r\n\t\t\tclearTimeout(timeout);\r\n\t\t\ttimeout = setTimeout(setBarWidth, 300);\r\n\t\t}).trigger('resize.setBarWidth');\r\n\t})\r\n}\r\n\r\n// ползунок для ввода значений с полями\r\nfunction initRange() {\r\n\t$('.js-range').each(function () {\r\n\t\tvar _this = $(this)\r\n\t\tvar slider = _this.find('.js-range__slider');\r\n\t\tvar inputs = _this.find('.js-range__input');\r\n\r\n\t\t// инициализация слайдера\r\n\t\tnoUiSlider.create(slider[0], {\r\n\t\t\tstart: slider.data('value'),\r\n\t\t\tconnect: true,\r\n\t\t\ttooltips: [true, wNumb({decimals: 2})],\r\n\t\t\trange: {\r\n\t\t\t\t'min': slider.data('min'),\r\n\t\t\t\t'max': slider.data('max')\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// установка значений в поля из слайдера\r\n\t\tslider[0].noUiSlider.on('update', function (values, index) {\r\n\t\t\tinputs[index].value = Math.round(values[index])\r\n\t\t});\r\n\r\n\t\t// обработка ввода значений из полей\r\n\t\tinputs.each(function (index, input) {\r\n\t\t\tinput.addEventListener('change', function () {\r\n\t\t\t\tslider[0].noUiSlider.setHandle(index, this.value);\r\n\t\t\t});\r\n\r\n\t\t\tinput.addEventListener('keydown', function (e) {\r\n\t\t\t\tvar values = slider[0].noUiSlider.get();\r\n\t\t\t\tvar value = Number(values[index]);\r\n\r\n\t\t\t\t// [[handle0_down, handle0_up], [handle1_down, handle1_up]]\r\n\t\t\t\tvar steps = slider[0].noUiSlider.steps();\r\n\r\n\t\t\t\t// [down, up]\r\n\t\t\t\tvar step = steps[index];\r\n\r\n\t\t\t\tvar position;\r\n\r\n\t\t\t\t// обработка клика по кнопкам в полях 13 is enter, 38 is key up, 40 is key down.\r\n\t\t\t\tswitch (e.which) {\r\n\r\n\t\t\t\t\tcase 13:\r\n\t\t\t\t\t\tslider[0].noUiSlider.setHandle(index, this.value);\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 38:\r\n\r\n\t\t\t\t\t\t// Get step to go increase slider value (up)\r\n\t\t\t\t\t\tposition = step[1];\r\n\r\n\t\t\t\t\t\t// false = no step is set\r\n\t\t\t\t\t\tif (position === false) {\r\n\t\t\t\t\t\t\tposition = 1;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// null = edge of slider\r\n\t\t\t\t\t\tif (position !== null) {\r\n\t\t\t\t\t\t\tslider[0].noUiSlider.setHandle(index, value + position);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 40:\r\n\r\n\t\t\t\t\t\tposition = step[0];\r\n\r\n\t\t\t\t\t\tif (position === false) {\r\n\t\t\t\t\t\t\tposition = 1;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (position !== null) {\r\n\t\t\t\t\t\t\tslider[0].noUiSlider.setHandle(index, value - position);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t})\r\n}\r\n\r\n// запуск и остановка кастомного видео\r\nfunction toggleVideo() {\r\n\t$('.js-video').each(function () {\r\n\t\tconst parent = $(this)\r\n\t\tconst video = parent.find('.js-video__content')[0]\r\n\r\n\t\t// переключение состояния видео\r\n\t\tparent.find('.js-video__toggler').off('click.toggleVideo').on('click.toggleVideo', function () {\r\n\t\t\tif (video.paused) {\r\n\t\t\t\tvideo.play()\r\n\t\t\t} else {\r\n\t\t\t\tvideo.pause()\r\n\t\t\t}\r\n\t\t\tparent.addClass('play')\r\n\t\t})\r\n\r\n\t\t// смена кнопки при останове видео\r\n\t\tvideo.addEventListener('pause', stopVideo)\r\n\t\tvideo.addEventListener('ended', stopVideo)\r\n\r\n\t\tfunction stopVideo() {\r\n\t\t\tparent.removeClass('play')\r\n\t\t}\r\n\t})\r\n}\r\n\r\n// многоуровневое меню со скроллом по все уровням\r\nfunction menuWithScroll() {\r\n\t$('.js-menu-w-scroll').each(function () {\r\n\t\t// обработка клика по элементу\r\n\t\t$(this).off('mouseover.selectCategories').on('mouseover.selectCategories', '.js-menu-w-scroll__item', function (event) {\r\n\t\t\tevent.stopPropagation()\r\n\t\t\tconst listItem = $(this)\r\n\r\n\t\t\t// переключени состояния элемента для выбранной категории\r\n\t\t\tlistItem.siblings('.js-menu-w-scroll__item').removeClass('active')\r\n\t\t\tlistItem.addClass('active')\r\n\r\n\t\t\t// колонка родитель выбранного элемента\r\n\t\t\tconst parentColumn = listItem.closest('.js-menu-w-scroll__column')\r\n\t\t\t// очистка уровней ниже выбранного\r\n\t\t\tparentColumn.nextAll('.js-menu-w-scroll__column').find('.js-menu-w-scroll__item').removeClass('visible  active')\r\n\r\n\t\t\t// родитительский атрибут выбранной категории\r\n\t\t\tconst attrChildren = listItem.data('childrens') || false\r\n\t\t\t// элементы потомки для выбранной категории\r\n\t\t\tconst childrenItems = parentColumn.next('.js-menu-w-scroll__column').find('.js-menu-w-scroll__item')\r\n\t\t\t// переключени состояния элементов потомков для выбранной категории, если они указаны в атрибуте\r\n\t\t\tif (attrChildren) {\r\n\t\t\t\tchildrenItems.removeClass('visible').filter(`[data-parent=${attrChildren}]`).addClass('visible')\r\n\t\t\t} else {\r\n\t\t\t\tchildrenItems.removeClass('visible')\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// маска для полей ввода\r\nfunction maskInputs() {\r\n\tif ($.fn.inputmask) {\r\n\t\t$('.js-mask').each(function () {\r\n\t\t\tvar input = $(this)\r\n\t\t\tinput.inputmask(input.data('mask'), {'clearIncomplete': true})\r\n\t\t})\r\n\t}\r\n}\r\n\r\n// поведение попапов\r\nfunction initPopups() {\r\n\tif ($.fn.fancybox) {\r\n\t\tvar popups = $('[data-fancybox]')\r\n\t\tpopups.fancybox({\r\n\t\t\t// панель миниатюр\r\n\t\t\tthumbs: {\r\n\t\t\t\tautoStart: true\r\n\t\t\t},\r\n\t\t\t// переинициализация скриптов в попапе\r\n\t\t\tafterShow: function (instance, slide) {\r\n\t\t\t\t// View.initAllLocal(instance.current.$content)\r\n\t\t\t}\r\n\t\t});\r\n\t\t// закрыть попап по кнопке на всплатии\r\n\t\t$(document).off('click.closePopup').on('click.closePopup', '.js-close-popup', function () {\r\n\t\t\t$.fancybox.close();\r\n\t\t})\r\n\t}\r\n}\r\n\r\n// инпут с автокомплитом и мультивыбором (в виде тэгов)\r\n// использовать не минимизированную версию скрипта\r\nfunction initInputAutocompleteMulti() {\r\n\tif ($.fn.magicSuggest) {\r\n\t\t$('.js-input-autocomplete-multi').each(function () {\r\n\t\t\t$(this).magicSuggest({\r\n\t\t\t\tcls: 'input-autocomplete',\r\n\t\t\t\tmaxSelection: 2,\r\n\t\t\t\t// объект, массив, url, function\r\n\t\t\t\tdata: [{'id': 'Paris', 'name': 'Paris'}, {'id': 'New York', 'name': 'New York'}]\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n}\r\n\r\n// инпут с автокомплитом\r\nfunction initInputAutocomplete() {\r\n\tif ($.fn.easyAutocomplete) {\r\n\r\n\t\t$('.js-input-autocomplete').each(function () {\r\n\t\t\tvar input = $(this)\r\n\r\n\t\t\tinput.easyAutocomplete({\r\n\t\t\t\t// объект, массив, путь к json\r\n\t\t\t\tdata: [\r\n\t\t\t\t\t'apples',\r\n\t\t\t\t\t'apricot',\r\n\t\t\t\t\t'avocado',\r\n\t\t\t\t\t'bananas',\r\n\t\t\t\t\t'blueberries',\r\n\t\t\t\t\t'cherries',\r\n\t\t\t\t\t'grapefruit',\r\n\t\t\t\t\t'grapes',\r\n\t\t\t\t\t'kiwi fruit',\r\n\t\t\t\t\t'lemons',\r\n\t\t\t\t\t'mangoes',\r\n\t\t\t\t\t'melons',\r\n\t\t\t\t\t'nectarines',\r\n\t\t\t\t\t'oranges',\r\n\t\t\t\t\t'passion fruit',\r\n\t\t\t\t\t'peaches',\r\n\t\t\t\t\t'pears',\r\n\t\t\t\t\t'pineapples',\r\n\t\t\t\t\t'plums',\r\n\t\t\t\t\t'rhubarb',\r\n\t\t\t\t\t'rock melon',\r\n\t\t\t\t\t'strawberries',\r\n\t\t\t\t\t'watermelon'\r\n\t\t\t\t],\r\n\t\t\t\t// отправка запроса\r\n\t\t\t\t// url: function (query) {\r\n\t\t\t\t// \treturn input.data('url') + query + '&format=json';\r\n\t\t\t\t// },\r\n\t\t\t\t// задержка до отправки\r\n\t\t\t\t// requestDelay: 500\r\n\t\t\t\t// указание поля для отображения в списке\r\n\t\t\t\t// getValue: 'name',\r\n\t\t\t\t// отключение подсветки введенной фразы в элементах списка\r\n\t\t\t\t// highlightPhrase: false,\r\n\t\t\t\tplaceholder: 'Set up placeholder value',\r\n\t\t\t\tlist: {\r\n\t\t\t\t\tmaxNumberOfElements: 10,\r\n\t\t\t\t\tsort: {\r\n\t\t\t\t\t\tenabled: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\t// показывать в выпадающем списке только совпадения\r\n\t\t\t\t\tmatch: {\r\n\t\t\t\t\t\tenabled: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\tshowAnimation: {\r\n\t\t\t\t\t\ttype: 'fade', //normal|slide|fade\r\n\t\t\t\t\t\ttime: 400,\r\n\t\t\t\t\t\tcallback: function () {\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\thideAnimation: {\r\n\t\t\t\t\t\ttype: 'slide', //normal|slide|fade\r\n\t\t\t\t\t\ttime: 400,\r\n\t\t\t\t\t\tcallback: function () {\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n}\r\n\r\n// переключение класса для родителя поля radio (не требует переинициализации после аякс)\r\nfunction toggleRadioClass() {\r\n\t$(document)\r\n\t\t.off('change.toggleRadioClass', '.js-radio-class__input')\r\n\t\t.on('change.toggleRadioClass', '.js-radio-class__input', toggleRadioClass)\r\n\r\n\tfunction toggleRadioClass() {\r\n\t\t// проверяет явлеяется ли this елементом инициатора события или window\r\n\t\tvar inputs = this.location ? $('.js-radio-class__input') : $('.js-radio-class__input[name=' + $(this).prop('name') + ']')\r\n\r\n\t\t// перебор полей и перключение класса\r\n\t\tinputs.each(function () {\r\n\t\t\tvar input = $(this)\r\n\t\t\tvar label = input.closest('.js-radio-class')\r\n\t\t\tvar toggleClass = label.data('class')\r\n\r\n\t\t\tif (input.prop('checked')) {\r\n\t\t\t\tlabel.addClass(toggleClass)\r\n\t\t\t} else {\r\n\t\t\t\tlabel.removeClass(toggleClass)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\ttoggleRadioClass()\r\n}\r\n\r\n// переключение видимости блока по чекбоксу (не требует переинициализации после аякс)\r\nfunction toggleCheckboxBlock() {\r\n\t$(document)\r\n\t\t.off('change.toggleCheckboxBlock', '.js-checkbox-block__input')\r\n\t\t.on('change.toggleCheckboxBlock', '.js-checkbox-block__input', toggleCheckboxBlock)\r\n\r\n\tfunction toggleCheckboxBlock() {\r\n\t\t// проверяет явлеяется ли this елементом инициатора события или window\r\n\t\tvar input = this.location ? $('.js-checkbox-block__input') : $(this)\r\n\t\tvar content = input.closest('.js-checkbox-block').find('.js-checkbox-block__content')\r\n\r\n\t\tif (input.prop('checked')) {\r\n\t\t\tcontent.fadeIn(300)\r\n\t\t} else {\r\n\t\t\tcontent.fadeOut(300)\r\n\t\t}\r\n\t}\r\n\r\n\ttoggleCheckboxBlock()\r\n}\r\n\r\n// пара блоков с возможностью измненеия их ширины переключателем\r\nfunction resizebleBlocks() {\r\n\t$('.js-resizeble-block').each(function () {\r\n\t\tvar timeout = null\r\n\t\tvar doc = $(document)\r\n\t\tvar parent = $(this)\r\n\t\tvar resizebleBlock = parent.find('.js-resizeble-block__block')\r\n\t\tvar maxWidthBlock = parseFloat(resizebleBlock.data('max-percent'))\r\n\t\tvar minWidthBlock = parseFloat(resizebleBlock.data('min-percent'))\r\n\t\tvar toggler = parent.find('.js-resizeble-block__toggler')\r\n\r\n\t\tfunction resizebleBlocks() {\r\n\t\t\tvar parentWidth = parent.width()\r\n\t\t\tvar parentPositionX = parent.offset().left\r\n\r\n\t\t\t// обработка нажатия мыши в пределах родителя\r\n\t\t\tparent.off('mousedown.resizebleBlocks').on('mousedown.resizebleBlocks', '.js-resizeble-block__toggler', function () {\r\n\t\t\t\t// навешивание ресайза ширины блока относительно позиции курсора\r\n\t\t\t\tdoc.off('mousemove.resizebleBlocks').on('mousemove.resizebleBlocks', function (event) {\r\n\t\t\t\t\tvar positionXOffsetParent = event.clientX - parentPositionX\r\n\t\t\t\t\tvar widthLeftBlock = (positionXOffsetParent / parentWidth * 100).toFixed(3)\r\n\r\n\t\t\t\t\t// если позиция курсора укладывается в рамки минимально и максимально дозволенного интервала ширины блока\r\n\t\t\t\t\tif (minWidthBlock <= widthLeftBlock && maxWidthBlock >= widthLeftBlock) {\r\n\t\t\t\t\t\tresizebleBlock.width(widthLeftBlock + '%')\r\n\r\n\t\t\t\t\t\t// переключение классов на переключателе при достижении левого и правого предела\r\n\t\t\t\t\t\ttoggler.toggleClass('start', minWidthBlock + 1 > widthLeftBlock)\r\n\t\t\t\t\t\ttoggler.toggleClass('end', maxWidthBlock - 1 < widthLeftBlock)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\t// отключение ресайза блоков при отпускании кнопки мышки\r\n\t\tdoc.off('mouseup.resizebleBlocks').on('mouseup.resizebleBlocks', function () {\r\n\t\t\tdoc.off('mousemove.resizebleBlocks')\r\n\t\t})\r\n\r\n\t\t// инициализаци начальная и повторная после ресайза окна\r\n\t\t$(window).off('resize.resizebleBlocks').on('resize.resizebleBlocks', function () {\r\n\t\t\tclearTimeout(timeout)\r\n\t\t\ttimeout = setTimeout(resizebleBlocks, 100);\r\n\t\t}).triggerHandler('resize.resizebleBlocks')\r\n\r\n\t})\r\n}\r\n\r\n// переключение видимости блока по активному радио-баттону\r\nfunction toggleRadioBlock() {\r\n\t$('.js-radio-block').each(function () {\r\n\t\tvar parent = $(this);\r\n\t\tvar inputs = parent.find('.js-radio-block__input');\r\n\t\tvar blocks = parent.find('.js-radio-block__block');\r\n\t\tvar currentValue = null;\r\n\r\n\t\t// обработка события переключения и инициализация радио-баттона\r\n\t\tinputs.off('change.toggleRadioBlock')\r\n\t\t\t.on('change.toggleRadioBlock', toggleRadioBlock)\r\n\t\t\t.triggerHandler('change.toggleRadioBlock');\r\n\r\n\t\t// переключение видимости блоков по значению атрибута value у радио-баттона\r\n\t\tfunction toggleRadioBlock() {\r\n\t\t\tcurrentValue = inputs.filter(':checked').val();\r\n\t\t\tblocks.hide().removeClass('visible-block')\r\n\t\t\t\t.filter('[data-value=\"' + currentValue + '\"]').show().addClass('visible-block');\r\n\t\t}\r\n\t})\r\n}\r\n\r\n// рябь на кнопке при клике\r\nfunction clickButtonRipple() {\r\n\t$('.js-btn-ripple').off('mousedown.clickButtonRipple').on('mousedown.clickButtonRipple', function (event) {\r\n\t\tvar $btn = $(this);\r\n\t\tvar $btnOffset = $btn.offset();\r\n\r\n\t\t// координаты позиции ряби на кнопке\r\n\t\tvar x = event.pageX - $btnOffset.left;\r\n\t\tvar y = event.pageY - $btnOffset.top;\r\n\r\n\t\t// элемент ряби\r\n\t\t$btn.find('.js-btn-ripple__circle')\r\n\t\t\t.css({top: y, left: x})\r\n\t\t\t.addClass('active')\r\n\t\t\t.on('animationend webkitAnimationEnd oanimationend MSAnimationEnd', function () {\r\n\t\t\t\t$(this).removeClass('active');\r\n\t\t\t});\r\n\t})\r\n}\r\n\r\n// блокировка кнопки по незаполненным полям\r\nfunction toggleDisabledBtn() {\r\n\t$('.js-toggle-disabled').each(function () {\r\n\t\tvar $parent = $(this);\r\n\t\tvar $inputs = $parent.find('.js-toggle-disabled__input');\r\n\t\tvar $btn = $parent.find('.js-toggle-disabled__btn');\r\n\r\n\t\t$inputs.off('change.toggleDisabledBtn').on('change.toggleDisabledBtn', toggleDisabledBtn);\r\n\t\t$inputs.off('input.toggleDisabledBtn').on('input.toggleDisabledBtn', toggleDisabledBtn);\r\n\r\n\t\ttoggleDisabledBtn();\r\n\r\n\t\t// проверка всех полей на заполненость и переключение блокировки кнопки\r\n\t\tfunction toggleDisabledBtn() {\r\n\t\t\t// все заполненные поля\r\n\t\t\tvar inputsTrue = $.grep($inputs, function (item) {\r\n\t\t\t\tvar input = $(item);\r\n\t\t\t\tvar status = false;\r\n\r\n\t\t\t\t// проверка значения поля согласно его типу\r\n\t\t\t\tswitch (input.prop('type')) {\r\n\t\t\t\t\tcase 'text':\r\n\t\t\t\t\t\tstatus = input.val().length;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'tel':\r\n\t\t\t\t\t\tstatus = input.val().length;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'checkbox':\r\n\t\t\t\t\t\tstatus = input.prop('checked');\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\treturn status;\r\n\t\t\t})\r\n\r\n\t\t\t// блокировка кнопки если не все поля заполнены\r\n\t\t\tvar blockedState = $inputs.length !== inputsTrue.length;\r\n\r\n\t\t\t$btn.prop('disabled', blockedState);\r\n\t\t\t$parent.toggleClass('blocked', blockedState);\r\n\t\t}\r\n\t})\r\n}\r\n\r\n// accordion native js\r\nfunction toggleAccordionNative() {\r\n\tvar accordionAll = document.querySelectorAll('.js-accordion--native');\r\n\r\n\tArray.from(accordionAll).forEach(function (accordion) {\r\n\t\tvar toggler = accordion.querySelector('.js-accordion__toggler')\r\n\t\tvar content = accordion.querySelector('.js-accordion__content')\r\n\r\n\t\t// инициализация начального состояния\r\n\t\taccordion.classList.add('init-accordion')\r\n\t\tif (!accordion.classList.contains('open-accordion')) {\r\n\t\t\tcontent.style.height = '0';\r\n\t\t}\r\n\r\n\t\t// переключение аккордиона\r\n\t\ttoggler.addEventListener('click', function (e) {\r\n\t\t\te.preventDefault()\r\n\r\n\t\t\tif (accordion.classList.contains('open-accordion')) {\r\n\t\t\t\taccordion.classList.remove('open-accordion')\r\n\t\t\t\tcontent.style.height = content.scrollHeight + 'px';\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\tcontent.style.height = '0';\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\taccordion.classList.add('open-accordion')\r\n\t\t\t\tcontent.style.height = content.scrollHeight + 'px';\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t// очистка высоты после завершения анимации открытия\r\n\t\tcontent.addEventListener('transitionend', function (e) {\r\n\t\t\tif (accordion.classList.contains('open-accordion')) {\r\n\t\t\t\tcontent.style.height = null;\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// accordion group native\r\nfunction toggleAccordionGroupNative() {\r\n\tArray.from(document.querySelectorAll('.js-accordion-group--native')).forEach(function (group) {\r\n\t\tvar allAccordions = group.querySelectorAll('.js-accordion-group__item')\r\n\t\tvar allContents = group.querySelectorAll('.js-accordion-group__content')\r\n\r\n\t\t// перебор аккордионов в группе\r\n\t\tArray.from(allAccordions).forEach(function (accordion) {\r\n\t\t\tvar content = accordion.querySelector('.js-accordion-group__content')\r\n\r\n\t\t\t// инициализация начального состояния\r\n\t\t\taccordion.classList.add('init-accordion')\r\n\t\t\tif (!accordion.classList.contains('open-accordion')) {\r\n\t\t\t\tcontent.style.height = '0';\r\n\t\t\t}\r\n\r\n\t\t\t// переключение аккордиона\r\n\t\t\taccordion.querySelector('.js-accordion-group__toggler').addEventListener('click', function (e) {\r\n\t\t\t\te.preventDefault()\r\n\r\n\t\t\t\t// закрытие всех кроме активного аккордиона\r\n\t\t\t\tcloseOtherAccordions()\r\n\r\n\t\t\t\t// переключение аккордиона\r\n\t\t\t\tif (accordion.classList.contains('open-accordion')) {\r\n\t\t\t\t\taccordion.classList.remove('open-accordion')\r\n\t\t\t\t\tcontent.style.height = content.scrollHeight + 'px';\r\n\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\tcontent.style.height = '0';\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\taccordion.classList.add('open-accordion')\r\n\t\t\t\t\tcontent.style.height = content.scrollHeight + 'px';\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\t// закрытие неактивных аккардионов в группе\r\n\t\t\tfunction closeOtherAccordions() {\r\n\t\t\t\tArray.from(not(allAccordions, accordion)).forEach(function (accordion) {\r\n\t\t\t\t\taccordion.classList.remove('open-accordion')\r\n\t\t\t\t})\r\n\t\t\t\tArray.from(not(allContents, content)).forEach(function (content) {\r\n\t\t\t\t\tcontent.style.height = '0';\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\r\n\t// вернет список без исключеного элемента\r\n\tfunction not($list, $element) {\r\n\t\tvar list = Array.from($list);\r\n\t\tvar index = list.indexOf($element);\r\n\t\tif (!index) {\r\n\t\t\treturn list.slice(++index)\r\n\t\t} else {\r\n\t\t\treturn list.slice(0, index).concat(list.slice(++index))\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// загрузка файла\r\nfunction inputFile() {\r\n\t$('.js-input-file').each(function () {\r\n\t\tvar parent = $(this)\r\n\t\tvar input = parent.find('.js-input-file__input')\r\n\t\tvar name = parent.find('.js-input-file__name')\r\n\r\n\t\t// отслеживание события выбора файла\r\n\t\tinput.off('change.inputFile').on('change.inputFile', function (event) {\r\n\t\t\tname.text(event.target.files[0].name)\r\n\t\t\tparent.addClass('selected-file')\r\n\t\t\t// size.text(formatFileSize(event.target.files[0].size))\r\n\t\t})\r\n\r\n\t\t// сброс файла\r\n\t\tparent.find('.js-input-file__delete').off('click.deleteInputFile').on('click.deleteInputFile', function () {\r\n\t\t\tinput.val('')\r\n\t\t\tparent.removeClass('selected-file')\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// построение мобилного меню каталога\r\nfunction hamburgerMenu() {\r\n\ttimeout = null\r\n\tvar win = $(window)\r\n\r\n\t// мобильное меню каталога в гамбургере\r\n\tfunction hamburgerMenu() {\r\n\t\tconst $hamburgerMenu = $('.js-hamburger-menu');\r\n\t\tconst $hamburgerMenuLink = $hamburgerMenu.find('.js-hamburger-menu__link');\r\n\r\n\t\t$hamburgerMenuLink.off('click.hamburger').on('click.hamburger', function (e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tconst $self = $(this);\r\n\r\n\t\t\t$self.addClass('open');\r\n\t\t\t$self\r\n\t\t\t\t.next('.js-hamburger-menu__sub-list')\r\n\t\t\t\t.find('.js-hamburger-menu__btn-back')\r\n\t\t\t\t.off('click.hamburger').on('click.hamburger', function () {\r\n\t\t\t\t$self.removeClass('open');\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t// закрыть уровни мобильного меню каталога\r\n\t\thamburgerMenu.closeAll = function () {\r\n\t\t\t$hamburgerMenu.removeClass('open');\r\n\t\t\t$hamburgerMenuLink.removeClass('open');\r\n\t\t}\r\n\t}\r\n\r\n\twin.off('resize.hamburgerMenu').on('resize.hamburgerMenu', function () {\r\n\t\tclearTimeout(timeout);\r\n\t\ttimeout = setTimeout(hamburgerMenu, 300);\r\n\t})\r\n\r\n\twin.trigger('resize.hamburgerMenu');\r\n}\r\n\r\n// валидация форм\r\nfunction validateForm() {\r\n\tif ($.fn.parsley) {\r\n\t\t$('[data-parsley-validate]').parsley()\r\n\r\n\t\t// обработка валидации поля с ощибкой\r\n\t\twindow.Parsley.off('field:error').on('field:error', function () {\r\n\t\t\tthis.$element.closest('.js-field').addClass('field--error')\r\n\t\t});\r\n\r\n\t\t// обработка успешной валидации поля\r\n\t\twindow.Parsley.off('field:success').on('field:success', function () {\r\n\t\t\tthis.$element.closest('.js-field').removeClass('field--error')\r\n\t\t});\r\n\r\n\t\t// валидация ввода для поля\r\n\t\t$('input[type=email]').off('keypress.email').on('keypress.email', function (e) {\r\n\t\t\tvar reg = /[а-яА-ЯёЁ]/g;\r\n\r\n\t\t\tif (e.key.search(reg) != -1) {\r\n\t\t\t\te.preventDefault()\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n\r\n// фильтрация элементов по клику на переключатели\r\nfunction filterItems() {\r\n\t$('.js-filter-items').each(function () {\r\n\t\tvar parent = $(this)\r\n\t\tvar toggles = parent.find('.js-filter-items__toggle')\r\n\t\tvar select = parent.find('.js-filter-items__select')\r\n\t\tvar items = parent.find('.js-filter-items__item')\r\n\r\n\t\t// инициализация предустаноленного индекса\r\n\t\tfilterItems(parent.attr('data-index'))\r\n\t\tparent.addClass('init-filter-items')\r\n\r\n\t\t// обработка переключения\r\n\t\ttoggles.off('click.filterItems').on('click.filterItems', function () {\r\n\t\t\tvar toggle = $(this)\r\n\r\n\t\t\tfilterItems(toggle.attr('data-index'))\r\n\t\t})\r\n\r\n\t\t// обработка переключения\r\n\t\tselect.off('change.filterItems').on('change.filterItems', function () {\r\n\t\t\tvar select = $(this)\r\n\r\n\t\t\tfilterItems(String(select.val()))\r\n\t\t})\r\n\r\n\t\t// перелючение активных элементов\r\n\t\tfunction filterItems(activeIndex) {\r\n\t\t\ttoggles.removeClass('active-toggle').filter('[data-index=' + activeIndex + ']').addClass('active-toggle')\r\n\r\n\r\n\t\t\titems.each(function () {\r\n\t\t\t\tvar item = $(this)\r\n\r\n\t\t\t\tif (~item.data('index').split(';').indexOf(activeIndex)) {\r\n\t\t\t\t\titem.show()\r\n\t\t\t\t\titem.addClass('active-item')\r\n\t\t\t\t} else {\r\n\t\t\t\t\titem.hide()\r\n\t\t\t\t\titem.removeClass('active-item')\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t})\r\n}\r\n\r\n// *************************************** служебные функции ******************************************************\r\n\r\n// отложенная загрузка изображений\r\nfunction lazyLoad(scope) {\r\n\tif ($.fn.Lazy) {\r\n\t\tlazyLoad.instance = $('.js-lazy[data-src]', scope).Lazy({\r\n\t\t\tchainable: false,\r\n\t\t\tvisibleOnly: true,\r\n\t\t\teffect: 'fadeIn',\r\n\t\t\tthreshold: 250,\r\n\t\t\tplaceholder: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTBweCIgaGVpZ2h0PSI1MHB4IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCIgY2xhc3M9Imxkcy1kb3VibGUtcmluZyIgc3R5bGU9ImFuaW1hdGlvbi1wbGF5LXN0YXRlOiBydW5uaW5nOyBhbmltYXRpb24tZGVsYXk6IDBzOyBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDApIG5vbmUgcmVwZWF0IHNjcm9sbCAwJSAwJTsiPjxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIG5nLWF0dHItcj0ie3tjb25maWcucmFkaXVzfX0iIG5nLWF0dHItc3Ryb2tlLXdpZHRoPSJ7e2NvbmZpZy53aWR0aH19IiBuZy1hdHRyLXN0cm9rZT0ie3tjb25maWcuYzF9fSIgbmctYXR0ci1zdHJva2UtZGFzaGFycmF5PSJ7e2NvbmZpZy5kYXNoYXJyYXl9fSIgZmlsbD0ibm9uZSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiByPSI0MCIgc3Ryb2tlLXdpZHRoPSI2IiBzdHJva2U9IiM5M2RiZTkiIHN0cm9rZS1kYXNoYXJyYXk9IjYyLjgzMTg1MzA3MTc5NTg2IDYyLjgzMTg1MzA3MTc5NTg2IiBzdHlsZT0iYW5pbWF0aW9uLXBsYXktc3RhdGU6IHJ1bm5pbmc7IGFuaW1hdGlvbi1kZWxheTogMHM7Ij48YW5pbWF0ZVRyYW5zZm9ybSBhdHRyaWJ1dGVOYW1lPSJ0cmFuc2Zvcm0iIHR5cGU9InJvdGF0ZSIgY2FsY01vZGU9ImxpbmVhciIgdmFsdWVzPSIwIDUwIDUwOzM2MCA1MCA1MCIga2V5VGltZXM9IjA7MSIgZHVyPSIxcyIgYmVnaW49IjBzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgc3R5bGU9ImFuaW1hdGlvbi1wbGF5LXN0YXRlOiBydW5uaW5nOyBhbmltYXRpb24tZGVsYXk6IDBzOyI+PC9hbmltYXRlVHJhbnNmb3JtPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIG5nLWF0dHItcj0ie3tjb25maWcucmFkaXVzMn19IiBuZy1hdHRyLXN0cm9rZS13aWR0aD0ie3tjb25maWcud2lkdGh9fSIgbmctYXR0ci1zdHJva2U9Int7Y29uZmlnLmMyfX0iIG5nLWF0dHItc3Ryb2tlLWRhc2hhcnJheT0ie3tjb25maWcuZGFzaGFycmF5Mn19IiBuZy1hdHRyLXN0cm9rZS1kYXNob2Zmc2V0PSJ7e2NvbmZpZy5kYXNob2Zmc2V0Mn19IiBmaWxsPSJub25lIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHI9IjMzIiBzdHJva2Utd2lkdGg9IjYiIHN0cm9rZT0iIzY4OWNjNSIgc3Ryb2tlLWRhc2hhcnJheT0iNTEuODM2Mjc4Nzg0MjMxNTkgNTEuODM2Mjc4Nzg0MjMxNTkiIHN0cm9rZS1kYXNob2Zmc2V0PSI1MS44MzYyNzg3ODQyMzE1OSIgc3R5bGU9ImFuaW1hdGlvbi1wbGF5LXN0YXRlOiBydW5uaW5nOyBhbmltYXRpb24tZGVsYXk6IDBzOyI+PGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJyb3RhdGUiIGNhbGNNb2RlPSJsaW5lYXIiIHZhbHVlcz0iMCA1MCA1MDstMzYwIDUwIDUwIiBrZXlUaW1lcz0iMDsxIiBkdXI9IjFzIiBiZWdpbj0iMHMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBzdHlsZT0iYW5pbWF0aW9uLXBsYXktc3RhdGU6IHJ1bm5pbmc7IGFuaW1hdGlvbi1kZWxheTogMHM7Ij48L2FuaW1hdGVUcmFuc2Zvcm0+PC9jaXJjbGU+PC9zdmc+',\r\n\r\n\t\t\t// стили фона прелоадера для элементов не являющимися картинками\r\n\t\t\tbeforeLoad: function (element) {\r\n\t\t\t\tif (element[0].tagName !== 'IMG') {\r\n\t\t\t\t\telement.css({backgroundPosition: 'center', backgroundRepeat: 'no-repeat', backgroundSize: '119px'})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tafterLoad: function (element) {\r\n\t\t\t\telement.addClass('lazy-loaded')\r\n\r\n\t\t\t\t// очистка фона после загрузки изображения\r\n\t\t\t\telement.css({backgroundPosition: '', backgroundRepeat: '', backgroundSize: ''})\r\n\t\t\t\tif (element[0].tagName === 'IMG') {\r\n\t\t\t\t\telement.css({background: 'none'})\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// инициализация события загрузки отложенного изображения\r\n\t\t\t\t$(window).trigger('lazyImagesLoaded')\r\n\t\t\t},\r\n\t\t})\r\n\t}\r\n}\r\n\r\n// обновление lazyload картинок внутри таба\r\n// lazyLoad.instance.update()\r\n\r\n// Видимости элемента после указанной высоты скролла страницы\r\nfunction showElemAfterScroll(element, toggleHeightScroll) {\r\n\tvar doc = $(document)\r\n\r\n\tdoc.off('scroll.showElemAfterScroll').on('scroll.showElemAfterScroll', toggleShow)\r\n\tdoc.trigger('scroll.showElemAfterScroll')\r\n\r\n\tfunction toggleShow() {\r\n\t\tvar scrollDocument = doc.scrollTop();\r\n\r\n\t\tif (scrollDocument < toggleHeightScroll) {\r\n\t\t\telement.fadeOut(300)\r\n\t\t} else {\r\n\t\t\telement.fadeIn(300)\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// блокировать всплытие события скролла на элементе\r\nfunction lockScroll() {\r\n\tif ($.fn.scrollLock) {\r\n\t\t$('.js-lock-scroll').scrollLock({\r\n\t\t\tunblock: '.js-lock-scroll__unlock'\r\n\t\t});\r\n\t}\r\n}\r\n\r\n// добавление на страницу отложенной загрузки внешнего скрипта\r\nloadedDelayScripts = []\r\n\r\nfunction loadDelayScript(url) {\r\n\tif (!~loadedDelayScripts.indexOf(url)) {\r\n\t\tloadedDelayScripts.push(url)\r\n\t\tvar script = $(document.createElement('script'))\r\n\t\tscript.attr({src: url, type: 'text/javascript'})\r\n\t\t$('body').append(script)\r\n\t}\r\n}\r\n\r\n// находится ли блок в видимой области вьюпорта или приближается к ней\r\nfunction getVisibleElemOnScroll(elemJQ, reserveHeight) {\r\n\tif (elemJQ.length > 0) {\r\n\t\treturn elemJQ.offset().top - ($(document).scrollTop() + $(window).height() + reserveHeight) < 0\r\n\t}\r\n\treturn false\r\n}\r\n\r\n// удаление элемента по клику (не требует переинициализации после ajax)\r\nfunction removeItem() {\r\n\t$(document).off('click.removeItem').on('click.removeItem', '.js-remove__btn', function () {\r\n\t\t$(this).closest('.js-remove').trigger('removeItem').remove()\r\n\t})\r\n}\r\n\r\n// запретить зум страницы после фокуса в поле ввода на IOS\r\nfunction disableZoomAfterFocusInput() {\r\n\tvar head = $('head')\r\n\r\n\t$('input[type=text], input[type=tel], input[type=number], input[type=email], textarea')\r\n\t\t.mouseover(zoomDisable)\r\n\t\t.mousedown(zoomEnable);\r\n\r\n\tfunction zoomDisable() {\r\n\t\tconsole.log('disable')\r\n\t\thead.children('meta[name=viewport]').remove();\r\n\t\thead.prepend('<meta name=\"viewport\" content=\"user-scalable=0, maximum-scale=1.0, width=device-width\" />');\r\n\t}\r\n\r\n\tfunction zoomEnable() {\r\n\t\tconsole.log('enable')\r\n\t\thead.children('meta[name=viewport]').remove();\r\n\t\thead.prepend('<meta name=\"viewport\" content=\"user-scalable=1, initial-scale=1.0, width=device-width\" />');\r\n\t}\r\n}\r\n\r\n// скролл к блоку по ссылке\r\nfunction scrollToBlock() {\r\n\t$('.js-scroll-to').each(function () {\r\n\t\tvar _this = $(this)\r\n\r\n\t\t_this.off('click.scrollToBlock').on('click.scrollToBlock', function (event) {\r\n\t\t\tevent.preventDefault()\r\n\r\n\t\t\t// величина недоезда блока до верха в атрибуте ссылки\r\n\t\t\tvar offset = $(_this).data('offset') || 0\r\n\t\t\t// ID блока до, которого скролить\r\n\t\t\tvar block = $(_this.attr('href'))\r\n\t\t\tif (block.length) {\r\n\t\t\t\tvar positionBlock = block.offset().top - offset\r\n\r\n\t\t\t\t$([document.documentElement, document.body]).animate({scrollTop: positionBlock}, 400)\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// скролл к блоку по ссылке\r\nfunction scrollToBlockNative() {\r\n\t// скролл к блоку по ссылке\r\n\tArray.from(document.querySelectorAll('.js-scroll-to')).forEach(function (item) {\r\n\t\titem.removeEventListener('click', scrollToBlock)\r\n\t\titem.addEventListener('click', scrollToBlock)\r\n\r\n\t\tfunction scrollToBlock(event) {\r\n\t\t\tevent.preventDefault()\r\n\r\n\t\t\t// величина недоезда блока до верха в атрибуте ссылки\r\n\t\t\tvar offset = item.getAttribute('offset') || 0\r\n\t\t\t// ID блока до, которого скролить\r\n\t\t\tvar block = document.querySelector(item.getAttribute('href'))\r\n\t\t\tif (block) {\r\n\t\t\t\tvar positionBlock = block.getBoundingClientRect().top - offset\r\n\r\n\t\t\t\tanimate({\r\n\t\t\t\t\tduration: 400,\r\n\t\t\t\t\ttiming: function (timeFraction) {\r\n\t\t\t\t\t\treturn timeFraction;\r\n\t\t\t\t\t},            // линейная функция значит, что анимация идёт с одной и той же скоростью\r\n\t\t\t\t\tdraw: function (progress) {\r\n\t\t\t\t\t\tdocument.documentElement.scrollTop += Math.round((block.getBoundingClientRect().top - offset) * progress)\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\r\n\tfunction animate({timing, draw, duration}) {\r\n\t\tlet start = performance.now();\r\n\r\n\t\trequestAnimationFrame(function animate(time) {\r\n\t\t\t// timeFraction изменяется от 0 до 1\r\n\t\t\tlet timeFraction = (time - start) / duration;\r\n\t\t\tif (timeFraction > 1) timeFraction = 1;\r\n\r\n\t\t\t// вычисление текущего состояния анимации\r\n\t\t\tlet progress = timing(timeFraction);\r\n\r\n\t\t\tdraw(progress); // отрисовать её\r\n\r\n\t\t\tif (timeFraction < 1) {\r\n\t\t\t\trequestAnimationFrame(animate);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\n// триггер клика по другому или одновременно нескольким элементам\r\nfunction triggerClick() {\r\n\tvar allSenders = $('.js-trigger-click__sender')\r\n\tvar allRecipients = $('.js-trigger-click__recipient')\r\n\r\n\tallSenders.each(function () {\r\n\t\tvar sender = $(this)\r\n\t\t// массив из ID отправителя для связывания триггеров со своими приемщиками\r\n\t\tvar triggerIdArr = (sender.data('triggerId')) ? String(sender.data('triggerId')).split(',') : false\r\n\r\n\t\t// обработка клика отправителя триггера\r\n\t\tsender.off('click.triggerClick').on('click.triggerClick', function (event) {\r\n\t\t\tevent.stopPropagation()\r\n\t\t\tevent.preventDefault()\r\n\r\n\t\t\tif (triggerIdArr) {\r\n\t\t\t\t// перебор масива приемщиков триггеров\r\n\t\t\t\tallRecipients.each(function () {\r\n\t\t\t\t\tconst recipient = $(this)\r\n\r\n\t\t\t\t\t// инициализация клика при совпадении ID отправителя и приемщика\r\n\t\t\t\t\tif (~triggerIdArr.indexOf(String(recipient.data('triggerId')))) recipient.trigger('click')\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// инициализация позиционирования, не выходящего за контентную область\r\nfunction tooltipPosition() {\r\n\tvar tooltips;\r\n\tvar delta;\r\n\tvar i;\r\n\tvar containerPadding;\r\n\tvar timeout = null;\r\n\r\n\t// ширина скроллбара\r\n\ttooltipPosition.scrollBarWidth = (function () {\r\n\t\tvar outer = document.createElement('div');\r\n\t\touter.style.visibility = 'hidden';\r\n\t\touter.style.width = '100px';\r\n\t\touter.style.msOverflowStyle = 'scrollbar';\r\n\r\n\t\tdocument.body.appendChild(outer);\r\n\r\n\t\tvar widthNoScroll = outer.offsetWidth;\r\n\t\t// force scrollbars\r\n\t\touter.style.overflow = 'scroll';\r\n\r\n\t\t// add innerdiv\r\n\t\tvar inner = document.createElement('div');\r\n\t\tinner.style.width = '100%';\r\n\t\touter.appendChild(inner);\r\n\r\n\t\tvar widthWithScroll = inner.offsetWidth;\r\n\r\n\t\t// remove divs\r\n\t\touter.parentNode.removeChild(outer);\r\n\r\n\t\treturn widthNoScroll - widthWithScroll;\r\n\t})();\r\n\r\n\t// breakpoints\r\n\ttooltipPosition.breakpoints = {\r\n\t\t'md-max': 1249,\r\n\t\t'sm-max': 999,\r\n\t\t'xs-max': 759,\r\n\t};\r\n\r\n\t// вычисление положения\r\n\ttooltipPosition.calcPosition = function () {\r\n\t\ttooltips = $('.js-tooltip-position');\r\n\t\ttooltips.css('marginLeft', '');\r\n\r\n\t\t// ширина паддинга контейнера страницы\r\n\t\tcontainerPadding = window.innerWidth > tooltipPosition.breakpoints['xs-max'] ? 30 : 10;\r\n\t\tcontainerPadding = window.innerWidth > tooltipPosition.breakpoints['sm-max'] ? 30 : containerPadding;\r\n\r\n\t\tfor (i = 0; i < tooltips.length; i++) {\r\n\t\t\t// насколько выступает правый край выпадашки за границы контейнера страницы\r\n\t\t\tdelta = tooltips[i].getBoundingClientRect().left + tooltips[i].offsetWidth -\r\n\t\t\t\tMath.min((window.innerWidth - tooltipPosition.scrollBarWidth - containerPadding), (window.innerWidth - tooltipPosition.scrollBarWidth) / 2 + 684);\r\n\r\n\t\t\tif (delta > 1) {\r\n\t\t\t\t// сдвиг выпадашки, если она выступает\r\n\t\t\t\ttooltips[i].style.marginLeft = ((parseInt(tooltips[i].style.marginLeft) || 0) - delta) + 'px';\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t$(window).off('resize.setTooltipPositions').on('resize.setTooltipPositions', function () {\r\n\t\tclearTimeout(timeout);\r\n\r\n\t\ttimeout = setTimeout(tooltipPosition.calcPosition, 100);\r\n\t}).trigger('resize.setTooltipPositions');\r\n}\r\n\r\n// установка единиц измерения для размера файла\r\nfunction formatFileSize(value) {\r\n\tif (!value || !value.toString) value = 0;\r\n\r\n\tvar units = 'Б';\r\n\r\n\tif (value > 1024) {\r\n\t\tvalue /= 1024;\r\n\t\tunits = 'кБ'\r\n\t}\r\n\r\n\tif (value > 1024) {\r\n\t\tvalue /= 1024;\r\n\t\tunits = 'МБ'\r\n\t}\r\n\r\n\tif (value > 1024) {\r\n\t\tvalue /= 1024;\r\n\t\tunits = 'ГБ'\r\n\t}\r\n\treturn parseFloat(value)\r\n\t\t.toFixed(2)\r\n\t\t.replace(/\\B(?=(\\d{3})+(?!\\d))/g, ' ')\r\n\t\t.replace(/\\./g, ',') + ' ' + units;\r\n}\r\n\r\n// autoplay video\r\nfunction startAutoplayVideo() {\r\n\t$('video[autoplay]').each(function () {\r\n\t\tvar video = $(this)\r\n\t\tvideo.prop('muted', true)\r\n\t\tvideo[0].play()\r\n\t})\r\n}\r\n\r\n// переключение класса по наведению\r\nfunction toggleClassByHover() {\r\n\tvar allItems = $('.js-class-hover')\r\n\r\n\tallItems.each(function () {\r\n\t\tvar item = $(this)\r\n\t\tvar itemClass = item.data('class')\r\n\r\n\t\t// обработка прихода курсора на элемента\r\n\t\titem.off('mouseover.toggleClassByHover').on('mouseover.toggleClassByHover', function () {\r\n\t\t\tbody.addClass(itemClass);\r\n\t\t\titem.addClass(itemClass);\r\n\t\t});\r\n\r\n\t\t// обработка ухода курсора с элемента\r\n\t\titem.off('mouseout.toggleClassByHover').on('mouseout.toggleClassByHover', function () {\r\n\t\t\tbody.removeClass(itemClass);\r\n\t\t\titem.removeClass(itemClass);\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// задание переменной 1vh для css\r\nfunction setVhVariable() {\r\n\tvar timeout = null\r\n\r\n\tfunction setVhVariable() {\r\n\t\tlet vh = (window.innerHeight * 0.01).toFixed(4) + 'px';\r\n\t\tdocument.documentElement.style.setProperty('--vh', vh);\r\n\t}\r\n\r\n\tsetVhVariable()\r\n\r\n\twindow.addEventListener('resize', function () {\r\n\t\tclearTimeout(timeout)\r\n\t\ttimeout = setTimeout(setVhVariable, 300)\r\n\t});\r\n}\r\n\r\n// запрет ввода в поле символов\r\nfunction disableInputSymbols() {\r\n\t// запрет ввода для всего кроме номера мобильного\r\n\t$('[type=\"tel\"]').off('keypress.banSymbolsForPhone').on('keypress.banSymbolsForPhone', function (event) {\r\n\t\tvar enabledSymbol = /[\\d\\s\\)\\(\\+-]/.test(String.fromCharCode(event.charCode))\r\n\t\tif (!enabledSymbol) {\r\n\t\t\tevent.preventDefault()\r\n\t\t}\r\n\t})\r\n\r\n\t// запрет ввода для всего кроме текстовых фраз\r\n\t$('[data-input-type=\"text\"]').off('keypress.banSymbolsForText').on('keypress.banSymbolsForText', function (event) {\r\n\t\tvar enabledSymbol = /[A-Za-zА-ЯЁа-яё\\s-]/.test(String.fromCharCode(event.charCode))\r\n\t\tif (!enabledSymbol) {\r\n\t\t\tevent.preventDefault()\r\n\t\t}\r\n\t})\r\n}\r\n\r\n// управление youtube iframe видео через его API\r\nfunction callYuotubeIframePlayer(iframe, func, args) {\r\n\t// провека iframe на наличие youtube\r\n\tif (iframe && ~iframe.src.indexOf('youtube.com/embed')) {\r\n\t\tiframe.contentWindow.postMessage(JSON.stringify({\r\n\t\t\t'event': 'command',\r\n\t\t\t'func': func,\r\n\t\t\t'args': args || []\r\n\t\t}), '*');\r\n\t}\r\n\t// запущеннно youtube iframe видео\r\n\tcallYuotubeIframePlayer.youtubeVideoPlayed = null\r\n}\r\n\r\n// остановка предыдущего видео youtube iframe при его наличии\r\nif (callYuotubeIframePlayer.youtubeVideoPlayed) {\r\n\tcallYuotubeIframePlayer(callYuotubeIframePlayer.youtubeVideoPlayed, 'pauseVideo')\r\n}\r\n// запуск видео youtube iframe в слайде\r\n// callYuotubeIframePlayer.youtubeVideoPlayed = $(this.slides).filter('.swiper-slide-active').find('iframe')[0]\r\n// callYuotubeIframePlayer(callYuotubeIframePlayer.youtubeVideoPlayed, 'playVideo')\r\n\r\n// трансформация строки в camelCase стиль\r\nfunction toCamelCase(str) {\r\n\t// Lower cases the string\r\n\treturn str.toLowerCase()\r\n\t\t// Replaces any - or _ characters with a space\r\n\t\t.replace(/[-_]+/g, ' ')\r\n\r\n\t\t// Removes any non alphanumeric characters\r\n\t\t.replace(/[^\\w\\s]/g, '')\r\n\r\n\t\t// Uppercases the first character in each group immediately following a space\r\n\t\t// (delimited by spaces)\r\n\t\t.replace(/ (.)/g, function ($1) {\r\n\t\t\treturn $1.toUpperCase();\r\n\t\t})\r\n\t\t// Removes spaces\r\n\t\t.replace(/ /g, '');\r\n}\r\n\r\n// нативный аналог метода jquery .not()\r\nfunction not($list, $element) {\r\n\tvar list = Array.from($list);\r\n\tvar index = list.indexOf($element);\r\n\tif (!index) {\r\n\t\treturn list.slice(++index)\r\n\t} else {\r\n\t\treturn list.slice(0, index).concat(list.slice(++index))\r\n\t}\r\n}\r\n\r\n// нативный аналог метода jquery .data()\r\nwindow.dataStorage = {\r\n\t_storage: new WeakMap(),\r\n\tset: function (element, key, obj) {\r\n\t\tif (!this._storage.has(element)) {\r\n\t\t\tthis._storage.set(element, new Map());\r\n\t\t}\r\n\t\tthis._storage.get(element).set(key, obj);\r\n\t},\r\n\tget: function (element, key) {\r\n\t\tif (!this._storage.get(element)) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\treturn this._storage.get(element).get(key);\r\n\t},\r\n\thas: function (element, key) {\r\n\t\treturn this._storage.has(element) && this._storage.get(element).has(key);\r\n\t},\r\n\tremove: function (element, key) {\r\n\t\tvar ret = this._storage.get(element).delete(key);\r\n\t\tif (!this._storage.get(element).size === 0) {\r\n\t\t\tthis._storage.delete(element);\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n}\r\n\r\n// отслеживание свайпа на мобилке для галереи\r\nfunction detectSwipe() {\r\n\tlet touchstartX = 0;\r\n\tlet touchstartY = 0;\r\n\tlet touchendX = 0;\r\n\tlet touchendY = 0;\r\n\tvar deg = 0;\r\n\r\n\tconst gestureZone = document.getElementById('js_full_image_lnk');\r\n\r\n\tif (gestureZone) {\r\n\t\tgestureZone.addEventListener('touchstart', function (event) {\r\n\t\t\ttouchstartX = event.changedTouches[0].screenX;\r\n\t\t\ttouchstartY = event.changedTouches[0].screenY;\r\n\t\t}, false);\r\n\r\n\t\tgestureZone.addEventListener('touchend', function (event) {\r\n\t\t\ttouchendX = event.changedTouches[0].screenX;\r\n\t\t\ttouchendY = event.changedTouches[0].screenY;\r\n\t\t\thandleGesture();\r\n\t\t}, false);\r\n\t}\r\n\r\n\t// расчет угла свайпа\r\n\tfunction calcDeg() {\r\n\t\tvar rads = Math.atan((touchstartY - touchendY) / (touchstartX - touchendX))\r\n\t\tdeg = rads * (180 / 3.14);\r\n\t}\r\n\r\n\t// расчет направления свайпа\r\n\tfunction handleGesture() {\r\n\t\tif (touchendX < touchstartX) {\r\n\t\t\tcalcDeg()\r\n\t\t\tif (deg > -35 && deg < 35) {\r\n\t\t\t\tjQuery('.more-img.current').next().find('a').click()\r\n\t\t\t\tconsole.log('Swiped left');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (touchendX > touchstartX) {\r\n\t\t\tcalcDeg()\r\n\t\t\tif (deg > -35 && deg < 35) {\r\n\t\t\t\tjQuery('.more-img.current').prev().find('a').click()\r\n\t\t\t\tconsole.log('Swiped right');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (touchendY < touchstartY) {\r\n\t\t\tcalcDeg()\r\n\t\t\tif (deg < -65 || deg > 65) {\r\n\t\t\t\tconsole.log('Swiped up');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (touchendY > touchstartY) {\r\n\t\t\tcalcDeg()\r\n\t\t\tif (deg < -65 || deg > 65) {\r\n\t\t\t\tconsole.log('Swiped down');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (touchendY === touchstartY) {\r\n\t\t\tconsole.log('Tap');\r\n\t\t}\r\n\t}\r\n}\n\n//# sourceURL=webpack:///./source/js/es6/script.js?");

/***/ }),

/***/ "./source/js/es6/view.js":
/*!*******************************!*\
  !*** ./source/js/es6/view.js ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("if (window.jQuery) {\r\n\tconst View = new (function () {\r\n\t\t// внутренние переменные\r\n\t\tconst body = $(document.body);\r\n\t\tconst htmlbody = $([document.documentElement, document.body]);\r\n\t\tconst win = $(window);\r\n\t\tconst doc = $(document)\r\n\r\n\t\t// внешние переменные\r\n\t\t// проверка на мобильное устройство (true/false)\r\n\t\tthis.checkAdaptiveBrowser = 'ontouchstart' in document.documentElement\r\n\t\tthis.isIE = (function detectIE() {\r\n\t\t\tvar ua = window.navigator.userAgent;\r\n\r\n\t\t\tvar msie = ua.indexOf('MSIE ');\r\n\t\t\tif (msie > 0) return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\r\n\r\n\t\t\tvar trident = ua.indexOf('Trident/');\r\n\t\t\tif (trident > 0) {\r\n\t\t\t\tvar rv = ua.indexOf('rv:');\r\n\t\t\t\treturn parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\r\n\t\t\t}\r\n\r\n\t\t\tvar edge = ua.indexOf('Edge/');\r\n\t\t\tif (edge > 0) return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);\r\n\r\n\t\t\treturn false;\r\n\t\t})();\r\n\t\tthis.isIOS = parseInt(('' + (/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent) || [0, ''])[1]).replace('undefined', '3_2').replace('_', '.').replace('_', '')) || false;\r\n\r\n\t\tthis.screenSizeIsAdaptive = null;\r\n\t\t// проверка устройства десктоп или адатив\r\n\t\tthis.mobileAndTabletCheck = null;\r\n\t\t// проверка наличия скроллбара у окна браузера\r\n\t\tthis.winHaveScroll = null;\r\n\t\t// ширина скроллбара у окна браузера\r\n\t\tthis.scrollBarWidth = null;\r\n\t\t// длительность анимации эффектов переключения всех переключающихся блоков\r\n\t\tthis.animateDuration = 200\r\n\t\t// breakpoints\r\n\t\tthis.breakpoints = {\r\n\t\t\t'lgMax': 1440,\r\n\t\t\t'lgMin': 1367,\r\n\t\t\t'mdMax': 1366,\r\n\t\t\t'mdMin': 1025,\r\n\t\t\t'smMax': 1024,\r\n\t\t\t'smMin': 768,\r\n\t\t\t'xsMax': 767,\r\n\t\t\t'xsMid': 550,\r\n\t\t\t'xsMin': 320,\r\n\t\t}\r\n\t\t// спиннер при ожидании загрузки контента\r\n\t\tthis.imageLoaderBase64 = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxzdHlsZT4KICAgICAgICAuc3Bpbm5lcnsKICAgICAgICAgICAgYW5pbWF0aW9uOiBzcGlubmVyIDFzIGxpbmVhciBpbmZpbml0ZTsKICAgICAgICAgICAgdHJhbnNmb3JtLW9yaWdpbjogY2VudGVyIGNlbnRlcjsKICAgICAgICB9CiAgICAgICAgQGtleWZyYW1lcyBzcGlubmVyIHsKICAgICAgICAwJSB7CiAgICAgICAgdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7CiAgICAgICAgfQogICAgICAgIDEwMCUgewogICAgICAgIHRyYW5zZm9ybTogcm90YXRlKDM2MGRlZyk7CiAgICAgICAgfQogICAgICAgIH0KICAgIDwvc3R5bGU+CiAgICA8cGF0aCBjbGFzcz0ic3Bpbm5lciIKICAgICAgICAgIGQ9Ik0xMC43MjI1IDIuMzg3MjRDNy41NTQyOSAyLjM1Njg3IDQuMjU5NDYgNC40NDM0MyAyLjk3ODMxIDguMTA5MzRDMS44NTk5MyAxMS4zMjg4IDIuNTgwMzkgMTYuMDI3MyA3LjI0OTgyIDE4Ljc3NkM3LjMxOTE2IDE4LjgwNjQgNy40NzU5MSAxNy4yMTc5IDExLjg2OCAxNkMxNS4zMTY2IDE1LjA0NjMgMTcuODY2OCAxMS41ODA5IDE1LjgyOSA4Ljk1NjcyQzE0LjMwMDcgNi45ODU1NyAxMS41NDI0IDYuODA2MzggOS4yMjczMiA5LjI4NDc0QzkuOTU5ODQgNy4xODkwNyAxMS41NjM1IDUuOTQzODEgMTIuOTQ3MiA1LjY0MDA5QzE2Ljc3NTYgNC44MjYxMiAxOS40ODU2IDguMjU4MTYgMTkuMTA4OCAxMi4yODI1QzE4LjY4OTggMTYuODAxOCAxNC40Njk1IDIwIDkuODM5MjYgMjBDNC40NDMzNCAyMCAwIDE1LjQ4MDYgMCA5Ljk3NzIyQzAuMDExOTU2OCA3LjMyNjkyIDEuMDY1MyA0Ljc4OTI3IDIuOTI5NTggMi45MTk0OEM0Ljc5Mzg1IDEuMDQ5NjkgNy4zMTcyOCAtMi43Mzc5MWUtMDUgOS45NDc3OCA1LjM1NTkyZS0xMEMxNS40MzExIDUuMzU1OTVlLTEwIDE5LjgzNTMgNC40NDAzOSAxOS44NDczIDEwLjEzMjFDMTguODA0MyA1LjgyNTM2IDE1LjU1NDcgMi40MzU4NCAxMC43MjI1IDIuMzg3MjRaIgogICAgICAgICAgZmlsbD0iIzE3OEVEMSIvPgo8L3N2Zz4K'\r\n\t\tthis.setCookie = function (name, value, options) {\r\n\t\t\toptions = options || {};\r\n\r\n\t\t\tvar expires = options.expires;\r\n\r\n\t\t\tif (typeof expires == 'number' && expires) {\r\n\t\t\t\tvar d = new Date();\r\n\t\t\t\td.setTime(d.getTime() + expires * 1000);\r\n\t\t\t\texpires = options.expires = d;\r\n\t\t\t}\r\n\t\t\tif (expires && expires.toUTCString) {\r\n\t\t\t\toptions.expires = expires.toUTCString();\r\n\t\t\t}\r\n\r\n\t\t\tvalue = encodeURIComponent(value);\r\n\r\n\t\t\tvar updatedCookie = name + '=' + value;\r\n\r\n\t\t\tfor (var propName in options) {\r\n\t\t\t\tupdatedCookie += '; ' + propName;\r\n\t\t\t\tvar propValue = options[propName];\r\n\t\t\t\tif (propValue !== true) {\r\n\t\t\t\t\tupdatedCookie += '=' + propValue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tdocument.cookie = updatedCookie;\r\n\t\t};\r\n\r\n\t\t// добавление на страницу отложенной загрузки внешнего скрипта\r\n\t\tthis.loadedScripts = []\r\n\t\tthis.loadDelayScript = function (url) {\r\n\t\t\tif (!~View.loadedScripts.indexOf(url)) {\r\n\t\t\t\tView.loadedScripts.push(url)\r\n\t\t\t\tconst script = $(document.createElement('script'))\r\n\t\t\t\tscript.attr({src: url, type: 'text/javascript'})\r\n\t\t\t\tbody.append(script)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// проверка расстояние до видимости блока больше или меншье указнного (при скролле страницы)\r\n\t\tthis.getVisibleElemOnScroll = (elemJQ, reserveHeight) => {\r\n\t\t\tif (elemJQ.is(':visible') && elemJQ.length) {\r\n\t\t\t\treturn elemJQ.offset().top - (doc.scrollTop() + win.height() + reserveHeight) < 0\r\n\t\t\t}\r\n\t\t\treturn false\r\n\t\t}\r\n\r\n\t\t// Видимости элемента после указанной высоты скролла страницы\r\n\t\tthis.showElemAfterScroll = function (element, toggleHeightScroll) {\r\n\t\t\tdoc.off('scroll.showElemAfterScroll').on('scroll.showElemAfterScroll', toggleShow)\r\n\t\t\tdoc.trigger('scroll.showElemAfterScroll')\r\n\r\n\t\t\tfunction toggleShow() {\r\n\t\t\t\tvar scrollDocument = doc.scrollTop();\r\n\r\n\t\t\t\tif (scrollDocument < toggleHeightScroll) {\r\n\t\t\t\t\telement.fadeOut(300)\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.fadeIn(300)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.allClassPage = []\r\n\r\n\t\t// для защиты от повторного скачивания апи карт\r\n\t\tthis.loadYandexApi = false\r\n\t\t// инициализация всех яндекс карт на сайте\r\n\t\tthis.initMaps = function () {\r\n\t\t\tthis.loadYandexApi = true\r\n\t\t\tif (window.ymaps && window.ymaps.Map) {\r\n\t\t\t\t// console.log('window.ymaps')\r\n\t\t\t\tinitMaps()\r\n\t\t\t} else {\r\n\t\t\t\t// console.log('not window.ymaps')\r\n\t\t\t\twindow.ymaps.ready(function () {\r\n\t\t\t\t\tinitMaps()\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tfunction initMaps() {\r\n\t\t\t\t// карта с выбором городов на главной странице\r\n\t\t\t\t$('#ymaps-multi-city').each(function () {\r\n\t\t\t\t\tvar mapItem = $(this)\r\n\t\t\t\t\tconsole.log('map container', mapItem)\r\n\r\n\t\t\t\t\tif (!mapItem.hasClass('init-map')) {\r\n\r\n\t\t\t\t\t\tmapItem.empty()\r\n\t\t\t\t\t\tmapItem.addClass('init-map')\r\n\r\n\t\t\t\t\t\tvar mapObject = new ymaps.Map(mapItem[0], {\r\n\t\t\t\t\t\t\tcenter: [50.79, 37.64],\r\n\t\t\t\t\t\t\tcontrols: ['zoomControl', 'fullscreenControl'],\r\n\t\t\t\t\t\t\tzoom: 18,\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tsearchControlProvider: 'yandex#search'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tvar objectManager = new ymaps.ObjectManager({\r\n\t\t\t\t\t\t\t// Чтобы метки начали кластеризоваться, выставляем опцию.\r\n\t\t\t\t\t\t\tclusterize: true,\r\n\t\t\t\t\t\t\t// ObjectManager принимает те же опции, что и кластеризатор.\r\n\t\t\t\t\t\t\tgridSize: 32,\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t// стилизация меток на карте\r\n\t\t\t\t\t\tobjectManager.objects.options.set('iconLayout', 'default#image');\r\n\t\t\t\t\t\tobjectManager.objects.options.set('iconImageHref', '/local/build/img/map__icon.svg');\r\n\t\t\t\t\t\tobjectManager.objects.options.set('iconImageSize', [48, 60]);\r\n\t\t\t\t\t\tobjectManager.objects.options.set('iconImageOffset', [-24, -60]);\r\n\r\n\t\t\t\t\t\t// контент для метки кластера\r\n\t\t\t\t\t\tvar MyIconContentLayout = ymaps.templateLayoutFactory.createClass(\r\n\t\t\t\t\t\t\t'<div style=\"color: #ffffff; font-weight: 500; font-size: 17px;\">{{ properties.geoObjects.length }}</div>'\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\t// стилизация метки кластера\r\n\t\t\t\t\t\tobjectManager.clusters.options.set({\r\n\t\t\t\t\t\t\tclusterIcons: [{\r\n\t\t\t\t\t\t\t\thref: '/local/build/img/map__icon--cluster.svg',\r\n\t\t\t\t\t\t\t\tcolor: '#fff',\r\n\t\t\t\t\t\t\t\tsize: [48, 60],\r\n\t\t\t\t\t\t\t\toffset: [-24, -60],\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\tclusterIconContentLayout: MyIconContentLayout,\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// загрузка данных меток и добавление на карту\r\n\t\t\t\t\t\tfunction loadMapData(dataJsonPath) {\r\n\t\t\t\t\t\t\t// путь к JSON файлу с данными для карты\r\n\t\t\t\t\t\t\tvar pathJsonMultiCustom = dataJsonPath || mapItem.data('json-path')\r\n\r\n\t\t\t\t\t\t\t// удалить все метки на карте\r\n\t\t\t\t\t\t\tobjectManager.removeAll();\r\n\t\t\t\t\t\t\tmapObject.geoObjects.removeAll();\r\n\r\n\t\t\t\t\t\t\t// Загружаем GeoJSON файл с описанием объектов.\r\n\t\t\t\t\t\t\t$.getJSON(pathJsonMultiCustom)\r\n\t\t\t\t\t\t\t\t.done(function (response) {\r\n\t\t\t\t\t\t\t\t\t// Добавляем описание объектов в формате JSON в менеджер объектов.\r\n\t\t\t\t\t\t\t\t\tobjectManager.add(response);\r\n\t\t\t\t\t\t\t\t\t// Добавляем объекты на карту.\r\n\t\t\t\t\t\t\t\t\tmapObject.geoObjects.add(objectManager);\r\n\r\n\t\t\t\t\t\t\t\t\t// устанавливаем нужный центр и зум карты, чтобы было видно все метки и задаем нужный отступ меток от края карты\r\n\t\t\t\t\t\t\t\t\tmapObject.setBounds(mapObject.geoObjects.getBounds(), {checkZoomRange: true, zoomMargin: 50})\r\n\t\t\t\t\t\t\t\t\t\t.then(function () {\r\n\t\t\t\t\t\t\t\t\t\t\t//после установки проверяем зум и не даем выйти за рамки нужного\r\n\t\t\t\t\t\t\t\t\t\t\tif (mapObject.getZoom() > 15) mapObject.setZoom(15);\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t.fail(function (response) {\r\n\t\t\t\t\t\t\t\t\tconsole.warn('offer: ajax load failed', response)\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tloadMapData()\r\n\r\n\t\t\t\t\t\t// проброс функции обновления данных карты наружу\r\n\t\t\t\t\t\tmapItem.data('loadMapData', loadMapData)\r\n\r\n\t\t\t\t\t\t// переключение города и его меток на карте\r\n\t\t\t\t\t\tvar citySelect = $('#js-map-city')\r\n\r\n\t\t\t\t\t\tcitySelect.off('change').on('change', function () {\r\n\t\t\t\t\t\t\tloadMapData(citySelect.val())\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\t// карта с полем для ввода адреса\r\n\t\t\t\t$('.ymaps-with-input').each(function () {\r\n\t\t\t\t\tvar mapItem = $(this)\r\n\t\t\t\t\tconsole.log('map container', mapItem)\r\n\r\n\t\t\t\t\tif (!mapItem.hasClass('init-map')) {\r\n\t\t\t\t\t\tmapItem.empty()\r\n\t\t\t\t\t\tmapItem.addClass('init-map')\r\n\t\t\t\t\t\tvar mapObject = new ymaps.Map(mapItem[0], {\r\n\t\t\t\t\t\t\tcenter: [50.79, 37.64],\r\n\t\t\t\t\t\t\tcontrols: ['zoomControl'],\r\n\t\t\t\t\t\t\tzoom: 18,\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tautoFitToViewport: 'always',\r\n\t\t\t\t\t\t\tsearchControlProvider: 'yandex#search'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tvar objectManager = new ymaps.ObjectManager({\r\n\t\t\t\t\t\t\t// Чтобы метки начали кластеризоваться, выставляем опцию.\r\n\t\t\t\t\t\t\tclusterize: true,\r\n\t\t\t\t\t\t\t// ObjectManager принимает те же опции, что и кластеризатор.\r\n\t\t\t\t\t\t\tgridSize: 32,\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t// стилизация меток на карте\r\n\t\t\t\t\t\tobjectManager.objects.options.set('iconLayout', 'default#image');\r\n\t\t\t\t\t\tobjectManager.objects.options.set('iconImageHref', '/local/build/img/map__icon.svg');\r\n\t\t\t\t\t\tobjectManager.objects.options.set('iconImageSize', [48, 60]);\r\n\t\t\t\t\t\tobjectManager.objects.options.set('iconImageOffset', [-24, -60]);\r\n\r\n\t\t\t\t\t\t// контент для метки кластера\r\n\t\t\t\t\t\tvar MyIconContentLayout = ymaps.templateLayoutFactory.createClass(\r\n\t\t\t\t\t\t\t'<div style=\"color: #ffffff; font-weight: 500; font-size: 17px;\">{{ properties.geoObjects.length }}</div>'\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\t// стилизация метки кластера\r\n\t\t\t\t\t\tobjectManager.clusters.options.set({\r\n\t\t\t\t\t\t\tclusterIcons: [{\r\n\t\t\t\t\t\t\t\thref: '/local/build/img/map__icon--cluster.svg',\r\n\t\t\t\t\t\t\t\tcolor: '#fff',\r\n\t\t\t\t\t\t\t\tsize: [48, 60],\r\n\t\t\t\t\t\t\t\toffset: [-24, -60],\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\tclusterIconContentLayout: MyIconContentLayout,\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// при открытии балуна\r\n\t\t\t\t\t\tobjectManager.objects.events.add(['balloonopen', 'redraw'], function (e, a) {\r\n\t\t\t\t\t\t\tif (win.width() < 820) {\r\n\t\t\t\t\t\t\t\t$('.fancybox-slide').scrollTop(400)\r\n\t\t\t\t\t\t\t\t// fullscreenControl.enterFullscreen();\r\n\t\t\t\t\t\t\t\tmapObject.getBalloon().mapAutoPan()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// загрузка данных меток и добавление на карту\r\n\t\t\t\t\t\tfunction loadMapData(dataJsonPath) {\r\n\t\t\t\t\t\t\t// путь к JSON файлу с данными для карты\r\n\t\t\t\t\t\t\tvar pathJsonMultiCustom = dataJsonPath || mapItem.data('json-path')\r\n\r\n\t\t\t\t\t\t\t// удалить все метки на карте\r\n\t\t\t\t\t\t\tobjectManager.removeAll();\r\n\t\t\t\t\t\t\tmapObject.geoObjects.removeAll();\r\n\r\n\t\t\t\t\t\t\t// Загружаем GeoJSON файл с описанием объектов.\r\n\t\t\t\t\t\t\t$.getJSON(pathJsonMultiCustom)\r\n\t\t\t\t\t\t\t\t.done(function (response) {\r\n\t\t\t\t\t\t\t\t\t// Добавляем описание объектов в формате JSON в менеджер объектов.\r\n\t\t\t\t\t\t\t\t\tobjectManager.add(response);\r\n\t\t\t\t\t\t\t\t\t// Добавляем объекты на карту.\r\n\t\t\t\t\t\t\t\t\tmapObject.geoObjects.add(objectManager);\r\n\r\n\t\t\t\t\t\t\t\t\t// устанавливаем нужный центр и зум карты, чтобы было видно все метки и задаем нужный отступ меток от края карты\r\n\t\t\t\t\t\t\t\t\tmapItem.data('setPositionMap')()\r\n\r\n\t\t\t\t\t\t\t\t\treturn response\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t.fail(function (response) {\r\n\t\t\t\t\t\t\t\t\tconsole.warn('offer: ajax load failed', response)\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// проброс функции обновления данных карты наружу\r\n\t\t\t\t\t\tmapItem.data('loadMapData', loadMapData)\r\n\r\n\t\t\t\t\t\t// устанавливаем нужный центр и зум карты, чтобы было видно все метки и задаем нужный отступ меток от края карты\r\n\t\t\t\t\t\tfunction setPositionMap() {\r\n\t\t\t\t\t\t\tmapObject.setBounds(mapObject.geoObjects.getBounds(), {checkZoomRange: true, zoomMargin: 50})\r\n\t\t\t\t\t\t\t\t.then(function () {\r\n\t\t\t\t\t\t\t\t\t//после установки проверяем зум и не даем выйти за рамки нужного\r\n\t\t\t\t\t\t\t\t\tif (mapObject.getZoom() > 15) mapObject.setZoom(15);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tmapItem.data('setPositionMap', setPositionMap)\r\n\r\n\t\t\t\t\t\tloadMapData()\r\n\r\n\t\t\t\t\t\t// Слушаем клик на карте.\r\n\t\t\t\t\t\t// mapObject.events.add('click', function (e) {\r\n\t\t\t\t\t\t// \tvar coords = e.get('coords');\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t\t// \t// передвигаем метку.\r\n\t\t\t\t\t\t// \tmyPlacemark.geometry.setCoordinates(coords);\r\n\t\t\t\t\t\t// \tgetAddress(coords);\r\n\t\t\t\t\t\t// });\r\n\r\n\t\t\t\t\t\t// поля ввода и вывода адреса\r\n\t\t\t\t\t\tlet locationInput = $('#location-input')\r\n\t\t\t\t\t\t// сообщение об ошибке\r\n\t\t\t\t\t\tvar notice = $('#notice')\r\n\r\n\t\t\t\t\t\t// Подключаем поисковые подсказки к полю ввода.\r\n\t\t\t\t\t\tvar suggestView = new ymaps.SuggestView('location-input')\r\n\r\n\t\t\t\t\t\t// При клике по кнопке запускаем верификацию введёных данных.\r\n\t\t\t\t\t\t$('#btn-search').on('click.searchLocation', function (e) {\r\n\t\t\t\t\t\t\tgeocode();\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tfunction geocode() {\r\n\t\t\t\t\t\t\t// Забираем запрос из поля ввода.\r\n\t\t\t\t\t\t\tvar request = locationInput.val();\r\n\t\t\t\t\t\t\t// Геокодируем введённые данные.\r\n\t\t\t\t\t\t\tymaps.geocode(request).then(function (res) {\r\n\t\t\t\t\t\t\t\tvar obj = res.geoObjects.get(0),\r\n\t\t\t\t\t\t\t\t\terror;\r\n\r\n\t\t\t\t\t\t\t\t// Об оценке точности ответа геокодера\r\n\t\t\t\t\t\t\t\tif (obj) {\r\n\t\t\t\t\t\t\t\t\tswitch (obj.properties.get('metaDataProperty.GeocoderMetaData.precision')) {\r\n\t\t\t\t\t\t\t\t\t\tcase 'exact':\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\tcase 'number':\r\n\t\t\t\t\t\t\t\t\t\tcase 'near':\r\n\t\t\t\t\t\t\t\t\t\tcase 'range':\r\n\t\t\t\t\t\t\t\t\t\t\terror = 'Неточный адрес, уточните номер дома';\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\tcase 'street':\r\n\t\t\t\t\t\t\t\t\t\t\terror = 'Неполный адрес, уточните номер дома';\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\tcase 'other':\r\n\t\t\t\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t\t\t\terror = 'Неточный адрес, требуется уточнение';\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\terror = 'Адрес не найден';\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t// Если геокодер возвращает пустой массив или неточный результат, то показываем ошибку.\r\n\t\t\t\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\t\t\t\tshowError(error);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tshowResult(obj);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}, function (e) {\r\n\t\t\t\t\t\t\t\tconsole.log('geocode error', e)\r\n\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\tfunction showResult(obj) {\r\n\t\t\t\t\t\t\t\t// Удаляем сообщение об ошибке, если найденный адрес совпадает с поисковым запросом.\r\n\t\t\t\t\t\t\t\tnotice.css('display', 'none');\r\n\r\n\t\t\t\t\t\t\t\tvar mapItem = $('#ymaps-with-input')\r\n\t\t\t\t\t\t\t\tvar bounds = obj.properties.get('boundedBy')\r\n\t\t\t\t\t\t\t\t// Рассчитываем видимую область для текущего положения пользователя.\r\n\t\t\t\t\t\t\t\tvar mapState = ymaps.util.bounds.getCenterAndZoom(\r\n\t\t\t\t\t\t\t\t\tbounds,\r\n\t\t\t\t\t\t\t\t\t[mapItem.width(), mapItem.height()]\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t// Убираем контролы с карты.\r\n\t\t\t\t\t\t\t\tmapState.controls = [];\r\n\t\t\t\t\t\t\t\t// Передвигаем карту по найденным координатам\r\n\t\t\t\t\t\t\t\tsetPlacemarkCoords(mapState);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tfunction showError(message) {\r\n\t\t\t\t\t\t\t\tnotice.text(message).css('display', 'block');\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tfunction setPlacemarkCoords(state) {\r\n\t\t\t\t\t\t\t\t// выставляем новый центр карты и меняем позицию метки в соответствии с найденным адресом.\r\n\t\t\t\t\t\t\t\tmapObject.setCenter(state.center, state.zoom + 2);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// обновить размер карты при ресайзе\r\n\t\t\t\t\t\tmapItem.off('updateSizeMap').on('updateSizeMap', function () {\r\n\t\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\t\tmapObject.container.fitToViewport();\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t// Добавим элемент управления FullscreenControl на карту, чтобы управлять им снаружи карты\r\n\t\t\t\t\t\tvar fullscreenControl = new ymaps.control.FullscreenControl();\r\n\t\t\t\t\t\tmapObject.controls.add(fullscreenControl);\r\n\r\n\t\t\t\t\t\t// закрытие баллуна по кнопке внутри него\r\n\t\t\t\t\t\tdoc.off('click.closeBallon').on('click.closeBallon', '.js-select-pharmacy', function (e) {\r\n\t\t\t\t\t\t\tmapObject.balloon.close()\r\n\r\n\t\t\t\t\t\t\t// переведем карту из «полноэкранный режим»\r\n\t\t\t\t\t\t\tfullscreenControl.exitFullscreen();\r\n\r\n\t\t\t\t\t\t\tView.control.closeAll()\r\n\t\t\t\t\t\t\t$.fancybox.close();\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// ajax подгрузка при наличии параметра data-ajax с адресом файла блоков, параметры - (url, контейнер для выгрузки данных, контейнер локальной переинициализации, callback)\r\n\t\tthis.ajaxLoad = function (ajaxUrl, ajaxContainerForData, containerForReInit, callback) {\r\n\t\t\tif (!ajaxContainerForData.prop('ajaxLoaded')) {\r\n\t\t\t\t$.get(ajaxUrl, function (data, status) {\r\n\t\t\t\t\tajaxContainerForData.append(data)\r\n\t\t\t\t\tif (containerForReInit) View.initAllLocal(containerForReInit)\r\n\t\t\t\t\tif (status === 'success') {\r\n\t\t\t\t\t\tajaxContainerForData.prop('ajaxLoaded', true)\r\n\t\t\t\t\t\tif (typeof callback === 'function') callback()\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.log('ajax error')\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tif (typeof callback === 'function') callback()\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// управление youtube iframe видео через его API\r\n\t\tthis.callYuotubeIframePlayer = function (iframe, func, args) {\r\n\t\t\t// провека iframe на наличие youtube\r\n\t\t\tif (iframe && ~iframe.src.indexOf('youtube.com/embed')) {\r\n\t\t\t\tiframe.contentWindow.postMessage(JSON.stringify({\r\n\t\t\t\t\t'event': 'command',\r\n\t\t\t\t\t'func': func,\r\n\t\t\t\t\t'args': args || []\r\n\t\t\t\t}), '*');\r\n\t\t\t}\r\n\t\t}\r\n\t\t// запущеннно youtube iframe видео\r\n\t\tthis.youtubeVideoPlayed = null\r\n\r\n\t\t// трансформация строки в camelCase стиль\r\n\t\tthis.toCamelCase = function (str) {\r\n\t\t\t// Lower cases the string\r\n\t\t\treturn str.toLowerCase()\r\n\t\t\t\t// Replaces any - or _ characters with a space\r\n\t\t\t\t.replace(/[-_]+/g, ' ')\r\n\r\n\t\t\t\t// Removes any non alphanumeric characters\r\n\t\t\t\t.replace(/[^\\w\\s]/g, '')\r\n\r\n\t\t\t\t// Uppercases the first character in each group immediately following a space\r\n\t\t\t\t// (delimited by spaces)\r\n\t\t\t\t.replace(/ (.)/g, function ($1) {\r\n\t\t\t\t\treturn $1.toUpperCase();\r\n\t\t\t\t})\r\n\t\t\t\t// Removes spaces\r\n\t\t\t\t.replace(/ /g, '');\r\n\t\t}\r\n\r\n\t\t// инициализация основных параметров класса View\r\n\t\tthis.initView = function () {\r\n\t\t\tthis.scrollBarWidth = (function () {\r\n\t\t\t\tconst outer = document.createElement('div');\r\n\t\t\t\touter.style.visibility = 'hidden';\r\n\t\t\t\touter.style.width = '100px';\r\n\t\t\t\touter.style.msOverflowStyle = 'scrollbar';\r\n\r\n\t\t\t\tdocument.body.appendChild(outer);\r\n\t\t\t\tconst widthNoScroll = outer.offsetWidth;\r\n\t\t\t\t// force scrollbars\r\n\t\t\t\touter.style.overflow = 'scroll';\r\n\t\t\t\t// add innerdiv\r\n\t\t\t\tconst inner = document.createElement('div');\r\n\t\t\t\tinner.style.width = '100%';\r\n\t\t\t\touter.appendChild(inner);\r\n\t\t\t\tconst widthWithScroll = inner.offsetWidth;\r\n\t\t\t\t// remove divs\r\n\t\t\t\touter.parentNode.removeChild(outer);\r\n\t\t\t\treturn widthNoScroll - widthWithScroll;\r\n\t\t\t})();\r\n\t\t\t(function haveScroll() {\r\n\t\t\t\tlet timeout = null\r\n\r\n\t\t\t\tfunction winHaveScroll() {\r\n\t\t\t\t\tView.winHaveScroll = win.height() < doc.height()\r\n\t\t\t\t}\r\n\r\n\t\t\t\twin.off('resize.winHaveScroll').on('resize.winHaveScroll', function () {\r\n\t\t\t\t\tclearTimeout(timeout)\r\n\t\t\t\t\ttimeout = setTimeout(winHaveScroll, 300)\r\n\t\t\t\t})\r\n\t\t\t\twin.trigger('resize.winHaveScroll');\r\n\t\t\t})();\r\n\t\t\t(function screenWidthIsAdaptive() {\r\n\t\t\t\tlet timeout = null\r\n\r\n\t\t\t\tfunction getScreenWidth() {\r\n\t\t\t\t\tif (View.winHaveScroll) {\r\n\t\t\t\t\t\tView.screenSizeIsAdaptive = (win.width() + View.scrollBarWidth) <= 1024\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tView.screenSizeIsAdaptive = win.width() <= 1024\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\twin.off('resize.getScreenWidth').on('resize.getScreenWidth', function () {\r\n\t\t\t\t\tclearTimeout(timeout)\r\n\t\t\t\t\ttimeout = setTimeout(getScreenWidth, 300)\r\n\t\t\t\t})\r\n\t\t\t\tgetScreenWidth()\r\n\t\t\t})();\r\n\t\t\t(function setMobileAndTabletCheck() {\r\n\t\t\t\tlet timeout = null\r\n\r\n\t\t\t\tfunction setAdaptiveCheck() {\r\n\t\t\t\t\tView.mobileAndTabletCheck = View.checkAdaptiveBrowser || View.screenSizeIsAdaptive\r\n\t\t\t\t}\r\n\r\n\t\t\t\twin.off('resize.setAdaptiveCheck').on('resize.setAdaptiveCheck', function () {\r\n\t\t\t\t\tclearTimeout(timeout)\r\n\t\t\t\t\ttimeout = setTimeout(setAdaptiveCheck, 300)\r\n\t\t\t\t})\r\n\t\t\t\tsetAdaptiveCheck()\r\n\t\t\t})();\r\n\t\t}\r\n\r\n\t\t// инициализация\r\n\t\tthis.init = {\r\n\t\t\t// global - инициализируется 1 раз\r\n\t\t\tglobal: {\r\n\t\t\t\tfavorites() {\r\n\t\t\t\t\t$('body').off('click.favorites', '.js-favorite').on('click.favorites', '.js-favorite', function (e) {\r\n\t\t\t\t\t\tvar element = $(this);\r\n\t\t\t\t\t\tvar id = element.data('product');\r\n\t\t\t\t\t\tif (element.hasClass('product-item__favorite--active')) {\r\n\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\t'url': window.location.pathname,\r\n\t\t\t\t\t\t\t\t'data': 'FAVORITE_DEL=' + id,\r\n\t\t\t\t\t\t\t\t'success': function (res) {\r\n\t\t\t\t\t\t\t\t\tvar count = parseInt($('.js-favorite-header-count').text());\r\n\t\t\t\t\t\t\t\t\tif (count > 1) {\r\n\t\t\t\t\t\t\t\t\t\tcount--;\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tcount = 0;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t$('.js-favorite-header-count').text(count);\r\n\t\t\t\t\t\t\t\t\telement.removeClass('product-item__favorite--active');\r\n\t\t\t\t\t\t\t\t\tif (element.parents('.catalog__cell').hasClass('isFavorites')) {\r\n\t\t\t\t\t\t\t\t\t\telement.parents('.catalog__cell').remove();\r\n\t\t\t\t\t\t\t\t\t\tif (!$('.catalog__cell').length) {\r\n\t\t\t\t\t\t\t\t\t\t\twindow.location.reload();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\t'url': window.location.pathname,\r\n\t\t\t\t\t\t\t\t'data': 'FAVORITE_ADD=' + id,\r\n\t\t\t\t\t\t\t\t'success': function (res) {\r\n\t\t\t\t\t\t\t\t\tvar count = parseInt($('.js-favorite-header-count').text());\r\n\t\t\t\t\t\t\t\t\tcount++;\r\n\t\t\t\t\t\t\t\t\t$('.js-favorite-header-count').text(count);\r\n\t\t\t\t\t\t\t\t\telement.addClass('product-item__favorite--active');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// сворачивать в выпадашку пункты меню, если не влезают\r\n\t\t\t\tflexMenu() {\r\n\t\t\t\t\tif ($.fn.flexMenu) {\r\n\t\t\t\t\t\tvar parents = $('.js-flex-menu')\r\n\r\n\t\t\t\t\t\tparents.each(function () {\r\n\t\t\t\t\t\t\tvar parent = $(this)\r\n\r\n\t\t\t\t\t\t\tparent.flexMenu({\r\n\t\t\t\t\t\t\t\tlinkText: 'Еще',\r\n\t\t\t\t\t\t\t\tlinkTitle: 'Показать еще',\r\n\t\t\t\t\t\t\t\tlinkTextAll: 'Меню',\r\n\t\t\t\t\t\t\t\tlinkTitleAll: 'Показать меню',\r\n\t\t\t\t\t\t\t\tcutoff: 1,\r\n\t\t\t\t\t\t\t\tshowOnHover: false,\r\n\t\t\t\t\t\t\t\tshouldApply: function () {\r\n\t\t\t\t\t\t\t\t\treturn win.width() > 1024\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t// обработка если открывается попап по клику\r\n\t\t\t\t\t\t\tvar toggler = parent.find('.flexMenu-viewMore')\r\n\t\t\t\t\t\t\tvar content = parent.find('.flexMenu-popup')\r\n\r\n\t\t\t\t\t\t\ttoggler.off('click.flexMenu').on('click.flexMenu', function (event) {\r\n\t\t\t\t\t\t\t\tevent.stopPropagation()\r\n\r\n\t\t\t\t\t\t\t\tparent.toggleClass('active', toggler.hasClass('active'))\r\n\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\tdoc.off('click.flexMenu').on('click.flexMenu', function () {\r\n\t\t\t\t\t\t\t\tparent.removeClass('active')\r\n\t\t\t\t\t\t\t\ttoggler.removeClass('active')\r\n\t\t\t\t\t\t\t\tcontent.hide()\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// переключение скрытого блока по наведению с задержкой\r\n\t\t\t\ttoggleDropdownHover() {\r\n\t\t\t\t\tvar allParents = $('.js-dropdown--hover')\r\n\t\t\t\t\tvar allContents = allParents.find('.js-dropdown__content')\r\n\r\n\t\t\t\t\tallParents.each(function (ind) {\r\n\t\t\t\t\t\tvar parent = $(this)\r\n\t\t\t\t\t\tvar content = parent.find('.js-dropdown__content')\r\n\t\t\t\t\t\tvar toggler = parent.find('.js-dropdown__toggler')\r\n\t\t\t\t\t\tvar timeout = null;\r\n\r\n\t\t\t\t\t\t// инициализации и закрытие при загрузке страницы\r\n\t\t\t\t\t\tcontent.click(function (event) {\r\n\t\t\t\t\t\t\tevent.stopPropagation()\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tparent.addClass('init-dropdown')\r\n\r\n\t\t\t\t\t\t// переключение метода открытия для адаптива и десктопа\r\n\t\t\t\t\t\tfunction toggleDropdownHover() {\r\n\t\t\t\t\t\t\tif (View.mobileAndTabletCheck) {\r\n\t\t\t\t\t\t\t\t// открытие по клику\r\n\t\t\t\t\t\t\t\ttogglerClick()\r\n\r\n\t\t\t\t\t\t\t\t// снятие ненужных обработчиков\r\n\t\t\t\t\t\t\t\tparent.off('mouseover.toggleDropdownHover')\r\n\t\t\t\t\t\t\t\tparent.off('mouseleave.toggleDropdownHover')\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// обработка события прихода курсора на элемент\r\n\t\t\t\t\t\t\t\tparent.off('mouseover.toggleDropdownHover').on('mouseover.toggleDropdownHover', function (event) {\r\n\t\t\t\t\t\t\t\t\tevent.preventDefault()\r\n\t\t\t\t\t\t\t\t\tevent.stopPropagation()\r\n\r\n\t\t\t\t\t\t\t\t\t// переключение состояния\r\n\t\t\t\t\t\t\t\t\tclearTimeout(timeout);\r\n\t\t\t\t\t\t\t\t\ttimeout = setTimeout(openDropdown, 100);\r\n\t\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t\t// обработка события ухода курсора с элемента\r\n\t\t\t\t\t\t\t\tparent.off('mouseleave.toggleDropdownHover').on('mouseleave.toggleDropdownHover', function (event) {\r\n\t\t\t\t\t\t\t\t\tevent.preventDefault()\r\n\t\t\t\t\t\t\t\t\tevent.stopPropagation()\r\n\r\n\t\t\t\t\t\t\t\t\t// переключение состояния\r\n\t\t\t\t\t\t\t\t\tclearTimeout(timeout);\r\n\t\t\t\t\t\t\t\t\ttimeout = setTimeout(closeDropdown, 100);\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfunction togglerClick() {\r\n\t\t\t\t\t\t\ttoggler.off('click.toggleDropdownHover').on('click.toggleDropdownHover', function (event) {\r\n\t\t\t\t\t\t\t\tevent.preventDefault()\r\n\t\t\t\t\t\t\t\tevent.stopPropagation()\r\n\r\n\t\t\t\t\t\t\t\tif (!parent.hasClass('open-dropdown')) {\r\n\t\t\t\t\t\t\t\t\t// закрыть остальные блоки Dropdown\r\n\t\t\t\t\t\t\t\t\tallParents.not(parent).removeClass('open-dropdown')\r\n\t\t\t\t\t\t\t\t\tallContents.not(content).slideUp(300)\r\n\r\n\t\t\t\t\t\t\t\t\topenDropdown()\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tcloseDropdown()\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// открыть\r\n\t\t\t\t\t\tfunction openDropdown() {\r\n\t\t\t\t\t\t\tparent.addClass('open-dropdown')\r\n\t\t\t\t\t\t\tcontent.fadeIn(0)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// закрыть\r\n\t\t\t\t\t\tfunction closeDropdown() {\r\n\t\t\t\t\t\t\tparent.removeClass('open-dropdown')\r\n\t\t\t\t\t\t\tcontent.fadeOut(0)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\twin.off('resize.toggleDropdownHover' + ind).on('resize.toggleDropdownHover' + ind, function () {\r\n\t\t\t\t\t\t\tclearTimeout(timeout);\r\n\t\t\t\t\t\t\ttimeout = setTimeout(toggleDropdownHover, 300);\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\twin.trigger('resize.toggleDropdownHover' + ind);\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tView.init.global.toggleDropdownHover.closeAllDropdownHover = function () {\r\n\t\t\t\t\t\t// if (View.mobileAndTabletCheck) {\r\n\t\t\t\t\t\tallParents.removeClass('open-dropdown')\r\n\t\t\t\t\t\tallContents.fadeOut(0)\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// аякс подгрузка разметки в конец страницы\r\n\t\t\t\tajaxLoadAppendBody() {\r\n\t\t\t\t\tvar preloader = $('<div>').addClass('icon-preloader');\r\n\r\n\t\t\t\t\t$('.js-ajax-load-toggler').each(function () {\r\n\t\t\t\t\t\tvar toggler = $(this)\r\n\t\t\t\t\t\tvar url = toggler.data('ajaxUrl');\r\n\r\n\t\t\t\t\t\ttoggler.off('click.ajaxLoad').on('click.ajaxLoad', function (event) {\r\n\t\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\t\tbody.append(preloader);\r\n\r\n\t\t\t\t\t\t\t$.get(url).done(function (response) {\r\n\t\t\t\t\t\t\t\tvar $response = $(response)\r\n\t\t\t\t\t\t\t\tbody.append($response);\r\n\t\t\t\t\t\t\t\tpreloader.remove();\r\n\r\n\t\t\t\t\t\t\t\t// реинициализация скриптов после аякса\r\n\t\t\t\t\t\t\t\tView.init.local.maskInputs($response)\r\n\t\t\t\t\t\t\t\t$('[data-parsley-validate]').parsley();\r\n\r\n\t\t\t\t\t\t\t}).fail(function (response) {\r\n\t\t\t\t\t\t\t\tpreloader.remove();\r\n\t\t\t\t\t\t\t\tconsole.warn('offer: ajax load failed', response);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// удаление элемента по клику (не требует переинициализации после ajax)\r\n\t\t\t\tremoveItem() {\r\n\t\t\t\t\tdoc.off('click.removeItem').on('click.removeItem', '.js-remove__btn', function () {\r\n\t\t\t\t\t\t$(this).closest('.js-remove').trigger('removeItem').remove()\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// меню с ховером и задержкой\r\n\t\t\t\tadaptiveHeightHoverMenu() {\r\n\t\t\t\t\tvar allParents = $('.js-hover-menu')\r\n\t\t\t\t\tvar timeout = null;\r\n\r\n\t\t\t\t\tfunction delayHoverMenu() {\r\n\t\t\t\t\t\tallParents.each(function () {\r\n\t\t\t\t\t\t\tvar parent = $(this)\r\n\t\t\t\t\t\t\tvar items = parent.find('.js-hover-menu__item')\r\n\t\t\t\t\t\t\tvar subMenu = items.find('.js-hover-menu__submenu')\r\n\r\n\t\t\t\t\t\t\tif (!View.mobileAndTabletCheck) {\r\n\t\t\t\t\t\t\t\t// текущее положение курсора\r\n\t\t\t\t\t\t\t\tvar nCurPosX;\r\n\t\t\t\t\t\t\t\tparent.mousemove(function (event) {\r\n\t\t\t\t\t\t\t\t\treturn nCurPosX = event.clientX\r\n\t\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t\titems.each(function () {\r\n\t\t\t\t\t\t\t\t\tvar curItem = $(this)\r\n\r\n\t\t\t\t\t\t\t\t\t// обработка прихода курсора на пункта меню\r\n\t\t\t\t\t\t\t\t\tcurItem.off('mouseover.showInnerMenu').on('mouseover.showInnerMenu', function () {\r\n\t\t\t\t\t\t\t\t\t\titems.not(curItem).removeClass('hover').removeClass('active');\r\n\t\t\t\t\t\t\t\t\t\tcurItem.addClass('hover');\r\n\r\n\t\t\t\t\t\t\t\t\t\t/* делаем задержку чтобы при случайном наведении на пункт подменю не показывалось */\r\n\t\t\t\t\t\t\t\t\t\tsetTimeout(function () {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t/* если по истечению задержки мы все еще на том же пункт меню, значит показываем подменю */\r\n\t\t\t\t\t\t\t\t\t\t\tif (curItem.hasClass('hover')) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tcurItem.addClass('active')\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t// установка высоты навигации в зависимости от высоты выпадющего меню\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar subMenu = curItem.find('.js-hover-menu__submenu')\r\n\t\t\t\t\t\t\t\t\t\t\t\tparent.css({minHeight: 0})\r\n\t\t\t\t\t\t\t\t\t\t\t\tparent.css({minHeight: subMenu.outerHeight()})\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t// обработка ухода курсора с пункта меню\r\n\t\t\t\t\t\t\t\t\tcurItem.off('mouseout.hideInnerMenu').on('mouseout.hideInnerMenu', function () {\r\n\t\t\t\t\t\t\t\t\t\tvar nPosXStart = nCurPosX\r\n\t\t\t\t\t\t\t\t\t\t// curItem.removeClass('hover');\r\n\r\n\t\t\t\t\t\t\t\t\t\t/* делаем небольшую задержку чтобы определить направление движение курсора */\r\n\t\t\t\t\t\t\t\t\t\tsetTimeout(function () {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t// если в сторону подменю, значит делаем большую задержку для возможности движения по диагонали\r\n\t\t\t\t\t\t\t\t\t\t\tif (nCurPosX - nPosXStart > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetTimeout(function () {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/* если по истечению задержки курсор находится на подменю или текущем пункте меню тогда не прячем подменю */\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (!curItem.hasClass('hover')) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdeactivateItem()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t} else if (!curItem.hasClass('hover')) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t// если нет и мы ушли с текущего пункта меню, моментально скрываем подменю\r\n\t\t\t\t\t\t\t\t\t\t\t\tdeactivateItem()\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}, 10);\r\n\r\n\t\t\t\t\t\t\t\t\t\t// деактивируем пункт меню\r\n\t\t\t\t\t\t\t\t\t\tfunction deactivateItem() {\r\n\t\t\t\t\t\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\t\t\t\t\t\tcurItem.removeClass('active');\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// удаляем обработчики hover с пунктов меню\r\n\t\t\t\t\t\t\t\titems.off('mouseover.showInnerMenu')\r\n\t\t\t\t\t\t\t\titems.off('mouseout.hideInnerMenu')\r\n\t\t\t\t\t\t\t\titems.removeClass('hover active')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\twin.off('resize.delayHoverMenu').on('resize.delayHoverMenu', function () {\r\n\t\t\t\t\t\tclearTimeout(timeout);\r\n\t\t\t\t\t\ttimeout = setTimeout(delayHoverMenu, 300);\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\twin.trigger('resize.delayHoverMenu');\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// accordion only adaptive\r\n\t\t\t\ttoggleAccordionOnlyAdaptive() {\r\n\t\t\t\t\tvar timeout = null\r\n\r\n\t\t\t\t\t// accordion только для адаптива\r\n\t\t\t\t\tfunction toggleAccordionOnlyAdaptive() {\r\n\t\t\t\t\t\tvar allParents = $('.js-accordion--adaptive')\r\n\r\n\t\t\t\t\t\tallParents.each(function () {\r\n\t\t\t\t\t\t\tvar parent = $(this)\r\n\t\t\t\t\t\t\tvar content = parent.find('.js-accordion__content')\r\n\t\t\t\t\t\t\tvar toggler = parent.find('.js-accordion__toggler')\r\n\t\t\t\t\t\t\tvar maxWidth = parseInt(parent.data('maxWidth'))\r\n\t\t\t\t\t\t\tmaxWidth = View.winHaveScroll ? maxWidth - View.scrollBarWidth : maxWidth\r\n\r\n\t\t\t\t\t\t\tif (win.width() <= maxWidth) {\r\n\t\t\t\t\t\t\t\t// инициализация и закрытие всех аккордионов кроме тех что с классом open-accordion\r\n\t\t\t\t\t\t\t\tif (!parent.hasClass('open-accordion')) content.slideUp(0)\r\n\t\t\t\t\t\t\t\tparent.addClass('init-accordion')\r\n\t\t\t\t\t\t\t\tparent.removeClass('destroy-accordion')\r\n\r\n\t\t\t\t\t\t\t\ttoggler.off('click.toggleAccordion').on('click.toggleAccordion', function (event) {\r\n\t\t\t\t\t\t\t\t\tevent.stopPropagation()\r\n\t\t\t\t\t\t\t\t\tevent.preventDefault()\r\n\r\n\t\t\t\t\t\t\t\t\t// View.control.closeAll(['closeAllAccordionAdaptive'])\r\n\t\t\t\t\t\t\t\t\tView.control.closeAll()\r\n\r\n\t\t\t\t\t\t\t\t\tparent.toggleClass('open-accordion')\r\n\t\t\t\t\t\t\t\t\tcontent.slideToggle(300)\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// accordion destroy\r\n\t\t\t\t\t\t\t\tparent.removeClass('init-accordion')\r\n\t\t\t\t\t\t\t\tparent.removeClass('open-accordion')\r\n\t\t\t\t\t\t\t\tparent.addClass('destroy-accordion')\r\n\t\t\t\t\t\t\t\tcontent.slideDown(0)\r\n\r\n\t\t\t\t\t\t\t\ttoggler.off('click.toggleAccordion')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t// View.init.global.toggleAccordionOnlyAdaptive.closeAllAccordionAdaptive = function () {\r\n\t\t\t\t\t\t// \tallParents.removeClass('open-accordion')\r\n\t\t\t\t\t\t// \tallParents.find('.js-accordion__content').slideUp(300)\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\twin.off('resize.toggleAccordionOnlyAdaptive')\r\n\t\t\t\t\t\t.on('resize.toggleAccordionOnlyAdaptive', function () {\r\n\t\t\t\t\t\t\tclearTimeout(timeout);\r\n\t\t\t\t\t\t\ttimeout = setTimeout(toggleAccordionOnlyAdaptive, 300);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.trigger('resize.toggleAccordionOnlyAdaptive');\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// переключение класса по наведению\r\n\t\t\t\ttoggleClassByHover() {\r\n\t\t\t\t\tvar allItems = $('.js-class-hover')\r\n\t\t\t\t\tvar parent = $('.js-class-hover-parent')\r\n\t\t\t\t\tvar timeout = null\r\n\r\n\t\t\t\t\tallItems.each(function () {\r\n\t\t\t\t\t\tvar item = $(this)\r\n\t\t\t\t\t\tvar itemClass = item.data('class')\r\n\r\n\t\t\t\t\t\t// обработка прихода курсора на элемента\r\n\t\t\t\t\t\titem.off('mouseenter.toggleClassByHover').on('mouseenter.toggleClassByHover', function () {\r\n\t\t\t\t\t\t\tclearTimeout(timeout)\r\n\t\t\t\t\t\t\ttimeout = setTimeout(function () {\r\n\t\t\t\t\t\t\t\tif (!item.parents('.flexMenu-viewMore').length) {\r\n\t\t\t\t\t\t\t\t\tbody.addClass(itemClass);\r\n\t\t\t\t\t\t\t\t\titem.addClass(itemClass);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}, 600)\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// обработка ухода курсора с элемента\r\n\t\t\t\t\t\titem.off('mouseleave.toggleClassByHover').on('mouseleave.toggleClassByHover', function () {\r\n\t\t\t\t\t\t\tclearTimeout(timeout)\r\n\t\t\t\t\t\t\ttimeout = setTimeout(function () {\r\n\t\t\t\t\t\t\t\tbody.removeClass(itemClass);\r\n\t\t\t\t\t\t\t\titem.removeClass(itemClass);\r\n\t\t\t\t\t\t\t}, 600)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\t// обработка ухода курсора со всего меню\r\n\t\t\t\t\tparent.off('mouseleave.toggleClassByHover').on('mouseleave.toggleClassByHover', function () {\r\n\t\t\t\t\t\tclearTimeout(timeout)\r\n\t\t\t\t\t\tvar itemClass = parent.data('class')\r\n\t\t\t\t\t\tbody.removeClass(itemClass);\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// мобильное меню каталога в гамбургере\r\n\t\t\t\tmobileMenu() {\r\n\t\t\t\t\tvar $hamburgerMenuContainer = $('.js-hamburger-menu-container')\r\n\t\t\t\t\tvar $hamburgerMenuAll = $('.js-hamburger-menu')\r\n\t\t\t\t\tvar $hamburgerMenuTogglesAll = $hamburgerMenuAll.find('.js-hamburger-menu__link');\r\n\r\n\t\t\t\t\t$hamburgerMenuAll.each(function () {\r\n\t\t\t\t\t\tvar $hamburgerMenu = $(this)\r\n\t\t\t\t\t\tvar $hamburgerMenuToggles = $hamburgerMenu.find('.js-hamburger-menu__link');\r\n\t\t\t\t\t\tvar $hamburgerSubLists = $hamburgerMenu.find('.js-hamburger-menu__sub-list')\r\n\r\n\t\t\t\t\t\t$hamburgerMenuToggles.off('click.hamburger').on('click.hamburger', function (e) {\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\tvar $self = $(this);\r\n\r\n\t\t\t\t\t\t\t$hamburgerMenuContainer.scrollTop(0)\r\n\t\t\t\t\t\t\t$hamburgerSubLists.scrollTop(0)\r\n\r\n\t\t\t\t\t\t\t$hamburgerMenu.addClass('open');\r\n\t\t\t\t\t\t\t$self.addClass('open');\r\n\t\t\t\t\t\t\t$self.next('.js-hamburger-menu__sub-list')\r\n\t\t\t\t\t\t\t\t.find('.js-hamburger-menu__btn-back').off('click.hamburger').on('click.hamburger', function () {\r\n\t\t\t\t\t\t\t\t$self.removeClass('open');\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\t// закрыть уровни мобильного меню каталога\r\n\t\t\t\t\tView.init.global.mobileMenu.closeAll = function () {\r\n\t\t\t\t\t\t$hamburgerMenuAll.removeClass('open');\r\n\t\t\t\t\t\t$hamburgerMenuTogglesAll.removeClass('open');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// инициализация карусели (Swiper)\r\n\t\t\t\tinitCarousel() {\r\n\t\t\t\t\tif (window.Swiper) {\r\n\t\t\t\t\t\tvar timeout = null\r\n\r\n\t\t\t\t\t\t// инициализация слайдера если он в зоне видимости или приближается к ней (ближе 500рх) и до сих пор не инициализирован\r\n\t\t\t\t\t\tfunction initSwiper(elemJQ, optionSwiper) {\r\n\t\t\t\t\t\t\tif (!elemJQ.hasClass('swiper-container-initialized') && View.getVisibleElemOnScroll(elemJQ, 500)) {\r\n\t\t\t\t\t\t\t\t// переопределение параметров слайдера переданных в атрибуте компонента\r\n\t\t\t\t\t\t\t\tvar options = elemJQ.data('options')\r\n\t\t\t\t\t\t\t\tif (options) {\r\n\t\t\t\t\t\t\t\t\tObject.keys(options).forEach((key) => {\r\n\t\t\t\t\t\t\t\t\t\tif (typeof options[key] !== 'undefined') {\r\n\t\t\t\t\t\t\t\t\t\t\toptionSwiper[key] = options[key];\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tconsole.log('options', optionSwiper)\r\n\r\n\t\t\t\t\t\t\t\treturn new Swiper(elemJQ[0], optionSwiper)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// добаления класса если ширины всех слайдов не достаточно для скролла\r\n\t\t\t\t\t\tfunction toggleClassSwiper(parent, widthAllItems) {\r\n\t\t\t\t\t\t\tparent.toggleClass('swiper-empty', 'parent.width() > widthAllItems')\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// ******************************************************************************\r\n\t\t\t\t\t\tvar optionSwiper = {\r\n\t\t\t\t\t\t\tautoHeight: true,\r\n\t\t\t\t\t\t\t// infinity scroll\r\n\t\t\t\t\t\t\tloop: true,\r\n\r\n\t\t\t\t\t\t\t// lazy load images\r\n\t\t\t\t\t\t\twatchSlidesVisibility: true,\r\n\t\t\t\t\t\t\tlazy: {\r\n\t\t\t\t\t\t\t\tloadPrevNext: true,\r\n\t\t\t\t\t\t\t\tloadOnTransitionStart: true,\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\tnavigation: {\r\n\t\t\t\t\t\t\t\tnextEl: '.swiper-button-next',\r\n\t\t\t\t\t\t\t\tprevEl: '.swiper-button-prev',\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\tpagination: {\r\n\t\t\t\t\t\t\t\tel: '.swiper-pagination',\r\n\t\t\t\t\t\t\t\ttype: 'bullets',\r\n\t\t\t\t\t\t\t\tclickable: true,\r\n\t\t\t\t\t\t\t\t// dynamicBullets: true,\r\n\t\t\t\t\t\t\t\t// dynamicMainBullets: 7,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// одиночная карусель\r\n\t\t\t\t\t\tfunction initSingleSwiper() {\r\n\t\t\t\t\t\t\tinitSwiper($('.js-carousel--main-banner'), optionSwiper)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\twin.off('scroll.initSingleSwiper').on('scroll.initSingleSwiper', initSingleSwiper)\r\n\t\t\t\t\t\twin.trigger('scroll.initSingleSwiper')\r\n\r\n\r\n\t\t\t\t\t\t// ******************************************************************************\r\n\t\t\t\t\t\tvar optionSwiperArticles = {\r\n\t\t\t\t\t\t\tautoHeight: true,\r\n\t\t\t\t\t\t\t// infinity scroll\r\n\t\t\t\t\t\t\tloop: true,\r\n\r\n\t\t\t\t\t\t\t// lazy load images\r\n\t\t\t\t\t\t\twatchSlidesVisibility: true,\r\n\t\t\t\t\t\t\tlazy: {\r\n\t\t\t\t\t\t\t\tloadPrevNext: true,\r\n\t\t\t\t\t\t\t\tloadOnTransitionStart: true,\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t// Responsive breakpoints\r\n\t\t\t\t\t\t\tbreakpoints: {\r\n\t\t\t\t\t\t\t\t320: {\r\n\t\t\t\t\t\t\t\t\tslidesPerView: 1,\r\n\t\t\t\t\t\t\t\t\tslidesPerGroup: 1,\r\n\t\t\t\t\t\t\t\t\tautoHeight: true,\r\n\t\t\t\t\t\t\t\t\tspaceBetween: 0,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t450: {\r\n\t\t\t\t\t\t\t\t\tslidesPerView: 2,\r\n\t\t\t\t\t\t\t\t\tslidesPerGroup: 2,\r\n\t\t\t\t\t\t\t\t\tautoHeight: false,\r\n\t\t\t\t\t\t\t\t\tspaceBetween: 10,\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\tpagination: {\r\n\t\t\t\t\t\t\t\tel: '.swiper-pagination',\r\n\t\t\t\t\t\t\t\ttype: 'bullets',\r\n\t\t\t\t\t\t\t\tclickable: true,\r\n\t\t\t\t\t\t\t\t// dynamicBullets: true,\r\n\t\t\t\t\t\t\t\t// dynamicMainBullets: 7,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// одиночная карусель\r\n\t\t\t\t\t\tfunction initSingleSwiperArticles() {\r\n\t\t\t\t\t\t\tinitSwiper($('.js-carousel--articles'), optionSwiperArticles)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\twin.off('scroll.initSingleSwiperArticles').on('scroll.initSingleSwiperArticles', initSingleSwiperArticles)\r\n\t\t\t\t\t\twin.trigger('scroll.initSingleSwiperArticles')\r\n\r\n\t\t\t\t\t\t// *******************************************************************************\r\n\r\n\t\t\t\t\t\t// повторяющаяся карусель\r\n\t\t\t\t\t\tvar optionSwiperRepeat = {\r\n\t\t\t\t\t\t\t// Разрешить отпускать сенсорные события в положении края ползунка (начало, конец)\r\n\t\t\t\t\t\t\ttouchReleaseOnEdges: true,\r\n\r\n\t\t\t\t\t\t\t// lazy load images\r\n\t\t\t\t\t\t\twatchSlidesVisibility: true,\r\n\t\t\t\t\t\t\tlazy: {\r\n\t\t\t\t\t\t\t\tloadPrevNext: true,\r\n\t\t\t\t\t\t\t\tloadOnTransitionStart: true,\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t// infinity scroll\r\n\t\t\t\t\t\t\t// loop: true,\r\n\t\t\t\t\t\t\t// loopedSlides: 5,\r\n\t\t\t\t\t\t\t// loopAdditionalSlides: 5,\r\n\r\n\t\t\t\t\t\t\t// инертность свайпа слайдов\r\n\t\t\t\t\t\t\t// freeMode: true,\r\n\t\t\t\t\t\t\t// freeModeSticky: true,\r\n\r\n\t\t\t\t\t\t\t// Responsive breakpoints\r\n\t\t\t\t\t\t\tbreakpoints: {\r\n\t\t\t\t\t\t\t\t320: {\r\n\t\t\t\t\t\t\t\t\tslidesPerView: 1,\r\n\t\t\t\t\t\t\t\t\tslidesPerGroup: 1,\r\n\t\t\t\t\t\t\t\t\t// autoHeight: true,\r\n\t\t\t\t\t\t\t\t\tspaceBetween: 0,\r\n\t\t\t\t\t\t\t\t\tpagination: {\r\n\t\t\t\t\t\t\t\t\t\tdynamicBullets: true,\r\n\t\t\t\t\t\t\t\t\t\tdynamicMainBullets: 7,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t430: {\r\n\t\t\t\t\t\t\t\t\tslidesPerView: 2,\r\n\t\t\t\t\t\t\t\t\tslidesPerGroup: 2,\r\n\t\t\t\t\t\t\t\t\tspaceBetween: 20,\r\n\t\t\t\t\t\t\t\t\tpagination: {\r\n\t\t\t\t\t\t\t\t\t\tdynamicBullets: false,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t645: {\r\n\t\t\t\t\t\t\t\t\tslidesPerView: 3,\r\n\t\t\t\t\t\t\t\t\tslidesPerGroup: 3,\r\n\t\t\t\t\t\t\t\t\tspaceBetween: 20,\r\n\t\t\t\t\t\t\t\t\tpagination: {\r\n\t\t\t\t\t\t\t\t\t\tdynamicBullets: false,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t880: {\r\n\t\t\t\t\t\t\t\t\tslidesPerView: 4,\r\n\t\t\t\t\t\t\t\t\tslidesPerGroup: 4,\r\n\t\t\t\t\t\t\t\t\tspaceBetween: 20,\r\n\t\t\t\t\t\t\t\t\tpagination: {\r\n\t\t\t\t\t\t\t\t\t\tdynamicBullets: false,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t1025: {\r\n\t\t\t\t\t\t\t\t\tslidesPerView: 4,\r\n\t\t\t\t\t\t\t\t\tslidesPerGroup: 4,\r\n\t\t\t\t\t\t\t\t\tspaceBetween: -32,\r\n\t\t\t\t\t\t\t\t\tpagination: {\r\n\t\t\t\t\t\t\t\t\t\tdynamicBullets: false,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t1220: {\r\n\t\t\t\t\t\t\t\t\tslidesPerView: 5,\r\n\t\t\t\t\t\t\t\t\tslidesPerGroup: 5,\r\n\t\t\t\t\t\t\t\t\tspaceBetween: -32,\r\n\t\t\t\t\t\t\t\t\tpagination: {\r\n\t\t\t\t\t\t\t\t\t\tdynamicBullets: false,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\tnavigation: {\r\n\t\t\t\t\t\t\t\tnextEl: '.swiper-button-next',\r\n\t\t\t\t\t\t\t\tprevEl: '.swiper-button-prev',\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\tpagination: {\r\n\t\t\t\t\t\t\t\tel: '.swiper-pagination',\r\n\t\t\t\t\t\t\t\ttype: 'bullets',\r\n\t\t\t\t\t\t\t\tclickable: true,\r\n\t\t\t\t\t\t\t\tdynamicBullets: false,\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\ton: {\r\n\t\t\t\t\t\t\t\tbreakpoint: function (swiper) {\r\n\t\t\t\t\t\t\t\t\tif (swiper.params.pagination.dynamicBullets) {\r\n\t\t\t\t\t\t\t\t\t\tswiper.pagination.init()\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\t\t\t\t\tswiper.pagination.el.style.width = '100%'\r\n\t\t\t\t\t\t\t\t\t\t\tswiper.pagination.el.classList.remove('swiper-pagination-bullets-dynamic')\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t$('.js-carousel--repeat').each(function (ind) {\r\n\t\t\t\t\t\t\tvar carouselElemJQ = $(this)\r\n\r\n\t\t\t\t\t\t\tfunction initSwiper_repeat() {\r\n\t\t\t\t\t\t\t\tinitSwiper(carouselElemJQ, optionSwiperRepeat)\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\twin.off('scroll.initSwiper_repeat_' + ind).on('scroll.initSwiper_repeat_' + ind, initSwiper_repeat)\r\n\t\t\t\t\t\t\twin.trigger('scroll.initSwiper_repeat_' + ind)\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t// *******************************************************************************\r\n\r\n\t\t\t\t\t\t// повторяющаяся карусель в скрытых табах\r\n\t\t\t\t\t\tvar optionSwiperRepeatTabs = {\r\n\t\t\t\t\t\t\t// lazy load images\r\n\t\t\t\t\t\t\twatchSlidesVisibility: true,\r\n\t\t\t\t\t\t\tlazy: {\r\n\t\t\t\t\t\t\t\tloadPrevNext: true,\r\n\t\t\t\t\t\t\t\tloadOnTransitionStart: true,\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t// если родительский контейнер не виден (display none)\r\n\t\t\t\t\t\t\tobserver: true,\r\n\t\t\t\t\t\t\tobserveParents: true,\r\n\r\n\t\t\t\t\t\t\t// infinity scroll\r\n\t\t\t\t\t\t\t// loop: true,\r\n\t\t\t\t\t\t\t// loopedSlides: 5,\r\n\t\t\t\t\t\t\t// loopAdditionalSlides: 5,\r\n\r\n\t\t\t\t\t\t\t// инертность свайпа слайдов\r\n\t\t\t\t\t\t\t// freeMode: true,\r\n\t\t\t\t\t\t\t// freeModeSticky: true,\r\n\r\n\t\t\t\t\t\t\t// Responsive breakpoints\r\n\t\t\t\t\t\t\tbreakpoints: {\r\n\t\t\t\t\t\t\t\t320: {\r\n\t\t\t\t\t\t\t\t\tslidesPerView: 1,\r\n\t\t\t\t\t\t\t\t\tslidesPerGroup: 1,\r\n\t\t\t\t\t\t\t\t\t// autoHeight: true,\r\n\t\t\t\t\t\t\t\t\tspaceBetween: 0,\r\n\t\t\t\t\t\t\t\t\tpagination: {\r\n\t\t\t\t\t\t\t\t\t\tdynamicBullets: true,\r\n\t\t\t\t\t\t\t\t\t\tdynamicMainBullets: 7,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t430: {\r\n\t\t\t\t\t\t\t\t\tslidesPerView: 2,\r\n\t\t\t\t\t\t\t\t\tslidesPerGroup: 2,\r\n\t\t\t\t\t\t\t\t\tspaceBetween: 20,\r\n\t\t\t\t\t\t\t\t\tpagination: {\r\n\t\t\t\t\t\t\t\t\t\tdynamicBullets: false,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t645: {\r\n\t\t\t\t\t\t\t\t\tslidesPerView: 3,\r\n\t\t\t\t\t\t\t\t\tslidesPerGroup: 3,\r\n\t\t\t\t\t\t\t\t\tspaceBetween: 20,\r\n\t\t\t\t\t\t\t\t\tpagination: {\r\n\t\t\t\t\t\t\t\t\t\tdynamicBullets: false,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t880: {\r\n\t\t\t\t\t\t\t\t\tslidesPerView: 4,\r\n\t\t\t\t\t\t\t\t\tslidesPerGroup: 4,\r\n\t\t\t\t\t\t\t\t\tspaceBetween: 20,\r\n\t\t\t\t\t\t\t\t\tpagination: {\r\n\t\t\t\t\t\t\t\t\t\tdynamicBullets: false,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t1025: {\r\n\t\t\t\t\t\t\t\t\tslidesPerView: 4,\r\n\t\t\t\t\t\t\t\t\tslidesPerGroup: 4,\r\n\t\t\t\t\t\t\t\t\tspaceBetween: -32,\r\n\t\t\t\t\t\t\t\t\tpagination: {\r\n\t\t\t\t\t\t\t\t\t\tdynamicBullets: false,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t1220: {\r\n\t\t\t\t\t\t\t\t\tslidesPerView: 5,\r\n\t\t\t\t\t\t\t\t\tslidesPerGroup: 5,\r\n\t\t\t\t\t\t\t\t\tspaceBetween: -32,\r\n\t\t\t\t\t\t\t\t\tpagination: {\r\n\t\t\t\t\t\t\t\t\t\tdynamicBullets: false,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\tnavigation: {\r\n\t\t\t\t\t\t\t\tnextEl: '.swiper-button-next',\r\n\t\t\t\t\t\t\t\tprevEl: '.swiper-button-prev',\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\tpagination: {\r\n\t\t\t\t\t\t\t\tel: '.swiper-pagination',\r\n\t\t\t\t\t\t\t\ttype: 'bullets',\r\n\t\t\t\t\t\t\t\tclickable: true,\r\n\t\t\t\t\t\t\t\tdynamicBullets: false,\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\ton: {\r\n\t\t\t\t\t\t\t\t// переключение динамических (прятающихся) буллетов на разных брэйкпойнтах\r\n\t\t\t\t\t\t\t\tbreakpoint: function (swiper) {\r\n\t\t\t\t\t\t\t\t\tif (swiper.params.pagination.dynamicBullets) {\r\n\t\t\t\t\t\t\t\t\t\tswiper.pagination.init()\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\t\t\t\t\tswiper.pagination.el.style.width = '100%'\r\n\t\t\t\t\t\t\t\t\t\t\tswiper.pagination.el.classList.remove('swiper-pagination-bullets-dynamic')\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t$('.js-carousel--repeat-tabs').each(function (ind) {\r\n\t\t\t\t\t\t\tvar carouselElemJQ = $(this)\r\n\r\n\t\t\t\t\t\t\tfunction initSwiper_repeat() {\r\n\t\t\t\t\t\t\t\tinitSwiper(carouselElemJQ, optionSwiperRepeatTabs)\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\twin.off('scroll.initSwiper_repeat_' + ind).on('scroll.initSwiper_repeat_' + ind, initSwiper_repeat)\r\n\t\t\t\t\t\t\twin.trigger('scroll.initSwiper_repeat_' + ind)\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t//\t******************************************************************************\r\n\r\n\t\t\t\t\t\t// карусель с навигацией\r\n\t\t\t\t\t\tvar navCarousel = initSwiper($('.js-carousel-w-nav--navigation'), {\r\n\t\t\t\t\t\t\tdirection: 'vertical',\r\n\t\t\t\t\t\t\tspaceBetween: 12,\r\n\t\t\t\t\t\t\tslidesPerView: 5,\r\n\r\n\t\t\t\t\t\t\t// lazy load images\r\n\t\t\t\t\t\t\twatchSlidesProgress: true,\r\n\t\t\t\t\t\t\twatchSlidesVisibility: true,\r\n\t\t\t\t\t\t\tlazy: {\r\n\t\t\t\t\t\t\t\tloadPrevNext: true,\r\n\t\t\t\t\t\t\t\tloadOnTransitionStart: true,\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t// Responsive breakpoints\r\n\t\t\t\t\t\t\tbreakpoints: {\r\n\t\t\t\t\t\t\t\t310: {\r\n\t\t\t\t\t\t\t\t\tslidesPerView: 4,\r\n\t\t\t\t\t\t\t\t\tdirection: 'horizontal',\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t400: {\r\n\t\t\t\t\t\t\t\t\tslidesPerView: 5,\r\n\t\t\t\t\t\t\t\t\tdirection: 'horizontal',\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t600: {\r\n\t\t\t\t\t\t\t\t\tslidesPerView: 5,\r\n\t\t\t\t\t\t\t\t\tdirection: 'vertical',\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tinitSwiper($('.js-carousel-w-nav--main'), {\r\n\t\t\t\t\t\t\teffect: 'fade',\r\n\r\n\t\t\t\t\t\t\t// infinity scroll\r\n\t\t\t\t\t\t\t// loop: true,\r\n\r\n\t\t\t\t\t\t\t// lazy load images\r\n\t\t\t\t\t\t\tlazy: {\r\n\t\t\t\t\t\t\t\tloadPrevNext: true,\r\n\t\t\t\t\t\t\t\tloadOnTransitionStart: true,\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\tthumbs: {\r\n\t\t\t\t\t\t\t\tswiper: navCarousel\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\tnavigation: {\r\n\t\t\t\t\t\t\t\tnextEl: '.js-swiper-w-nav-button-next',\r\n\t\t\t\t\t\t\t\tprevEl: '.js-swiper-w-nav-button-prev',\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\ton: {\r\n\t\t\t\t\t\t\t\tslideChangeTransitionEnd: function () {\r\n\t\t\t\t\t\t\t\t\t// остановка предыдущего видео youtube iframe при его наличии\r\n\t\t\t\t\t\t\t\t\tif (View.youtubeVideoPlayed) {\r\n\t\t\t\t\t\t\t\t\t\tView.callYuotubeIframePlayer(View.youtubeVideoPlayed, 'pauseVideo')\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t// запуск видео youtube iframe в слайде\r\n\t\t\t\t\t\t\t\t\tView.youtubeVideoPlayed = $(this.slides).filter('.swiper-slide-active').find('iframe')[0]\r\n\t\t\t\t\t\t\t\t\tView.callYuotubeIframePlayer(View.youtubeVideoPlayed, 'playVideo')\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// подскролл страницы в начала по клику на кнопку\r\n\t\t\t\tscrollTop() {\r\n\t\t\t\t\tvar btn = $('.js-scroll-top')\r\n\r\n\t\t\t\t\tView.showElemAfterScroll(btn, win.height())\r\n\r\n\t\t\t\t\tbtn.off('click.scrollTop').on('click.scrollTop', function (event) {\r\n\t\t\t\t\t\tevent.preventDefault()\r\n\t\t\t\t\t\thtmlbody.animate({scrollTop: 0}, 400)\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// фиксация блока при скролле страницы\r\n\t\t\t\tfixedBlockWhenScrolling() {\r\n\t\t\t\t\t$('.js-fixed--up').each(function (index) {\r\n\t\t\t\t\t\tvar block = $(this)\r\n\t\t\t\t\t\tvar content = block.find('.js-fixed__content')\r\n\t\t\t\t\t\tvar blockHeight = content.outerHeight()\r\n\t\t\t\t\t\tvar blockStart = block.offset().top\r\n\t\t\t\t\t\tvar doc = $(document)\r\n\r\n\t\t\t\t\t\tfunction fixedBlockWhenScrolling() {\r\n\t\t\t\t\t\t\tvar docScroll = doc.scrollTop()\r\n\r\n\t\t\t\t\t\t\t// фиксация блока\r\n\t\t\t\t\t\t\tif (!block.hasClass('active-fixed') && blockStart <= docScroll) {\r\n\t\t\t\t\t\t\t\tdoc.addClass('active-fixed')\r\n\t\t\t\t\t\t\t\tblock.addClass('active-fixed').css('padding-top', blockHeight)\r\n\t\t\t\t\t\t\t} else if (block.hasClass('active-fixed') && blockStart > docScroll) {\r\n\t\t\t\t\t\t\t\t// отмена фиксации блока\r\n\t\t\t\t\t\t\t\tdoc.removeClass('active-fixed')\r\n\t\t\t\t\t\t\t\tblock.removeClass('active-fixed')\r\n\t\t\t\t\t\t\t\t// block.removeClass('active-fixed').css('padding-top', 0)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tblock.css('padding-top', blockHeight).addClass('init-fixed')\r\n\t\t\t\t\t\tfixedBlockWhenScrolling()\r\n\r\n\t\t\t\t\t\t// инициализаци с индексом на случай множественных блоков для фиксации\r\n\t\t\t\t\t\twin.off('resize.fixedBlockWhenScrolling' + index)\r\n\t\t\t\t\t\t\t.on('resize.fixedBlockWhenScrolling' + index, function () {\r\n\t\t\t\t\t\t\t\tblockHeight = content.outerHeight()\r\n\t\t\t\t\t\t\t\tblockStart = block.offset().top\r\n\t\t\t\t\t\t\t\tblock.css('padding-top', blockHeight)\r\n\r\n\t\t\t\t\t\t\t\tif (requestAnimationFrame) requestAnimationFrame(fixedBlockWhenScrolling)\r\n\t\t\t\t\t\t\t\telse fixedBlockWhenScrolling();\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\tdoc.off('scroll.fixedBlockWhenScrolling' + index)\r\n\t\t\t\t\t\t\t.on('scroll.fixedBlockWhenScrolling' + index, function () {\r\n\t\t\t\t\t\t\t\tif (requestAnimationFrame) requestAnimationFrame(fixedBlockWhenScrolling)\r\n\t\t\t\t\t\t\t\telse fixedBlockWhenScrolling();\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// сворачивание лишних пунктов меню в аккордион с кнопкой \"еще\"\r\n\t\t\t\tcollapsibleMenu() {\r\n\t\t\t\t\t$('.js-collapsible').each(function () {\r\n\t\t\t\t\t\tvar parent = $(this)\r\n\t\t\t\t\t\tvar items = parent.find('.js-collapsible__item')\r\n\t\t\t\t\t\tvar quantity = parent.data('collapsible')\r\n\r\n\t\t\t\t\t\t// если елементов больше разрешенных и родитель не имеет класса инициализации свернуть лишние элементы в аккордион\r\n\t\t\t\t\t\tif (items.length > quantity && !parent.hasClass('init-collapsible')) {\r\n\t\t\t\t\t\t\tparent.addClass('init-collapsible')\r\n\r\n\t\t\t\t\t\t\t// добавление разметки для аккордионов\r\n\t\t\t\t\t\t\tvar accordion = $('<div class=\"js-accordion\"><div class=\"collapsible-menu__toggler  js-accordion__toggler\">Еще <span>' + (items.length - quantity) + '</span></div></div>')\r\n\t\t\t\t\t\t\tvar accordionContent = $('<div class=\"js-accordion__content\"></div>')\r\n\r\n\t\t\t\t\t\t\t// пробегаем по всем элементам перенося лишние в аккордион\r\n\t\t\t\t\t\t\titems.each(function (index) {\r\n\t\t\t\t\t\t\t\tif (index + 1 > quantity) {\r\n\t\t\t\t\t\t\t\t\taccordionContent.append($(this))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t// вставляем и инициализируем итоговый аккордион в родитель\r\n\t\t\t\t\t\t\taccordion.append(accordionContent)\r\n\t\t\t\t\t\t\tparent.append(accordion)\r\n\t\t\t\t\t\t\tView.init.local.toggleAccordion()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// обрезка длинного текста точками\r\n\t\t\t\tclipText() {\r\n\t\t\t\t\tif ($.fn.dotdotdot && !View.isIE) {\r\n\t\t\t\t\t\t$('.js-dots-text').dotdotdot({\r\n\t\t\t\t\t\t\tellipsis: '...',\r\n\t\t\t\t\t\t\twrap: 'letter',\r\n\t\t\t\t\t\t\tfallbackToLetter: false,\r\n\t\t\t\t\t\t\tafter: '',\r\n\t\t\t\t\t\t\twatch: window,\r\n\t\t\t\t\t\t\theight: null,\r\n\t\t\t\t\t\t\ttolerance: 0,\r\n\t\t\t\t\t\t\tcallback: function (isTruncated, orgContent) {\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tlastCharacter: {\r\n\t\t\t\t\t\t\t\tremove: [' ', ',', ';', '.', '!', '?'],\r\n\t\t\t\t\t\t\t\tnoEllipsis: []\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// поля для промежутка цены в фильтре\r\n\t\t\t\tsetRangeInputs() {\r\n\t\t\t\t\t$('.js-range').each(function () {\r\n\t\t\t\t\t\tvar parent = $(this)\r\n\t\t\t\t\t\tvar inputs = parent.find('.js-range__input')\r\n\r\n\t\t\t\t\t\tinputs.off('keyup')\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// скролл к блоку по ссылке\r\n\t\t\t\tscrollToBlock() {\r\n\t\t\t\t\t$('.js-scroll-to').each(function () {\r\n\t\t\t\t\t\tvar _this = $(this)\r\n\r\n\t\t\t\t\t\t_this.off('click.scrollToBlock').on('click.scrollToBlock', function (event) {\r\n\t\t\t\t\t\t\tevent.preventDefault()\r\n\r\n\t\t\t\t\t\t\t// величина недоезда блока до верха в атрибуте ссылки\r\n\t\t\t\t\t\t\tvar offset = $(_this).data('offset') || 0\r\n\t\t\t\t\t\t\t// ID блока до, которого скролить\r\n\t\t\t\t\t\t\tvar block = $(_this.attr('href'))\r\n\t\t\t\t\t\t\tif (block.length) {\r\n\t\t\t\t\t\t\t\tvar positionBlock = block.offset().top - offset\r\n\r\n\t\t\t\t\t\t\t\t$([document.documentElement, document.body]).animate({scrollTop: positionBlock}, 400)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// блокировать всплытие события скролла на элементе\r\n\t\t\t\tlockScroll() {\r\n\t\t\t\t\tif ($.fn.scrollLock) {\r\n\t\t\t\t\t\t$('.js-lock-scroll').scrollLock({\r\n\t\t\t\t\t\t\tunblock: '.js-lock-scroll__unlock'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// поведение попапов\r\n\t\t\t\tinitPopups() {\r\n\t\t\t\t\tif ($.fn.fancybox) {\r\n\t\t\t\t\t\tvar popups = $('[data-fancybox]')\r\n\r\n\t\t\t\t\t\tif (popups.length) {\r\n\t\t\t\t\t\t\tpopups.fancybox({\r\n\t\t\t\t\t\t\t\thash: false,\r\n\r\n\t\t\t\t\t\t\t\t// кнопки на панели\r\n\t\t\t\t\t\t\t\tbuttons: [\r\n\t\t\t\t\t\t\t\t\t// 'zoom',\r\n\t\t\t\t\t\t\t\t\t// 'share',\r\n\t\t\t\t\t\t\t\t\t'slideShow',\r\n\t\t\t\t\t\t\t\t\t'fullScreen',\r\n\t\t\t\t\t\t\t\t\t// 'download',\r\n\t\t\t\t\t\t\t\t\t'thumbs',\r\n\t\t\t\t\t\t\t\t\t'close'\r\n\t\t\t\t\t\t\t\t],\r\n\r\n\t\t\t\t\t\t\t\t// панель миниатюр\r\n\t\t\t\t\t\t\t\tthumbs: {\r\n\t\t\t\t\t\t\t\t\tautoStart: true\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\tajax: {\r\n\t\t\t\t\t\t\t\t\t// Object containing settings for ajax request\r\n\t\t\t\t\t\t\t\t\tsettings: {\r\n\t\t\t\t\t\t\t\t\t\ttransitionEffect: false,\r\n\t\t\t\t\t\t\t\t\t\t// This helps to indicate that request comes from the modal\r\n\t\t\t\t\t\t\t\t\t\t// Feel free to change naming\r\n\t\t\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\t\t\ttransitionEffect: false\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tbeforeShow: function () {\r\n\t\t\t\t\t\t\t\t\t// компенсация скролла\r\n\t\t\t\t\t\t\t\t\tbody.css({paddingRight: View.scrollBarWidth + 'px'})\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t// переинициализация скриптов в попапе\r\n\t\t\t\t\t\t\t\tafterShow: function (instance, slide) {\r\n\t\t\t\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\t\t\t\tView.initAllLocal(instance.current.$content)\r\n\r\n\t\t\t\t\t\t\t\t\t\tinstance.current.$content.find('.js-close-all').off('click.closePopup').on('click.closePopup', function (e) {\r\n\t\t\t\t\t\t\t\t\t\t\t$.fancybox.close();\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t\t\t\t// при наличии атрибута инициализирует карту в попапе\r\n\t\t\t\t\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\t\t\t\t\tif (instance.$trigger.attr('data-map')) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (window.ymaps && window.ymaps.Map) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tView.initMaps()\r\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tView.init.global.initMapsDelayScroll()\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tafterClose: function () {\r\n\t\t\t\t\t\t\t\t\tbody.css({paddingRight: 0})\r\n\t\t\t\t\t\t\t\t\tView.initAllGlobal();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// закрыть попап по кнопке на всплатии\r\n\t\t\t\t\t\t$(document).off('click.closePopup').on('click.closePopup', '.js-close-popup', function () {\r\n\t\t\t\t\t\t\t$.fancybox.close();\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// повесить класс, если хотябы один чекбокс отмечен\r\n\t\t\t\tcheckAnyCheckbox() {\r\n\t\t\t\t\t$('.js-check-any').each(function () {\r\n\t\t\t\t\t\tvar parent = $(this)\r\n\t\t\t\t\t\tvar toggler = parent.find('.js-check-any__toggler')\r\n\t\t\t\t\t\tvar checkboxes = parent.find('.js-check-any__checkbox')\r\n\r\n\t\t\t\t\t\tcheckboxes.off('change.checkAnyCheckbox').on('change.checkAnyCheckbox', function () {\r\n\t\t\t\t\t\t\tif (Array.from(checkboxes).some((elem) => $(elem).prop('checked'))) {\r\n\t\t\t\t\t\t\t\tparent.addClass('active')\r\n\t\t\t\t\t\t\t\ttoggler.addClass('active')\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tparent.removeClass('active')\r\n\t\t\t\t\t\t\t\ttoggler.removeClass('active')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// инициализация позиционирования, не выходящего за контентную область\r\n\t\t\t\ttooltipPosition() {\r\n\t\t\t\t\tvar tooltips;\r\n\t\t\t\t\tvar delta;\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tvar containerPadding;\r\n\t\t\t\t\tvar timeout = null;\r\n\r\n\t\t\t\t\t// вычисление положения\r\n\t\t\t\t\tView.init.global.tooltipPosition.calcPosition = function () {\r\n\t\t\t\t\t\ttooltips = $('.js-tooltip-position');\r\n\t\t\t\t\t\ttooltips.css('marginLeft', '');\r\n\r\n\t\t\t\t\t\t// ширина паддинга контейнера страницы\r\n\t\t\t\t\t\tcontainerPadding = window.innerWidth > View.breakpoints['xs-max'] ? 20 : 10;\r\n\t\t\t\t\t\tcontainerPadding = window.innerWidth > View.breakpoints['sm-max'] ? 20 : containerPadding;\r\n\r\n\t\t\t\t\t\tfor (i = 0; i < tooltips.length; i++) {\r\n\t\t\t\t\t\t\t// насколько выступает правый край выпадашки за границы контейнера страницы\r\n\t\t\t\t\t\t\tdelta = tooltips[i].getBoundingClientRect().left + tooltips[i].offsetWidth -\r\n\t\t\t\t\t\t\t\tMath.min((window.innerWidth - View.scrollBarWidth - containerPadding), (window.innerWidth - View.scrollBarWidth) / 2 + 720);\r\n\r\n\t\t\t\t\t\t\tif (delta > 1) {\r\n\t\t\t\t\t\t\t\t// сдвиг выпадашки, если она выступает\r\n\t\t\t\t\t\t\t\ttooltips[i].style.marginLeft = ((parseInt(tooltips[i].style.marginLeft) || 0) - delta) + 'px';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\twin.off('resize.setTooltipPositions').on('resize.setTooltipPositions', function () {\r\n\t\t\t\t\t\tclearTimeout(timeout);\r\n\r\n\t\t\t\t\t\ttimeout = setTimeout(View.init.global.tooltipPosition.calcPosition, 300);\r\n\t\t\t\t\t}).trigger('resize.setTooltipPositions');\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// триггер клика по другому или одновременно нескольким элементам\r\n\t\t\t\ttriggerClick() {\r\n\t\t\t\t\tvar allSenders = $('.js-trigger-click__sender')\r\n\t\t\t\t\tvar allRecipients = $('.js-trigger-click__recipient')\r\n\r\n\t\t\t\t\tallSenders.each(function () {\r\n\t\t\t\t\t\tvar sender = $(this)\r\n\t\t\t\t\t\t// массив из ID отправителя для связывания триггеров со своими приемщиками\r\n\t\t\t\t\t\tvar triggerIdArr = (sender.data('triggerId')) ? String(sender.data('triggerId')).split(',') : false\r\n\r\n\t\t\t\t\t\t// обработка клика отправителя триггера\r\n\t\t\t\t\t\tsender.off('click.triggerClick').on('click.triggerClick', function (event) {\r\n\t\t\t\t\t\t\tevent.stopPropagation()\r\n\t\t\t\t\t\t\tevent.preventDefault()\r\n\r\n\t\t\t\t\t\t\tif (triggerIdArr) {\r\n\t\t\t\t\t\t\t\t// перебор масива приемщиков триггеров\r\n\t\t\t\t\t\t\t\tallRecipients.each(function () {\r\n\t\t\t\t\t\t\t\t\tconst recipient = $(this)\r\n\r\n\t\t\t\t\t\t\t\t\t// инициализация клика при совпадении ID отправителя и приемщика\r\n\t\t\t\t\t\t\t\t\tif (~triggerIdArr.indexOf(String(recipient.data('triggerId')))) recipient.trigger('click')\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// анимация чисел\r\n\t\t\t\tanimateDigits() {\r\n\t\t\t\t\tif ($.fn.spincrement) {\r\n\t\t\t\t\t\tfunction animateDigits() {\r\n\t\t\t\t\t\t\t$('.js-animate-digits').each(function () {\r\n\t\t\t\t\t\t\t\tvar _this = $(this)\r\n\r\n\t\t\t\t\t\t\t\tif (_this.offset().top < win.height() + win.scrollTop() - 50 && !_this.hasClass('animated')) {\r\n\t\t\t\t\t\t\t\t\t// защита от повторной анимации\r\n\t\t\t\t\t\t\t\t\t_this.addClass('animated')\r\n\r\n\t\t\t\t\t\t\t\t\t// фиксация ширины во время анимации\r\n\t\t\t\t\t\t\t\t\tvar width = _this.outerWidth()\r\n\t\t\t\t\t\t\t\t\t_this.css({display: 'inline-block', width: width, whiteSpace: 'nowrap'})\r\n\r\n\t\t\t\t\t\t\t\t\t// инициализация анимации\r\n\t\t\t\t\t\t\t\t\t_this.spincrement({\r\n\t\t\t\t\t\t\t\t\t\tthousandSeparator: ' ',\r\n\t\t\t\t\t\t\t\t\t\tduration: 2000,\r\n\t\t\t\t\t\t\t\t\t\tto: parseInt(_this.text().replace(/\\s/, '')),\r\n\t\t\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t\t\t// сбросс ширины\r\n\t\t\t\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\t\t\t\t_this.removeAttr('style')\r\n\t\t\t\t\t\t\t\t\t}, 3000)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\twin.off('scroll.animateDigits').on('scroll.animateDigits', animateDigits)\r\n\t\t\t\t\t\twin.trigger('scroll.animateDigits')\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// отложенная инициализация яндекс карт по скроллу\r\n\t\t\t\tinitMapsDelayScroll() {\r\n\t\t\t\t\t$('.js-map').each(function () {\r\n\t\t\t\t\t\tvar map = $(this)\r\n\t\t\t\t\t\tvar timeout = null\r\n\r\n\t\t\t\t\t\tfunction initMaps() {\r\n\t\t\t\t\t\t\tconsole.log('initMapsDelayScroll', View.loadYandexApi)\r\n\t\t\t\t\t\t\t// инициализируем если карта еще не инициализировалась\r\n\t\t\t\t\t\t\tView.loadDelayScript('https://api-maps.yandex.ru/2.1.73/?apikey=93e7d8c8-9ed1-495c-812f-da7e87965be9&lang=ru_RU&onLoad=View.initMaps')\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// запус инициализации если карта в зоне видимости или приближается к ней\r\n\t\t\t\t\t\twin.off('scroll.initMapsScroll').on('scroll.initMapsScroll', function () {\r\n\t\t\t\t\t\t\t// clearTimeout(timeout)\r\n\t\t\t\t\t\t\t// timeout = setTimeout(function () {\r\n\t\t\t\t\t\t\tif (View.getVisibleElemOnScroll(map, 500)) initMaps()\r\n\t\t\t\t\t\t\t// }, 10000)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\twin.trigger('scroll.initMapsScroll')\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// закрыть все что открывается по клику на странице и при ее ресайзе\r\n\t\t\t\tcloseAll() {\r\n\t\t\t\t\t// body.add('.js-close-all').off('click.closeAll').on('click.closeAll', function (e) {\r\n\t\t\t\t\t$('.js-close-all').off('click.closeAll').on('click.closeAll', function (e) {\r\n\t\t\t\t\t\tView.control.closeAll()\r\n\t\t\t\t\t\t$.fancybox.close();\r\n\t\t\t\t\t})\r\n\t\t\t\t\tdoc.off('click.closeAll').on('click.closeAll', '.js-close-all', function (e) {\r\n\t\t\t\t\t\tView.control.closeAll()\r\n\t\t\t\t\t\t$.fancybox.close();\r\n\t\t\t\t\t})\r\n\t\t\t\t\tif (View.mobileAndTabletCheck) {\r\n\t\t\t\t\t\t$('.js-close-all-hover').off('click.closeAll').on('click.closeAll', function (e) {\r\n\t\t\t\t\t\t\tView.control.closeAll()\r\n\t\t\t\t\t\t\t// View.init.local.toggleClassBlock.closeAllClassBlocks()\r\n\t\t\t\t\t\t\t// View.init.local.toggleClassPage.closeAllClassPage()\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$('.js-close-all-hover').off('mouseover.closeAll').on('mouseover.closeAll', function (e) {\r\n\t\t\t\t\t\t\tView.control.closeAll()\r\n\t\t\t\t\t\t\t// View.init.local.toggleClassBlock.closeAllClassBlocks()\r\n\t\t\t\t\t\t\t// View.init.local.toggleClassPage.closeAllClassPage()\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// закрыте по клику в теле страницы\r\n\t\t\t\t\tbody.off('click.closeAll').on('click.closeAll', function (e) {\r\n\t\t\t\t\t\tif (View.mobileAndTabletCheck) {\r\n\t\t\t\t\t\t\tView.control.closeAll(['closeAllClassBlocks', 'closeAllClassPage'])\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tView.control.closeAll(['closeAllClassBlocks', 'closeAllClassPage'])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\twin.off('resize.closeAll').on('resize.closeAll', function () {\r\n\t\t\t\t\t\tif (!View.mobileAndTabletCheck) View.control.closeAll();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t// local - требует переинициализации после перезагрузки DOM\r\n\t\t\tlocal: {\r\n\t\t\t\t// отложенная загрузка изображений\r\n\t\t\t\tlazyLoad(scope) {\r\n\t\t\t\t\tif ($.fn.Lazy) {\r\n\t\t\t\t\t\tView.init.local.lazyLoad.instance = $('.js-lazy[data-src]', scope).Lazy({\r\n\t\t\t\t\t\t\tchainable: false,\r\n\t\t\t\t\t\t\tvisibleOnly: true,\r\n\t\t\t\t\t\t\teffect: 'fadeIn',\r\n\t\t\t\t\t\t\tthreshold: 250,\r\n\t\t\t\t\t\t\tplaceholder: View.imageLoaderBase64,\r\n\r\n\t\t\t\t\t\t\t// стили фона прелоадера для элементов не являющимися картинками\r\n\t\t\t\t\t\t\tbeforeLoad: function (element) {\r\n\t\t\t\t\t\t\t\tif (element[0].tagName !== 'IMG') {\r\n\t\t\t\t\t\t\t\t\telement.css({backgroundPosition: 'center', backgroundRepeat: 'no-repeat', backgroundSize: '42px'})\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\tafterLoad: function (element) {\r\n\t\t\t\t\t\t\t\telement.addClass('lazy-loaded')\r\n\r\n\t\t\t\t\t\t\t\t// очистка фона после загрузки изображения\r\n\t\t\t\t\t\t\t\telement.css({backgroundPosition: '', backgroundRepeat: '', backgroundSize: ''})\r\n\t\t\t\t\t\t\t\tif (element[0].tagName === 'IMG') {\r\n\t\t\t\t\t\t\t\t\telement.css({background: 'none'})\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t// инициализация события загрузки отложенного изображения\r\n\t\t\t\t\t\t\t\twin.trigger('lazyImagesLoaded')\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// фильтрация элементов по клику на переключатели\r\n\t\t\t\tfilterItems() {\r\n\t\t\t\t\t$('.js-filter-items').each(function () {\r\n\t\t\t\t\t\tvar parent = $(this)\r\n\t\t\t\t\t\tvar toggles = parent.find('.js-filter-items__toggle')\r\n\t\t\t\t\t\tvar select = parent.find('.js-filter-items__select')\r\n\t\t\t\t\t\tvar items = parent.find('.js-filter-items__item')\r\n\r\n\t\t\t\t\t\t// инициализация предустаноленного индекса\r\n\t\t\t\t\t\tfilterItems(parent.attr('data-index'))\r\n\t\t\t\t\t\tparent.addClass('init-filter-items')\r\n\r\n\t\t\t\t\t\t// обработка переключения\r\n\t\t\t\t\t\ttoggles.off('click.filterItems').on('click.filterItems', function () {\r\n\t\t\t\t\t\t\tvar toggle = $(this)\r\n\r\n\t\t\t\t\t\t\tfilterItems(toggle.attr('data-index'))\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t// обработка переключения\r\n\t\t\t\t\t\tselect.off('change.filterItems').on('change.filterItems', function () {\r\n\t\t\t\t\t\t\tvar select = $(this)\r\n\r\n\t\t\t\t\t\t\tfilterItems(String(select.val()))\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t// перелючение активных элементов\r\n\t\t\t\t\t\tfunction filterItems(activeIndex) {\r\n\t\t\t\t\t\t\ttoggles.removeClass('active-toggle').filter('[data-index=' + activeIndex + ']').addClass('active-toggle')\r\n\r\n\r\n\t\t\t\t\t\t\titems.each(function () {\r\n\t\t\t\t\t\t\t\tvar item = $(this)\r\n\r\n\t\t\t\t\t\t\t\tif (~item.data('index').split(';').indexOf(activeIndex)) {\r\n\t\t\t\t\t\t\t\t\titem.show()\r\n\t\t\t\t\t\t\t\t\titem.addClass('active-item')\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\titem.hide()\r\n\t\t\t\t\t\t\t\t\titem.removeClass('active-item')\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t// обновление lazyload картинок внутри\r\n\t\t\t\t\t\t\tif (View.init.local.lazyLoad.instance) View.init.local.lazyLoad.instance.update()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// переключение класса по клику\r\n\t\t\t\ttoggleClassBlock(scope) {\r\n\t\t\t\t\tvar allParents = $('.js-class', scope)\r\n\t\t\t\t\tvar allClass = []\r\n\r\n\t\t\t\t\tallParents.each(function () {\r\n\t\t\t\t\t\tvar parent = $(this)\r\n\t\t\t\t\t\t// кастомный класс для переключения либо дефолтный\r\n\t\t\t\t\t\tvar activeClass = parent.data('class') || 'active-class'\r\n\t\t\t\t\t\tallClass.push(activeClass)\r\n\r\n\t\t\t\t\t\tparent.click(function (event) {\r\n\t\t\t\t\t\t\tevent.stopPropagation()\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tparent.find('.js-class__toggler').off('click.toggleClass').on('click.toggleClass', function (event) {\r\n\t\t\t\t\t\t\tevent.stopPropagation()\r\n\t\t\t\t\t\t\tevent.preventDefault()\r\n\t\t\t\t\t\t\tView.control.closeAll(['closeAllClassBlocks', 'closeAllClassPage'])\r\n\r\n\t\t\t\t\t\t\tif (!parent.hasClass(activeClass)) {\r\n\t\t\t\t\t\t\t\tbody.addClass(activeClass)\r\n\t\t\t\t\t\t\t\tparent.addClass(activeClass)\r\n\r\n\t\t\t\t\t\t\t\t// обновление lazyload картинок внутри таба\r\n\t\t\t\t\t\t\t\tView.init.local.lazyLoad()\r\n\r\n\t\t\t\t\t\t\t\t// показ первого сабменю при открытиии каталога\r\n\t\t\t\t\t\t\t\tif (!View.mobileAndTabletCheck && parent.hasClass('open-catalog')) {\r\n\t\t\t\t\t\t\t\t\t$('.js-hover-menu__item').first().triggerHandler('mouseover.showInnerMenu')\r\n\t\t\t\t\t\t\t\t\thtmlbody.animate({scrollTop: 0}, 400)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tbody.removeClass(activeClass)\r\n\t\t\t\t\t\t\t\tparent.removeClass(activeClass)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\t// закрыть все блоки\r\n\t\t\t\t\tView.init.local.toggleClassBlock.closeAllClassBlocks = function () {\r\n\t\t\t\t\t\tallClass.forEach(function (classSelector) {\r\n\t\t\t\t\t\t\tbody.removeClass(classSelector)\r\n\t\t\t\t\t\t\tallParents.removeClass(classSelector)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// переключение по кнопке класса страницы\r\n\t\t\t\ttoggleClassPage(scope) {\r\n\t\t\t\t\tvar allTogglers = $('.js-toggle-class-page', scope)\r\n\r\n\t\t\t\t\tallTogglers.each(function () {\r\n\t\t\t\t\t\tvar _this = $(this)\r\n\t\t\t\t\t\tvar itemClass = _this.data('class')\r\n\r\n\t\t\t\t\t\t_this.off('click.toggleClassPage').on('click.toggleClassPage', function (e) {\r\n\t\t\t\t\t\t\te.preventDefault()\r\n\t\t\t\t\t\t\te.stopPropagation()\r\n\r\n\t\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\t\tView.allClassPage.push(itemClass)\r\n\t\t\t\t\t\t\t\tbody.toggleClass(itemClass, !body.hasClass(itemClass))\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tView.init.local.toggleClassPage.closeAllClassPage = function () {\r\n\t\t\t\t\t\tView.allClassPage.forEach(function (item) {\r\n\t\t\t\t\t\t\tbody.removeClass(item)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// поисковая строка в шапке\r\n\t\t\t\tshowSearch(scope) {\r\n\t\t\t\t\t$('.js-search', scope).each(function () {\r\n\t\t\t\t\t\tvar form = $(this)\r\n\t\t\t\t\t\tvar content = form.find('.js-search__content')\r\n\t\t\t\t\t\tvar input = form.find('.js-search__input')\r\n\t\t\t\t\t\tvar close = form.find('.js-search__close')\r\n\t\t\t\t\t\tvar url = form.attr('action')\r\n\t\t\t\t\t\tvar timeout = null\r\n\r\n\t\t\t\t\t\tinput.off('keyup.showSearch').on('keyup.showSearch', input, function (event) {\r\n\t\t\t\t\t\t\tclearTimeout(timeout)\r\n\t\t\t\t\t\t\tconsole.log('keyup.showSearch', input.val())\r\n\r\n\t\t\t\t\t\t\tif (event.key === 'Escape') {\r\n\t\t\t\t\t\t\t\tevent.stopPropagation()\r\n\t\t\t\t\t\t\t\tView.init.local.showSearch.closeSearch();\r\n\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttimeout = setTimeout(function () {\r\n\t\t\t\t\t\t\t\tif (input.val().length >= 3) {\r\n\t\t\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\t\t\t'url': '/search/?' + form.serialize(),\r\n\t\t\t\t\t\t\t\t\t\t'success': function (data) {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log('success search')\r\n\t\t\t\t\t\t\t\t\t\t\tcontent\r\n\t\t\t\t\t\t\t\t\t\t\t\t.html($('.js-search__content', data).html())\r\n\t\t\t\t\t\t\t\t\t\t\t\t.slideDown(300);\r\n\t\t\t\t\t\t\t\t\t\t\tform.addClass('show-search')\r\n\t\t\t\t\t\t\t\t\t\t\tbody.addClass('show-search')\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tView.initAllLocal(form);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}, 600)\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t$(document).off('click.closeSearch').on('click.closeSearch', function (event) {\r\n\t\t\t\t\t\t\tif (!form.closest($(event.target)).length && input.val().length >= 1) {\r\n\t\t\t\t\t\t\t\tView.init.local.showSearch.closeSearch()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tform.off('submit.showSearch').on('submit.showSearch', function (event) {\r\n\t\t\t\t\t\t\tif (input.val().length >= 3) {\r\n\t\t\t\t\t\t\t\twindow.location.href = '/search/?q=' + input.val()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\tView.init.local.showSearch.closeSearch = function () {\r\n\t\t\t\t\t\t\tbody.removeClass('show-search')\r\n\t\t\t\t\t\t\tform.removeClass('show-search')\r\n\t\t\t\t\t\t\tform.find('.js-search__content').slideUp(300)\r\n\t\t\t\t\t\t\tform.find('.js-search__content').html('')\r\n\t\t\t\t\t\t\tinput.val('')\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tform.off('click.showSearch').on('click.showSearch', function (event) {\r\n\t\t\t\t\t\t\tevent.stopPropagation()\r\n\r\n\t\t\t\t\t\t\tView.control.closeAll('closeSearch')\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tclose.off('click.closeSearch').on('click.closeSearch', function (e) {\r\n\t\t\t\t\t\t\te.stopPropagation()\r\n\r\n\t\t\t\t\t\t\tView.init.local.showSearch.closeSearch()\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// accordion group\r\n\t\t\t\ttoggleAccordionGroup(scope) {\r\n\t\t\t\t\t$('.js-accordion--group', scope).each(function () {\r\n\t\t\t\t\t\tvar allAccordions = $(this).find('.js-accordion__item')\r\n\t\t\t\t\t\tvar allContents = allAccordions.find('.js-accordion__content')\r\n\r\n\t\t\t\t\t\tallAccordions.each(function () {\r\n\t\t\t\t\t\t\tvar accordion = $(this)\r\n\t\t\t\t\t\t\tvar content = accordion.find('.js-accordion__content')\r\n\r\n\t\t\t\t\t\t\t// инициализация и закрытие всех аккордионов кроме тех что с классом open-accordion\r\n\t\t\t\t\t\t\tif (!accordion.hasClass('open-accordion')) content.slideUp(0)\r\n\t\t\t\t\t\t\taccordion.addClass('init-accordion')\r\n\r\n\t\t\t\t\t\t\t// переключение состояния аккордиона по клику\r\n\t\t\t\t\t\t\taccordion.find('.js-accordion__toggler').off('click.toggleAccordion').on('click.toggleAccordion', function (event) {\r\n\t\t\t\t\t\t\t\tevent.stopPropagation()\r\n\t\t\t\t\t\t\t\tevent.preventDefault()\r\n\r\n\t\t\t\t\t\t\t\tcloseOtherAccordions()\r\n\r\n\t\t\t\t\t\t\t\t// переключение состояния аккордиона\r\n\t\t\t\t\t\t\t\taccordion.toggleClass('open-accordion')\r\n\t\t\t\t\t\t\t\tcontent.slideToggle(300)\r\n\r\n\t\t\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\t\t\t// обновление lazyload картинок внутри\r\n\t\t\t\t\t\t\t\t\tView.init.local.lazyLoad.instance.update()\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t// закрытие остальных аккардионов в группе\r\n\t\t\t\t\t\t\tfunction closeOtherAccordions() {\r\n\t\t\t\t\t\t\t\tallAccordions.not(accordion).removeClass('open-accordion')\r\n\t\t\t\t\t\t\t\tallContents.not(content).slideUp(300)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// одноуровневые выпадающие селекты\r\n\t\t\t\ttoggleSelect(scope) {\r\n\t\t\t\t\tvar allParents = $('.js-select', scope)\r\n\t\t\t\t\tvar allContents = allParents.find('.js-select__content')\r\n\r\n\t\t\t\t\tallParents.each(function () {\r\n\t\t\t\t\t\tvar parent = $(this)\r\n\t\t\t\t\t\tvar toggler = parent.find('.js-select__toggler')\r\n\t\t\t\t\t\tvar content = parent.find('.js-select__content')\r\n\t\t\t\t\t\tvar listItems = parent.find('.js-select__item')\r\n\t\t\t\t\t\tvar input = parent.find('.js-select__value')\r\n\r\n\t\t\t\t\t\t// инициализации и закрытие селекта при загрузке страницы\r\n\t\t\t\t\t\tcontent.fadeOut(0)\r\n\t\t\t\t\t\tparent.addClass('init-select')\r\n\r\n\t\t\t\t\t\t// инициализация предустановленного значения селекта\r\n\t\t\t\t\t\tvar initValue = parent.attr('data-init-value')\r\n\t\t\t\t\t\tif (initValue.length) {\r\n\t\t\t\t\t\t\tlistItems.each(function () {\r\n\t\t\t\t\t\t\t\tvar listItem = $(this)\r\n\t\t\t\t\t\t\t\tif (listItem.attr('data-value') === initValue) {\r\n\t\t\t\t\t\t\t\t\tlistItem.addClass('selected')\r\n\t\t\t\t\t\t\t\t\ttoggler.addClass('selected').html(listItem.html())\r\n\t\t\t\t\t\t\t\t\tinput.val(initValue).trigger('change').trigger('input')\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// открытие по клику\r\n\t\t\t\t\t\ttoggler.off('click.toggleSelect').on('click.toggleSelect', function (event) {\r\n\t\t\t\t\t\t\tevent.stopPropagation()\r\n\t\t\t\t\t\t\tevent.preventDefault()\r\n\r\n\t\t\t\t\t\t\t// селект заблокирован при наличии класса\r\n\t\t\t\t\t\t\tif (toggler.hasClass('disabled')) return\r\n\r\n\t\t\t\t\t\t\tif (!parent.hasClass('open-select')) {\r\n\t\t\t\t\t\t\t\tView.control.closeAll()\r\n\t\t\t\t\t\t\t\topenSelect()\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tcloseSelect()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t// клик для выбора елемента option\r\n\t\t\t\t\t\tlistItems.off('click.setSelectOption').on('click.setSelectOption', function (event) {\r\n\t\t\t\t\t\t\tevent.stopPropagation()\r\n\t\t\t\t\t\t\tvar item = $(this)\r\n\t\t\t\t\t\t\tvar itemValue = item.attr('data-value')\r\n\r\n\t\t\t\t\t\t\tcloseSelect()\r\n\t\t\t\t\t\t\tif (itemValue === 'reset') {\r\n\t\t\t\t\t\t\t\tlistItems.removeClass('selected')\r\n\t\t\t\t\t\t\t\ttoggler.removeClass('selected').html(toggler.data('reset'))\r\n\t\t\t\t\t\t\t\tparent.attr('data-value', '')\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tlistItems.removeClass('selected')\r\n\t\t\t\t\t\t\t\titem.addClass('selected')\r\n\t\t\t\t\t\t\t\ttoggler.addClass('selected').html(item.html())\r\n\t\t\t\t\t\t\t\tparent.attr('data-value', itemValue)\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// триггер события и установка выбранного значения на скрытом поле\r\n\t\t\t\t\t\t\tinput.val(item.attr('data-value')).trigger('change').trigger('input')\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t// открытие селекта\r\n\t\t\t\t\t\tfunction openSelect() {\r\n\t\t\t\t\t\t\tcontent.fadeIn(100)\r\n\t\t\t\t\t\t\tparent.addClass('open-select')\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// закрытие селекта\r\n\t\t\t\t\t\tfunction closeSelect() {\r\n\t\t\t\t\t\t\tcontent.fadeOut(100)\r\n\t\t\t\t\t\t\tparent.removeClass('open-select')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\t// закрыть все селекты\r\n\t\t\t\t\tView.init.local.toggleSelect.closeAllSelect = function () {\r\n\t\t\t\t\t\tallParents.removeClass('open-select')\r\n\t\t\t\t\t\tallContents.fadeOut(100)\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// сворачивание больших текстов по кнопке\r\n\t\t\t\tclippedText(scope) {\r\n\t\t\t\t\t$('.js-clipped', scope).each(function (ind) {\r\n\t\t\t\t\t\tvar parent = $(this)\r\n\t\t\t\t\t\tvar content = parent.find('.js-clipped__content')\r\n\t\t\t\t\t\tvar toggler = parent.find('.js-clipped__toggler')\r\n\t\t\t\t\t\tvar timeout = null;\r\n\t\t\t\t\t\tvar textInit = content.html()\r\n\t\t\t\t\t\t// высота текста из атрибута или дефолтная, которую стоит сворачивать\r\n\t\t\t\t\t\tvar clippedHeight = parent.data('clippedHeight') || 100\r\n\t\t\t\t\t\t// колличество символов для показа сокращенной версии\r\n\t\t\t\t\t\tvar clippedSymbols = parent.data('clippedSymbols')\r\n\r\n\t\t\t\t\t\tvar winWidth = null\r\n\r\n\t\t\t\t\t\tfunction clippedText() {\r\n\t\t\t\t\t\t\twinWidth = win.width()\r\n\r\n\t\t\t\t\t\t\t// сбросс высоты контента\r\n\t\t\t\t\t\t\tparent.removeClass('init-clipped')\r\n\t\t\t\t\t\t\tcontent.css({maxHeight: ''})\r\n\r\n\t\t\t\t\t\t\t// если указано ограничение сокращенной версии по символам то высоту берем по их размеру высоты\r\n\t\t\t\t\t\t\tif (clippedSymbols) {\r\n\t\t\t\t\t\t\t\tcontent.text(content.text().substr(0, clippedSymbols))\r\n\t\t\t\t\t\t\t\tclippedHeight = content.outerHeight()\r\n\t\t\t\t\t\t\t\tcontent.html(textInit)\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// изначальная высота блока с текстом\r\n\t\t\t\t\t\t\tvar initialHeightContent = content.outerHeight()\r\n\r\n\t\t\t\t\t\t\t// инициализация плагина, если длинна текста больше допустимой\r\n\t\t\t\t\t\t\tif (initialHeightContent > clippedHeight) {\r\n\t\t\t\t\t\t\t\tparent.addClass('init-clipped')\r\n\t\t\t\t\t\t\t\tclose()\r\n\r\n\t\t\t\t\t\t\t\t// переключение сворачивания контента\r\n\t\t\t\t\t\t\t\ttoggler.off('click.clippedText').on('click.clippedText', function () {\r\n\t\t\t\t\t\t\t\t\tif (parent.hasClass('open-clipped')) {\r\n\t\t\t\t\t\t\t\t\t\tclose()\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tparent.addClass('open-clipped')\r\n\t\t\t\t\t\t\t\t\t\tcontent.css({maxHeight: initialHeightContent})\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttoggler.off('click.clippedText')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// закрыть выпадашку\r\n\t\t\t\t\t\tfunction close() {\r\n\t\t\t\t\t\t\tparent.removeClass('open-clipped')\r\n\t\t\t\t\t\t\tcontent.css({maxHeight: clippedHeight})\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\twin.off('resize.clippedText' + ind).on('resize.clippedText' + ind, function () {\r\n\t\t\t\t\t\t\tclearTimeout(timeout);\r\n\t\t\t\t\t\t\ttimeout = setTimeout(function () {\r\n\t\t\t\t\t\t\t\tif (winWidth != win.width()) {\r\n\t\t\t\t\t\t\t\t\tclippedText()\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}, 300);\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\twin.trigger('resize.clippedText' + ind);\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// переключение контента аяксом\r\n\t\t\t\ttoggleAjax(scope) {\r\n\t\t\t\t\t$('.js-toggle-ajax', scope).each(function () {\r\n\t\t\t\t\t\tvar parent = $(this)\r\n\t\t\t\t\t\tvar toggles = parent.find('.js-toggle-ajax__toggle')\r\n\t\t\t\t\t\tvar toggles_2 = parent.find('.js-toggle-ajax__toggle-2')\r\n\t\t\t\t\t\tvar select = parent.find('.js-toggle-ajax__select')\r\n\t\t\t\t\t\tvar content = parent.find('.js-toggle-ajax__content')\r\n\t\t\t\t\t\tvar preloader = $('<div>').addClass('icon-preloader')\r\n\r\n\t\t\t\t\t\tfunction toggleAjax(url) {\r\n\t\t\t\t\t\t\tbody.append(preloader)\r\n\r\n\t\t\t\t\t\t\t$.get(url)\r\n\t\t\t\t\t\t\t\t.done(function (response) {\r\n\t\t\t\t\t\t\t\t\tconsole.log('ajax success')\r\n\r\n\t\t\t\t\t\t\t\t\tcontent.html(response)\r\n\r\n\t\t\t\t\t\t\t\t\tcontent.find('[data-parsley-validate]').parsley();\r\n\r\n\t\t\t\t\t\t\t\t\tView.init.global.initMapsDelayScroll()\r\n\t\t\t\t\t\t\t\t\tView.initAllLocal(parent.parent())\r\n\r\n\t\t\t\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\t\t\t\tpreloader.remove()\r\n\t\t\t\t\t\t\t\t\t}, 300)\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t.fail(function (response) {\r\n\t\t\t\t\t\t\t\t\tconsole.warn('offer: ajax load failed', response)\r\n\r\n\t\t\t\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\t\t\t\tpreloader.remove()\r\n\t\t\t\t\t\t\t\t\t}, 300)\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// обработка переключения\r\n\t\t\t\t\t\ttoggles.off('click.toggleAjax').on('click.toggleAjax', function (e) {\r\n\t\t\t\t\t\t\te.preventDefault()\r\n\t\t\t\t\t\t\tvar toggle = $(this)\r\n\t\t\t\t\t\t\ttoggles.removeClass('active-ajax')\r\n\t\t\t\t\t\t\ttoggle.addClass('active-ajax')\r\n\r\n\t\t\t\t\t\t\tif (toggle.hasClass('pagination__link')) {\r\n\t\t\t\t\t\t\t\thtmlbody.animate({scrollTop: 0}, 400)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttoggleAjax(toggle.data('url'))\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t// обработка переключения\r\n\t\t\t\t\t\ttoggles_2.off('click.toggleAjax').on('click.toggleAjax', function (e) {\r\n\t\t\t\t\t\t\te.preventDefault()\r\n\t\t\t\t\t\t\tvar toggle = $(this)\r\n\t\t\t\t\t\t\ttoggles_2.removeClass('active-ajax')\r\n\t\t\t\t\t\t\ttoggle.addClass('active-ajax')\r\n\r\n\t\t\t\t\t\t\ttoggleAjax(toggle.data('url'))\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t// обработка переключения\r\n\t\t\t\t\t\tselect.off('change.toggleAjax').on('change.toggleAjax', function () {\r\n\t\t\t\t\t\t\ttoggleAjax(select.val())\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// валидация форм\r\n\t\t\t\tvalidateForm(scope) {\r\n\t\t\t\t\tif ($.fn.parsley) {\r\n\t\t\t\t\t\t$('[data-parsley-validate]', scope).parsley()\r\n\r\n\t\t\t\t\t\t// обработка валидации поля с ощибкой\r\n\t\t\t\t\t\twindow.Parsley.off('field:error').on('field:error', function () {\r\n\t\t\t\t\t\t\tthis.$element.closest('.js-field').addClass('field--error')\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// обработка успешной валидации поля\r\n\t\t\t\t\t\twindow.Parsley.off('field:success').on('field:success', function () {\r\n\t\t\t\t\t\t\tthis.$element.closest('.js-field').removeClass('field--error')\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// валидация ввода для поля\r\n\t\t\t\t\t\t$('input[type=email]').off('keypress.email').on('keypress.email', function (e) {\r\n\t\t\t\t\t\t\tvar reg = /[а-яА-ЯёЁ]/g;\r\n\r\n\t\t\t\t\t\t\tif (e.key.search(reg) != -1) {\r\n\t\t\t\t\t\t\t\te.preventDefault()\r\n\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// всплывающая подсказка\r\n\t\t\t\tinitTooltip(scope) {\r\n\t\t\t\t\tif ($.fn.tooltipster) {\r\n\t\t\t\t\t\tvar activeInstance = null\r\n\r\n\t\t\t\t\t\t$('.js-tooltip', scope).each(function () {\r\n\t\t\t\t\t\t\tvar tooltip = $(this)\r\n\t\t\t\t\t\t\tvar attrOptions = tooltip.data('options')\r\n\t\t\t\t\t\t\tvar options = {\r\n\t\t\t\t\t\t\t\t// «top», «bottom», «left», «right». Это также может быть массив ['top', 'bottom', 'right', 'left']\r\n\t\t\t\t\t\t\t\tside: 'top',\r\n\t\t\t\t\t\t\t\ttrigger: 'click',\r\n\t\t\t\t\t\t\t\t// возможность взаимодействовать с содержимим всплывашки\r\n\t\t\t\t\t\t\t\tinteractive: true,\r\n\t\t\t\t\t\t\t\ttheme: 'tooltipster-shadow',\r\n\t\t\t\t\t\t\t\t// отступ от переключателя\r\n\t\t\t\t\t\t\t\tdistance: 5,\r\n\t\t\t\t\t\t\t\t// минимальный отступ от выступающего треугольника от края\r\n\t\t\t\t\t\t\t\tminIntersection: 10,\r\n\t\t\t\t\t\t\t\tminWidth: 150,\r\n\t\t\t\t\t\t\t\tmaxWidth: 320,\r\n\t\t\t\t\t\t\t\t// Перемещает всплывающую подсказку, если она выходит из области просмотра, когда пользователь прокручивает страницу, чтобы она оставалась видимой как можно дольше.\r\n\t\t\t\t\t\t\t\trepositionOnScroll: true,\r\n\t\t\t\t\t\t\t\tzIndex: 99999,\r\n\t\t\t\t\t\t\t\t//  \t'fade', 'grow', 'swing', 'slide', 'fall'\r\n\t\t\t\t\t\t\t\tanimation: 'fade',\r\n\t\t\t\t\t\t\t\t// версия ИЕ для поддержки\r\n\t\t\t\t\t\t\t\tIEmin: 11,\r\n\r\n\t\t\t\t\t\t\t\tfunctionBefore: function (instance, helper) {\r\n\t\t\t\t\t\t\t\t\t// закрытие предыдущего\r\n\t\t\t\t\t\t\t\t\tif (activeInstance) activeInstance.close()\r\n\t\t\t\t\t\t\t\t\tactiveInstance = instance\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t// срабатывает при инициализации\r\n\t\t\t\t\t\t\t\tfunctionInit: function (instance, helper) {\r\n\t\t\t\t\t\t\t\t\t// переключатель для подсказки\r\n\t\t\t\t\t\t\t\t\tvar toggler = $(helper.origin)\r\n\t\t\t\t\t\t\t\t\tvar dataOptions = toggler.data('tooltipster');\r\n\r\n\t\t\t\t\t\t\t\t\t// примениение параметров в атрибуте при их наличии\r\n\t\t\t\t\t\t\t\t\tif (dataOptions) {\r\n\t\t\t\t\t\t\t\t\t\t$.each(dataOptions, function (name, option) {\r\n\t\t\t\t\t\t\t\t\t\t\tinstance.option(View.toCamelCase(name), option);\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t// срабатывает когда подсказка и ее содержимое было добавлено в DOM\r\n\t\t\t\t\t\t\t\t// functionReady: function (instance, helper) {\r\n\t\t\t\t\t\t\t\t// \t// переключатель для подсказки\r\n\t\t\t\t\t\t\t\t// \tvar toggler = $(helper.origin)\r\n\t\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\t\t// \t// добавить кастомный класс на подсказку\r\n\t\t\t\t\t\t\t\t// \t$(helper.tooltip).addClass(toggler.data('custom-class'))\r\n\t\t\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// переназначение параметров из атрибута\r\n\t\t\t\t\t\t\tif (attrOptions) {\r\n\t\t\t\t\t\t\t\tfor (var key in attrOptions) {\r\n\t\t\t\t\t\t\t\t\toptions[key] = attrOptions[key]\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t\t\tif (!tooltip.hasClass('tooltipstered')) tooltip.tooltipster(options)\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// загрузка файла\r\n\t\t\t\tinputFile(scope) {\r\n\t\t\t\t\t$('.js-input-file', scope).each(function () {\r\n\t\t\t\t\t\tvar parent = $(this)\r\n\t\t\t\t\t\tvar name = parent.find('.js-input-file__name')\r\n\r\n\t\t\t\t\t\t// // отслеживание события выбора файла\r\n\t\t\t\t\t\t// inputs.off('change.inputFile').on('change.inputFile', function () {\r\n\t\t\t\t\t\t// \tsetFile()\r\n\t\t\t\t\t\t// })\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t\t// function setFile() {\r\n\t\t\t\t\t\t// \tinputs.each(function () {\r\n\t\t\t\t\t\t// \t\tvar input = $(this)\r\n\t\t\t\t\t\t// \t\tconsole.log('input', input[0].files)\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t\t// \t\tif (input[0].files.length) {\r\n\t\t\t\t\t\t// \t\t\tname.text(input[0].files[0].name)\r\n\t\t\t\t\t\t// \t\t\tparent.addClass('selected-file')\r\n\t\t\t\t\t\t// \t\t}\r\n\t\t\t\t\t\t// \t})\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t\t// setFile()\r\n\r\n\t\t\t\t\t\t// сброс файла\r\n\t\t\t\t\t\tparent.find('.js-input-file__delete').off('click.deleteInputFile').on('click.deleteInputFile', function () {\r\n\t\t\t\t\t\t\t$(this).remove()\r\n\t\t\t\t\t\t\tparent.find('input').each(function () {\r\n\t\t\t\t\t\t\t\t$(this).val('')\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t// parent.removeClass('selected-file')\r\n\t\t\t\t\t\t\tname.text('Выберите файл')\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\t// управление открытием/закрытием всех переключающихся блоков и состояний\r\n\t\tthis.control = {\r\n\t\t\tfunctionsArr: {\r\n\t\t\t\tcloseAllSelects: function () {\r\n\t\t\t\t\tView.init.local.toggleSelect.closeAllSelect()\r\n\t\t\t\t},\r\n\t\t\t\tcloseAllMobileMenu: function () {\r\n\t\t\t\t\tView.init.global.mobileMenu.closeAll()\r\n\t\t\t\t},\r\n\t\t\t\tcloseAllClassBlocks: function () {\r\n\t\t\t\t\tView.init.local.toggleClassBlock.closeAllClassBlocks()\r\n\t\t\t\t},\r\n\t\t\t\tcloseAllDropdownHover: function () {\r\n\t\t\t\t\tView.init.global.toggleDropdownHover.closeAllDropdownHover()\r\n\t\t\t\t},\r\n\t\t\t\tcloseAllDropdown: function () {\r\n\t\t\t\t\tView.init.local.toggleDropdown.closeAllDropdown()\r\n\t\t\t\t},\r\n\t\t\t\tcloseSearch: function () {\r\n\t\t\t\t\tView.init.local.showSearch.closeSearch()\r\n\t\t\t\t},\r\n\t\t\t\tcloseAllClassPage: function () {\r\n\t\t\t\t\tView.init.local.toggleClassPage.closeAllClassPage()\r\n\t\t\t\t},\r\n\t\t\t\t// closeAllAccordionAdaptive: function () {\r\n\t\t\t\t// \tView.init.global.toggleAccordionOnlyAdaptive.closeAllAccordionAdaptive()\r\n\t\t\t\t// },\r\n\t\t\t},\r\n\r\n\t\t\t// закрыть всё что открывается, за исключением переданного списка параметров указанных имен закрывашек\r\n\t\t\tcloseAll(exclude) {\r\n\t\t\t\texclude = exclude || []\r\n\r\n\t\t\t\t// перебор массива со всеми имеющимися функциями для управлени\r\n\t\t\t\tfor (var fn in View.control.functionsArr) {\r\n\t\t\t\t\tif (typeof View.control.functionsArr[fn] == 'function' && !~exclude.indexOf(fn)) {\r\n\t\t\t\t\t\tView.control.functionsArr[fn]();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// console.log('View.control.functionsArr[fn]', fn)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log('closeAll')\r\n\t\t\t},\r\n\t\t}\r\n\r\n\t\tthis.initAllGlobal = function () {\r\n\t\t\t$.each(this.init.global, function (index, fn) {\r\n\t\t\t\tif (typeof fn === 'function') fn();\r\n\t\t\t});\r\n\t\t};\r\n\t\tthis.initAllLocal = function (scope) {\r\n\t\t\t$.each(this.init.local, function (index, fn) {\r\n\t\t\t\tif (typeof fn === 'function') fn(scope);\r\n\t\t\t});\r\n\r\n\t\t\tconsole.log('init local')\r\n\t\t};\r\n\t})()\r\n\r\n\t$(function ($) {\r\n\t\tconst body = $(document.body);\r\n\t\t// body.removeClass('loading-page');\r\n\r\n\t\tbody.addClass(View.isIOS ? ('ios ios-' + View.isIOS) : 'no-ios');\r\n\t\tbody.addClass(View.checkAdaptiveBrowser ? 'touch' : 'no-touch');\r\n\t\tbody.addClass(View.isIE ? 'ie' : 'no-ie');\r\n\r\n\t\tView.initView();\r\n\t\tView.initAllGlobal();\r\n\t\tView.initAllLocal(body);\r\n\t\tif (View.isIE) {\r\n\t\t\tsvg4everybody();\r\n\t\t\tobjectFitImages();\r\n\t\t}\r\n\r\n\t\t// body.off('onAjaxSuccess').on('onAjaxSuccess', View.initAllLocal())\r\n\t\tif (window.BX) {\r\n\t\t\tBX.addCustomEvent('onAjaxSuccess', function (e) {\r\n\t\t\t\tView.initAllLocal(body);\r\n\t\t\t});\r\n\t\t\tBX.addCustomEvent('ajaxstop', function (e) {\r\n\t\t\t\tView.initAllLocal(body);\r\n\t\t\t\tconsole.log('BX.ajaxstop')\r\n\t\t\t});\r\n\r\n\t\t\t// Готовый пример, показывает/скрывает лоадер, запускает/останавливает анимацию\r\n\t\t\tBX.ready(function () {\r\n\t\t\t\tvar preloader = $('<div>').addClass('icon-preloader')\r\n\t\t\t\tBX.showWait = function (node, msg) {\r\n\t\t\t\t\tbody.append(preloader)\r\n\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\tpreloader.remove()\r\n\t\t\t\t\t}, 7000)\r\n\t\t\t\t};\r\n\t\t\t\tBX.closeWait = function (node, obMsg) {\r\n\t\t\t\t\tpreloader.remove()\r\n\t\t\t\t\tconsole.log('BX.closeWait')\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t}\r\n\t})\r\n}\n\n//# sourceURL=webpack:///./source/js/es6/view.js?");

/***/ }),

/***/ 0:
/*!***************************************************************!*\
  !*** multi ./source/js/es6/script.js ./source/js/es6/view.js ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("__webpack_require__(/*! C:\\work\\0_разработка\\0_framework\\local\\source\\js\\es6\\script.js */\"./source/js/es6/script.js\");\nmodule.exports = __webpack_require__(/*! C:\\work\\0_разработка\\0_framework\\local\\source\\js\\es6\\view.js */\"./source/js/es6/view.js\");\n\n\n//# sourceURL=webpack:///multi_./source/js/es6/script.js_./source/js/es6/view.js?");

/***/ })

/******/ });